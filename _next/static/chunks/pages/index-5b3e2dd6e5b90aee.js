(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7594:function(e){function s(e){return Promise.resolve().then(function(){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s})}s.keys=function(){return[]},s.resolve=s,s.id=7594,e.exports=s},8312:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(586)}])},586:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return s6}});var a,t,n=l(5893),i=l(7294),c=l(9483),r=l.n(c);(a=t||(t={}))[a.LOAD_SAVED_STATE=0]="LOAD_SAVED_STATE",a[a.USER_FILE_INPUT=1]="USER_FILE_INPUT",a[a.GRID_UPDATE=2]="GRID_UPDATE",a[a.CLASSIFICATION_CONFIG=3]="CLASSIFICATION_CONFIG",a[a.SPLUS_TRILOGY_CONFIG=4]="SPLUS_TRILOGY_CONFIG",a[a.SPLUS_IMAGING=5]="SPLUS_IMAGING",a[a.SPLUS_LUPTON_CONFIG=6]="SPLUS_LUPTON_CONFIG",a[a.SPLUS_PHOTO_SPECTRA=7]="SPLUS_PHOTO_SPECTRA",a[a.LEGACY_IMAGING=8]="LEGACY_IMAGING",a[a.SDSS_IMAGING=9]="SDSS_IMAGING",a[a.SDSS_CATALOG=10]="SDSS_CATALOG",a[a.CUSTOM_IMAGE_NEW=11]="CUSTOM_IMAGE_NEW",a[a.CUSTOM_IMAGE_UPDATE=12]="CUSTOM_IMAGE_UPDATE",a[a.CUSTOM_IMAGE_REMOVE=13]="CUSTOM_IMAGE_REMOVE",a[a.CUSTOM_IMAGE_ENABLE=14]="CUSTOM_IMAGE_ENABLE",a[a.CURRENT_VIEW_CHANGE=15]="CURRENT_VIEW_CHANGE";let o=()=>({schemaVersion:16,table:{type:"local",file:null,url:null,selectedColumnsId:[],columns:[],raIndex:null,decIndex:null,state:"unloaded",isSameFile:!1,dataTypes:void 0},grid:{data:void 0,colDef:void 0,api:void 0,isLoaded:!1,currColConfigs:void 0,currTale:void 0,editable:!1},currentView:"settings",cols:{classification:{enabled:!1,type:"categorical",classNames:[],positiveClass:"",negativeClass:"",filterUnclassified:!0,keyMap:{}},sdssCatalog:{selectedColumns:[]},splusImaging:{enabled:!0,type:"trilogy",pixelScale:.4,trilogyConfig:{R:["R","I","F861","Z"],G:["G","F515","F660"],B:["U","F378","F395","F410","F430"],noise:.15,Q:.2},luptonConfig:{R:"I",G:"R",B:"G",stretch:1.4,Q:6.2}},legacyImaging:{enabled:!0,pixelScale:.4,dataRelease:"10"},sdssSpectra:{enabled:!0},splusPhotoSpectra:{enabled:!0,selectedLines:["iso","aper6"]},customImaging:{enabled:!1,columns:[{url:"",fileExtension:"",columnIndex:-1}]}}}),d=o(),m=e=>{let s={...e,table:o().table,grid:o().grid,currentView:o().currentView};r().setItem("tableConfigState",s,(e,s)=>{e&&console.error(e)})};function h(e,s,l){let a={...e};for(let e in s.payload)l(a)[e]=s.payload[e];return m(a),a}let u={[t.LOAD_SAVED_STATE]:(e,s)=>s.payload,[t.USER_FILE_INPUT]:(e,s)=>h(e,s,e=>e.table),[t.CLASSIFICATION_CONFIG]:(e,s)=>h(e,s,e=>e.cols.classification),[t.SPLUS_TRILOGY_CONFIG]:(e,s)=>h(e,s,e=>e.cols.splusImaging.trilogyConfig),[t.SPLUS_IMAGING]:(e,s)=>h(e,s,e=>e.cols.splusImaging),[t.SPLUS_LUPTON_CONFIG]:(e,s)=>h(e,s,e=>e.cols.splusImaging.luptonConfig),[t.SPLUS_PHOTO_SPECTRA]:(e,s)=>h(e,s,e=>e.cols.splusPhotoSpectra),[t.LEGACY_IMAGING]:(e,s)=>h(e,s,e=>e.cols.legacyImaging),[t.SDSS_IMAGING]:(e,s)=>h(e,s,e=>e.cols.sdssSpectra),[t.SDSS_CATALOG]:(e,s)=>h(e,s,e=>e.cols.sdssCatalog),[t.CUSTOM_IMAGE_NEW]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=[...s.payload.prevColumns,{url:"",fileExtension:"",columnIndex:-1}],m(l),l},[t.CUSTOM_IMAGE_UPDATE]:(e,s)=>h(e,s,e=>e.cols.customImaging.columns[s.payload.index]),[t.CUSTOM_IMAGE_REMOVE]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=s.payload.prevColumns.filter((e,l)=>l!=s.payload.index),m(l),l},[t.CUSTOM_IMAGE_ENABLE]:(e,s)=>h(e,s,e=>e.cols.customImaging),[t.GRID_UPDATE]:(e,s)=>h(e,s,e=>e.grid),[t.CURRENT_VIEW_CHANGE]:(e,s)=>{let l={...e};return l.currentView=s.payload,l}},p=(e,s)=>u[s.type](e,s),x=(0,i.createContext)({tcState:d,tcDispatch:()=>{}}),g=e=>{let{children:s}=e,[l,a]=(0,i.useReducer)(p,d);return(0,n.jsx)(x.Provider,{value:{tcState:l,tcDispatch:a},children:s})},j=()=>(0,i.useContext)(x);function f(){let{tcDispatch:e}=j();return(0,i.useEffect)(()=>{r().getItem("tableConfigState",(s,l)=>{s||null===l||16!==l.schemaVersion||e({type:t.LOAD_SAVED_STATE,payload:l})})},[e]),null}var y=l(9008),b=l.n(y),C=l(688),S=l(2246),v=l(6698),I=l(7083),N=l(8447),Z=l(4855),_=l(404);let T="10.5281/zenodo.7268504",w="@software{astrotools,\n    doi = {10.5281/zenodo.7268504},\n    url = {https://doi.org/10.5281/zenodo.7268504},\n    year = {2022},\n    month = oct,\n    publisher = {Zenodo},\n    author = {Cardoso, N. M.},\n    title = {Astrotools: Web-based astronomical tools}\n}",E=e=>{let{show:s,onHide:l}=e,[a,t]=(0,i.useState)(!1),[c,r]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{a&&setTimeout(()=>t(!1),3e3),c&&setTimeout(()=>r(!1),3e3)},[a,c]),(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"How to cite this software"})}),(0,n.jsxs)(N.Z.Body,{children:[(0,n.jsx)("p",{children:"If you used this software during the production process of your scientific project, please consider citing it with the information provided below."}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(v.Z,{children:"DOI"}),(0,n.jsx)(Z.CopyToClipboard,{text:T,onCopy:()=>t(!0),children:(0,n.jsx)(I.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),a&&(0,n.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,n.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:T})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(v.Z,{children:"BibTex"}),(0,n.jsx)(Z.CopyToClipboard,{text:w,onCopy:()=>r(!0),children:(0,n.jsx)(I.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),c&&(0,n.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,n.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:w})]})]})]})};function L(){let[e,s]=(0,i.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.Z,{size:"sm",variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>s(!0),children:[(0,n.jsx)(_.X1l,{className:"me-1",size:18}),(0,n.jsx)("span",{children:"Cite this software"})]}),(0,n.jsx)(E,{show:e,onHide:()=>s(!1)})]})}function R(e,s,l){if("ms"===l)switch(s){case"sec":return 1e3*e;case"min":return 6e4*e;case"hour":return 36e5*e;case"day":return 864e5*e;case"week":return 252e5*e;case"month":return 2592e6*e}}function A(e,s){let l=RegExp("^".concat(e,"_?J?d*?$"),"gi");return s.findIndex((e,s)=>null!==l.exec(e))}var k=l(5675),U=l.n(k),G=l(1664),F=l.n(G);function P(){return(0,n.jsx)(S.Z.Brand,{as:"div",className:"mx-auto",children:(0,n.jsx)(F(),{href:"/",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(U(),{alt:"AstronInspect",src:"".concat("/","galaxy_128.png"),width:"30",height:"30",className:"d-inline-block align-top"}),(0,n.jsx)("span",{className:"ms-2 fw-bold",children:"AstroInspect"})]})})})}function O(){return(0,n.jsx)(I.Z,{className:"me-2",size:"sm",variant:"outline-primary",href:"https://github.com/nmcardoso/astrotools",target:"_BLANK",children:(0,n.jsx)(_.rFR,{size:20})})}var D=l(9540);function z(){let{tcDispatch:e}=j(),s=(0,i.useCallback)(()=>{e({type:t.CURRENT_VIEW_CHANGE,payload:"settings"})},[]);return(0,n.jsxs)(I.Z,{className:"d-inline-flex align-items-center me-2",onClick:s,size:"sm",children:[(0,n.jsx)(D.x_l,{size:14,className:"me-2"}),(0,n.jsx)("span",{children:"Back"})]})}var M=l(5071),B=l(4055),H=l(1470);function q(e){let{children:s,title:l=null,placement:a="auto",className:t=""}=e,i=(0,n.jsxs)(B.Z,{id:"help-popover",children:[l&&(0,n.jsx)(B.Z.Header,{as:"h3",children:l}),(0,n.jsx)(B.Z.Body,{children:s})]});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(M.Z,{trigger:"click",rootClose:!0,placement:a,overlay:i,children:(0,n.jsx)(I.Z,{variant:"link",className:"p-0 d-inline-flex align-items-center ".concat(t),children:(0,n.jsx)(H.CUu,{size:20})})})})}var V=l(1409),Q=l(7772),K=l(4940),W=l(8587),Y=l(1096);let X=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:t}=j(),[c,r]=(0,i.useState)(""),[o,d]=(0,i.useState)("all"),[m,h]=(0,i.useState)("all"),[u,p]=(0,i.useState)(!1);return(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Download current table"})}),(0,n.jsx)(N.Z.Body,{children:(0,n.jsxs)(Q.Z,{onSubmit:e=>{let s;e.preventDefault(),a.grid.api.exportDataAsCsv({suppressQuotes:!0,columnKeys:[..."all"===o?a.table.selectedColumnsId.map(e=>"tab:".concat(a.table.columns[e])):a.table.columns.map(e=>"tab:".concat(e)),...a.cols.sdssCatalog.selectedColumns.map(e=>"sdss:".concat(e.table,"_").concat(e.column)),...a.cols.classification.enabled?["ai:class"]:[]],fileName:c||"AstroInspect",exportedRows:u?"filteredAndSorted":"all",shouldRowBeSkipped:"classified"===m?e=>{var s;let{node:l}=e;return(null===(s=l.data)||void 0===s?void 0:s["ai:class"])===void 0}:"unclassified"===m?e=>{var s;let{node:l}=e;return(null===(s=l.data)||void 0===s?void 0:s["ai:class"])!==void 0}:void 0,processHeaderCallback:e=>{let{column:s}=e;return"ai:class"===s.getColDef().field?"AstroInspectClass":s.getColDef().headerName}})},className:"mt-3",children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"classDownload",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"2",className:"text-end",children:"File name"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(Q.Z.Control,{value:c,onChange:e=>r(e.target.value),placeholder:"File name"}),(0,n.jsx)(K.Z.Text,{id:"basic-addon2",children:".csv"})]}),(0,n.jsx)(q,{title:"File name",className:"ms-2",children:"Choose a name and save your classifications in local computer"})]})})]}),a.cols.classification.enabled&&(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"colFilter",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Classification"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(Q.Z.Check,{inline:!0,className:"me-2",checked:"all"===m,label:"all",name:"filterClass",type:"radio",value:"all",id:"filterClass-1",onChange:e=>h("all")}),(0,n.jsx)(Q.Z.Check,{inline:!0,className:"me-2",checked:"classified"===m,label:"classified only",name:"filterClass",type:"radio",value:"classified",id:"filterClass-2",onChange:e=>h("classified")}),(0,n.jsx)(Q.Z.Check,{inline:!0,className:"me-2",checked:"unclassified"===m,label:"unclassified only",name:"filterClass",type:"radio",value:"unclassified",id:"filterClass-3",onChange:e=>h("unclassified")}),(0,n.jsxs)(q,{title:"Filter rows by class",className:"ms-0",children:["This setting will sample the rows based in the classification state:",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"all: "})," in this case, no filtering is performed and the output table will contain all rows, including both classified and unclassified rows"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"classified only: "})," the output table will contain only classified rows"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"unclassified only: "})," the output table will contain only unclassified rows"]})]})]})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"classFilter",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Rows"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(Q.Z.Check,{inline:!0,checked:u,label:"filter & sort",name:"filterRow",type:"checkbox",value:"filteredAndSorted",id:"filterRow-2",onChange:e=>p(!0)}),(0,n.jsxs)(q,{title:"Filter rows by filter",className:"ms-0",children:["This setting will sample the rows based in the following criteria:",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["If this option is ",(0,n.jsx)("b",{children:"selected"}),", the same filters applied in the application will also be applied to the output table, that is, it will contain the ",(0,n.jsx)("u",{children:"same rows that you are seeing in the application"})," and in the same order."]}),(0,n.jsxs)("li",{children:["If this option is ",(0,n.jsx)("b",{children:"unselected"}),", no filtering is performed and the output table will have the ",(0,n.jsx)("u",{children:"same rows as the input table"})," and in same order."]})]}),(0,n.jsx)("b",{children:"Note: "})," If you have not applied any filtering or sorting to the columns, then the result will be the same for any option in this setting."]})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"my-3",controlId:"classDownloadBtn",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"2",className:"text-end"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsx)(K.Z,{children:(0,n.jsxs)(I.Z,{variant:"primary",type:"submit",children:[(0,n.jsx)(Y.xOH,{size:18,className:"me-1"})," ","Download table"]})})})]})]})})]})};function J(){let{tcState:e}=j(),[s,l]=(0,i.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.Z,{variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>l(!0),size:"sm",children:[(0,n.jsx)(Y.xOH,{size:19,className:"me-1"}),(0,n.jsx)("span",{children:"Download"})]}),(0,n.jsx)(X,{show:s,onHide:()=>l(!1)})]})}var $=l(5555),ee=l(9556),es=l(8937);let el=Symbol("Queued"),ea=Symbol("Loading"),et=Symbol("Load Error"),en=()=>(0,n.jsxs)("span",{className:"text-dark",children:[(0,n.jsx)(es.xps,{size:15})," Queued"]}),ei=()=>(0,n.jsxs)("span",{className:"text-primary",children:[(0,n.jsx)($.uKn,{size:15})," Downloading"]}),ec=()=>(0,n.jsxs)("span",{className:"text-danger",children:[(0,n.jsx)($.wr$,{size:15})," Server Error"]});function er(e){let s=(0,i.useMemo)(()=>e.value===el?en:e.value===ea?ei:e.value===et?ec:()=>(0,n.jsx)("span",{children:e.value}),[e.value]);return(0,n.jsx)(s,{})}let eo=e=>{let{show:s,onHide:l,src:a,size:t,zoomWidth:i,zoomHeight:c}=e;return(0,n.jsx)(N.Z,{centered:!0,show:s,onHide:l,animation:!1,size:t,children:(0,n.jsx)(N.Z.Body,{className:"mx-auto px-0 py-2",children:(0,n.jsx)("img",{src:a,width:i,height:c,alt:""})})})},ed=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-dark",children:[(0,n.jsx)(es.xps,{size:15})," Queued"]})}),em=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-primary",children:[(0,n.jsx)($.uKn,{size:15})," Downloading"]})}),eh=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-danger",children:[(0,n.jsx)($.wr$,{size:15})," Server Error"]})});function eu(e){let{src:s,zoomWidth:l,zoomHeight:a,modalSize:t="",lazy:c=!1}=e,[r,o]=(0,i.useState)(!1),d=(0,i.useMemo)(()=>s===el?ed:s===ea?em:s===et?eh:()=>(0,n.jsx)("img",{src:s,alt:"",loading:c?"lazy":"eager",height:120,style:{cursor:"zoom-in"},onClick:()=>o(!0)}),[s]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{}),(0,n.jsx)(eo,{show:r,onHide:()=>o(!1),src:s,size:t,zoomWidth:l,zoomHeight:a})]})}function ep(e){let{zoomWidth:s,zoomHeight:l,modalSize:a="",lazy:t=!1}=e;return function(e){return(0,n.jsx)(eu,{src:e.value,zoomWidth:s,zoomHeight:l,modalSize:a,lazy:t})}}var ex=l(7460),eg=l.n(ex),ej=l(918),ef=l(2634);let ey=e=>{if(e)return new Promise((s,l)=>{eg().parse(e,{complete:e=>{let{data:l}=e;return s(l)},error:e=>l(e),skipEmptyLines:!0,header:!0,dynamicTyping:!0,transformHeader:(e,s)=>"tab:".concat(e)})})},eb=e=>{if(e)return new Promise((s,l)=>{eg().parse(e,{complete:e=>{let{data:l}=e;return s(l)},error:e=>l(e),skipEmptyLines:!0,header:!0,dynamicTyping:!0,download:!0,transformHeader:(e,s)=>"tab:".concat(e)})})},eC=e=>"string"==typeof e||e instanceof String?eb(e):ey(e),eS=e=>new Promise((s,l)=>{eg().parse(e,{complete:e=>{var a;if(e.errors.length>0)return l(e.errors);s(null===(a=e.data)||void 0===a?void 0:a[0])},preview:1})}),ev=e=>new Promise((s,l)=>{eg().parse(e,{complete:e=>{var a;if(e.errors.length>0)return l(e.errors);s(null===(a=e.data)||void 0===a?void 0:a[0])},preview:1,download:!0})}),eI=e=>"string"==typeof e||e instanceof String?ev(e):eS(e),eN=e=>new Promise((s,l)=>{(async()=>{await (0,ej.RL)({file:await e.arrayBuffer(),onComplete:e=>s(e),compressors:ef.F})})().catch(e=>l(e))}),eZ=e=>new Promise((s,l)=>{(async()=>{await (0,ej.RL)({file:await (0,ej.EU)(e),onComplete:e=>s(e),compressors:ef.F})})().catch(e=>l(e))}),e_=e=>"string"==typeof e||e instanceof String?eZ(e):eN(e),eT=async e=>{let s=(0,ej.tI)(await e.arrayBuffer());return console.log(s),s.schema.filter(e=>"schema"!==e.name).map(e=>e.name)},ew=async e=>(await (0,ej.uI)(await (0,ej.EU)(e))).schema.filter(e=>"schema"!==e.name).map(e=>e.name),eE=e=>"string"==typeof e||e instanceof String?ew(e):eT(e),eL=async e=>{let s=(0,ej.tI)(await e.arrayBuffer()),l={BOOLEAN:"boolean",INT32:"number",INT64:"number",INT96:"number",FLOAT:"number",DOUBLE:"number",STRING:"text",BYTE_ARRAY:"object",FIXED_LEN_BYTE_ARRAY:"object",DEFAULT:void 0};return s.schema.filter(e=>"schema"!==e.name).map(e=>{var s,a,t;return l[(null===(a=e.logical_type)||void 0===a?void 0:null===(s=a.type)||void 0===s?void 0:s.toUpperCase())||(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())||"DEFAULT"]})},eR=async e=>{let s=await (0,ej.uI)(await (0,ej.EU)(e)),l={BOOLEAN:"boolean",INT32:"number",INT64:"number",INT96:"number",FLOAT:"number",DOUBLE:"number",STRING:"text",BYTE_ARRAY:"object",FIXED_LEN_BYTE_ARRAY:"object",DEFAULT:void 0};return s.schema.filter(e=>"schema"!==e.name).map(e=>{var s,a,t;return l[(null===(a=e.logical_type)||void 0===a?void 0:null===(s=a.type)||void 0===s?void 0:s.toUpperCase())||(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())||"DEFAULT"]})},eA=e=>"string"==typeof e||e instanceof String?eR(e):eL(e);class ek{getFileExt(){if(!this.ext){var e,s;this.isUrl?this.ext=null===(s=this.file.split(".").pop())||void 0===s?void 0:s.toLowerCase():this.ext=null===(e=this.file.name.split(".").pop())||void 0===e?void 0:e.toLowerCase()}return this.ext}async read(){if(["csv","tsv","dat","txt"].includes(this.getFileExt()||""))return await eC(this.file);if(["parquet","parq","par","pq"].includes(this.getFileExt()||"")){let e=await e_(this.file),s=await this.getColumns();return s?e.map(e=>Object.fromEntries(Object.entries(e).map(e=>{let[l,a]=e;return["tab:".concat(s[l]),a]}))):e}}async getColumns(){return["csv","tsv","dat","txt"].includes(this.getFileExt()||"")?this.columns=await eI(this.file):["parquet","parq","par","pq"].includes(this.getFileExt()||"")&&(this.columns=await eE(this.file)),this.columns}async getDataTypes(){let e;return["csv","tsv","dat","txt"].includes(this.getFileExt()||"")?e=void 0:["parquet","parq","par","pq"].includes(this.getFileExt()||"")&&(e=await eA(this.file)),e}constructor(e){this.ext=void 0,this.columns=void 0,this.isUrl="string"==typeof e||e instanceof String,this.file=e}}let eU={field:"ai:id",maxWidth:80,headerName:"#"},eG={field:"ai:class",flex:1,headerName:"class",filter:!0,cellRenderer:function(e){let{tcState:s}=j();return(0,n.jsxs)(Q.Z.Select,{value:e.value,onChange:s=>{var l;null===(l=e.api.getRowNode(e.data["ai:id"]))||void 0===l||l.setDataValue("ai:class",s.target.value)},children:[(0,n.jsx)("option",{value:"",children:"-"}),s.cols.classification.classNames.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}},eF={field:"img:splus",flex:1,headerName:"splus",cellRenderer:ep({zoomHeight:650,modalSize:"lg"})},eP={field:"img:legacy",flex:1,headerName:"legacy",cellRenderer:ep({zoomHeight:650,modalSize:"lg"})},eO={field:"img:sdss_spec",flex:1,headerName:"spec",cellRenderer:ep({zoomHeight:620,modalSize:"lg"})},eD={field:"img:splus_photospec",flex:1,headerName:"photo spec",cellRenderer:ep({zoomHeight:625,modalSize:"lg"})},ez=e=>({field:"img:custom_".concat(e),flex:1,headerName:"custom ".concat(e+1),cellRenderer:ep({zoomHeight:650,modalSize:"lg",lazy:!0})}),eM=(e,s)=>({field:"sdss:".concat(e,"_").concat(s),flex:1,headerName:s.toLowerCase(),filter:!0,cellRenderer:er}),eB=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,a=l?{cellDataType:l}:{};return console.log(e,a),{field:"tab:".concat(e),flex:1,headerName:e.toLowerCase(),filter:!0,editable:s,...a}};class eH{async load(e){let s=new ek(e);return await s.read()}getHeaderSummary(e){let s=A("ra",e),l=A("dec",e);return{raIndex:s,decIndex:l,columns:e,positionFound:s>-1&&l>-1}}async getTableSummary(e){let s=new ek(e),l=await s.getColumns(),a=await s.getDataTypes();return(console.log(a),l)?{...this.getHeaderSummary(l),dataTypes:a}:void 0}getColDefs(e){let s=[eU],l={};if(e.cols.classification.enabled&&(s.push(eG),l["ai:class"]=void 0),e.table.selectedColumnsId)for(let l of e.table.selectedColumnsId){var a;let t=e.table.columns[l],n=null===(a=e.table.dataTypes)||void 0===a?void 0:a[l],i=e.grid.editable;s.push(eB(t,i,n))}if(e.cols.sdssCatalog.selectedColumns)for(let a of e.cols.sdssCatalog.selectedColumns)s.push(eM(a.table,a.column)),l["sdss:".concat(a.table,"_").concat(a.column)]=el;return e.cols.sdssSpectra.enabled&&(s.push(eO),l["img:sdss_spec"]=el),e.cols.splusPhotoSpectra.enabled&&(s.push(eD),l["img:splus_photospec"]=el),e.cols.legacyImaging.enabled&&(s.push(eP),l["img:legacy"]=el),e.cols.splusImaging.enabled&&(s.push(eF),l["img:splus"]=el),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((e,a,t)=>{s.push(ez(a)),l["img:custom_".concat(a)]=el}),{colDef:s,initVal:l}}}var eq=new eH;function eV(){let{tcState:e}=j(),[s,l]=(0,i.useState)(!1),a=()=>{let a={...e};a.grid.editable=!s;let{colDef:t}=eq.getColDefs(a);e.grid.api.setGridOption("columnDefs",t),l(!s)};return(0,n.jsx)(n.Fragment,{children:s?(0,n.jsxs)(I.Z,{size:"sm",variant:"success",className:"ms-2 d-inline-flex align-items-center",onClick:a,children:[(0,n.jsx)($.zmo,{size:18,className:"me-1"}),(0,n.jsx)("span",{children:"Edit Mode"})]}):(0,n.jsxs)(I.Z,{size:"sm",variant:"outline-primary",className:"ms-2 d-inline-flex align-items-center",onClick:a,children:[(0,n.jsx)(ee.bt0,{size:18,className:"me-1"}),(0,n.jsx)("span",{children:"View Mode"})]})})}function eQ(){let{tcState:e}=j();return(0,n.jsx)(S.Z,{bg:"light",expand:"lg",className:"p-1",children:(0,n.jsxs)(C.Z,{children:[(0,n.jsxs)("div",{children:["grid"==e.currentView&&(0,n.jsx)(z,{}),e.grid.isLoaded&&(0,n.jsx)(J,{}),"grid"==e.currentView&&(0,n.jsx)(eV,{})]}),(0,n.jsx)(P,{}),(0,n.jsxs)("div",{children:[(0,n.jsx)(O,{}),(0,n.jsx)(L,{})]})]})})}var eK=l(7142),eW=l(8223),eY=l(7615),eX=l.n(eY);function eJ(e){let{children:s,value:l=null,className:a="",onClose:t=()=>{},closeable:i=!0}=e;return(0,n.jsxs)("div",{className:"".concat(eX().chip," ").concat(a),children:[s,i&&(0,n.jsx)("span",{className:eX().closebtn,onClick:e=>{t(e,l)},children:"\xd7"})]})}let e$=(e,s,l)=>{let a=e.trim();a&&!s.includes(a)&&(s.push(a),l({type:t.CLASSIFICATION_CONFIG,payload:{classNames:s}}))},e0=(e,s,l)=>{let a=s.filter(s=>s!=e);l({type:t.CLASSIFICATION_CONFIG,payload:{classNames:a}})};function e1(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.classification,[a,t]=(0,i.useState)(""),[c,r]=(0,i.useState)(!1);return(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"classNames",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:1,children:"Classes"}),(0,n.jsxs)(V.Z,{sm:8,children:[(0,n.jsx)(Q.Z,{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),e$(a,l.classNames,s),t("")},children:(0,n.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(Q.Z.Control,{placeholder:"Class name",value:a,onChange:e=>t(e.target.value)}),(0,n.jsxs)(I.Z,{variant:"primary",type:"submit",className:"d-inline-flex align-items-center",children:[(0,n.jsx)(H.poH,{size:20,className:"me-1"}),(0,n.jsx)("span",{children:"Add"})]})]}),(0,n.jsxs)(q,{title:"Class Name",className:"ms-1",children:["Type the class name and press ",(0,n.jsx)("kbd",{children:"ENTER"})," or click Add button"]}),(0,n.jsxs)(I.Z,{style:{whiteSpace:"nowrap"},className:"ms-4",variant:"outline-primary",disabled:0==e.cols.classification.classNames.length,onClick:()=>r(!0),children:[(0,n.jsx)(D.P2_,{size:20,className:"me-1"})," Hotkeys"]}),(0,n.jsx)(q,{title:"Hotkeys",className:"ms-1",children:"Classify your table quickly by configuring keyboard keys to select classes"}),(0,n.jsx)(e2,{show:c,onHide:()=>r(!1)})]})}),l.classNames.map(a=>(0,n.jsxs)(eJ,{className:"mb-1 me-1",onClose:()=>e0(a,l.classNames,s),children:[a,a in e.cols.classification.keyMap&&(0,n.jsxs)("span",{children:[" (",(0,n.jsx)("b",{children:e.cols.classification.keyMap[a].toUpperCase()}),")"]})]},"cname_".concat(a)))]})]})}function e2(e){let{show:s,onHide:l}=e,{tcState:a,tcDispatch:c}=j(),r=a.cols.classification,[o,d]=(0,i.useState)(-1),m=(0,i.useCallback)(e=>{e.stopPropagation(),/^[\w\d]$/i.test(e.key)&&-1!=o&&c({type:t.CLASSIFICATION_CONFIG,payload:{keyMap:{...a.cols.classification.keyMap,[o]:e.key}}})},[c,a,o]);return(0,i.useEffect)(()=>(s?document.addEventListener("keydown",m,!0):document.removeEventListener("keydown",m,!0),()=>{document.removeEventListener("keydown",m,!0)}),[m,s]),(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{id:"contained-modal-title-vcenter",children:"Hotkeys configuration"})}),(0,n.jsxs)(N.Z.Body,{children:[(0,n.jsx)("p",{className:"mb-3",children:"Select a class below and press an alphanumeric (A-Z, 0-9) character on the keyboard. After associating the keyboard shortcuts for the desired classes, just click on the table row and press the key referring to the class."}),(0,n.jsxs)(Q.Z,{onSubmit:e=>e.preventDefault(),children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-3",controlId:"hotkeyClass",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:2,children:"Class"}),(0,n.jsx)(V.Z,{sm:10,children:(0,n.jsxs)(Q.Z.Select,{value:o,onChange:e=>d(e.target.value),children:[(0,n.jsx)("option",{value:-1,children:"Select a class"}),r.classNames.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})})]}),(0,n.jsxs)(W.Z,{className:"d-inline-flex align-items-center",children:[(0,n.jsx)(V.Z,{sm:2,children:"Hotkey"}),(0,n.jsx)(V.Z,{sm:3,children:(0,n.jsx)(Q.Z.Control,{readOnly:!0,type:"text",size:"lg",value:r.keyMap[o]?r.keyMap[o].toUpperCase():"",style:{fontWeight:800,textAlign:"center"}})}),(0,n.jsx)(V.Z,{children:(0,n.jsx)(I.Z,{className:"ps-0",variant:"link",onClick:()=>{let e=a.cols.classification.keyMap;o in e&&(delete e[o],c({type:t.CLASSIFICATION_CONFIG,payload:{keyMap:e}}))},children:"Clear"})})]})]})]})]})}function e5(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.classification;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"classCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show classification column",checked:l.enabled,onChange:e=>s({type:t.CLASSIFICATION_CONFIG,payload:{enabled:e.target.checked}})}),(0,n.jsx)(q,{title:"Enable Classifications",className:"ms-1",children:"Select this option if you want to classify the table, unsect to hide the classification column"})]})})]}),(0,n.jsx)(e1,{})]})}let e3=["iso","aper3","aper6","auto","petro","pstotal"];function e8(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.sdssSpectra,a=e.cols.splusPhotoSpectra.selectedLines,i=(e,l)=>{l.includes(e)?s({type:t.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:l.filter(s=>s!=e)}}):s({type:t.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:[...l,e]}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"sloanSpecCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:3,className:"text-end",children:"SDSS spectra"}),(0,n.jsx)(V.Z,{sm:9,className:"d-flex align-items-center",children:(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show SDSS spectra column",checked:l.enabled,onChange:e=>s({type:t.SDSS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsx)("hr",{className:"my-4"}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:3,className:"text-end",children:"S-PLUS photo-spectra"}),(0,n.jsx)(V.Z,{sm:9,className:"d-flex align-items-center",children:(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show S-PLUS photo-spectra column",checked:e.cols.splusPhotoSpectra.enabled,onChange:()=>s({type:t.SPLUS_PHOTO_SPECTRA,payload:{enabled:!e.cols.splusPhotoSpectra.enabled}})})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:3,className:"text-end",children:"Selected lines"}),(0,n.jsx)(V.Z,{sm:9,className:"d-flex align-items-center",children:e3.map(e=>(0,n.jsxs)(Q.Z.Check,{inline:!0,type:"checkbox",id:"splus-photospectra-line-".concat(e),className:"me-3",children:[(0,n.jsx)(Q.Z.Check.Input,{type:"checkbox",checked:a.includes(e),onChange:()=>i(e,a)}),(0,n.jsx)(Q.Z.Check.Label,{children:e})]},e))})]})]})}function e4(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.legacyImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"legacyImagingCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show Legacy Survey RGB images column",checked:l.enabled,onChange:e=>s({type:t.LEGACY_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsx)(W.Z,{children:(0,n.jsx)(V.Z,{sm:7,children:(0,n.jsxs)(K.Z,{className:"mb-3",children:[(0,n.jsx)(K.Z.Text,{id:"legacyImagingPixScale",children:"Pixel scale"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"legacyImagingPixScale",value:l.pixelScale,onChange:e=>s({type:t.LEGACY_IMAGING,payload:{pixelScale:e.target.value}})}),(0,n.jsx)(K.Z.Text,{id:"legacyImagingPixScale2",children:"arcsec/pixel"})]})})}),(0,n.jsx)(W.Z,{children:(0,n.jsx)(V.Z,{sm:5,children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{children:"DR"}),(0,n.jsxs)(Q.Z.Select,{value:l.dataRelease,onChange:e=>s({type:t.LEGACY_IMAGING,payload:{dataRelease:e.target.value}}),children:[(0,n.jsx)("option",{value:"10",children:"10"}),(0,n.jsx)("option",{value:"9",children:"9"})]})]})})})]})}var e6=l(1549),e9=l.n(e6);function e7(e){let{children:s,className:l="btn-light",onClick:a=()=>{}}=e;return(0,n.jsx)("div",{className:"".concat(e9().chip," ").concat(l),onClick:a,children:s})}let se=["U","F378","F395","F410","F430","G","F515","R","F660","I","F861","Z"];function ss(e){let{band:s,channel:l,variant:a}=e,{tcState:i,tcDispatch:c}=j(),r=i.cols.splusImaging.trilogyConfig,{R:o,G:d,B:m}=r,h=r[l].includes(s)?"btn-".concat(a):"btn-outline-".concat(a);return(0,n.jsx)(e7,{className:"".concat(h," me-1"),onClick:()=>c({type:t.SPLUS_TRILOGY_CONFIG,payload:function(e,s,l){let a={...e};for(let t in e)t!=s&&(a[t]=e[t].filter(e=>e!=l));return a[s].includes(l)?a[s]=a[s].filter(e=>e!=l):a[s].push(l),a}({R:o,G:d,B:m},l,s)}),children:s})}function sl(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging.trilogyConfig;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusTrilogyR",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"R"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[se.map(e=>(0,n.jsx)(ss,{band:e,channel:"R",variant:"danger"},"R_".concat(e))),(0,n.jsxs)(q,{title:"Red Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-danger",children:"red"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusTrilogyG",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"G"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[se.map(e=>(0,n.jsx)(ss,{band:e,channel:"G",variant:"success"},"G_".concat(e))),(0,n.jsxs)(q,{title:"Green Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-success",children:"green"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusTrilogyB",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"B"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[se.map(e=>(0,n.jsx)(ss,{band:e,channel:"B",variant:"primary"},"B_".concat(e))),(0,n.jsxs)(q,{title:"Blue Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-primary",children:"blue"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusTrilogyParams",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Params"}),(0,n.jsx)(V.Z,{sm:9,children:(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{className:"mb-3",children:[(0,n.jsx)(K.Z.Text,{id:"trilogy-param-noise",children:"Noise"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Noise","aria-describedby":"trilogy-param-noise",value:l.noise,onChange:e=>s({type:t.SPLUS_TRILOGY_CONFIG,payload:{noise:e.target.value}})})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{className:"mb-3",children:[(0,n.jsx)(K.Z.Text,{id:"trilogy-param-q",children:"Q"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Q","aria-describedby":"trilogy-param-q",value:l.Q,onChange:e=>s({type:t.SPLUS_TRILOGY_CONFIG,payload:{Q:e.target.value}})})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{className:"mb-3",children:[(0,n.jsx)(K.Z.Text,{id:"pixelScale",children:"Pixel scale"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Pixel scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:t.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function sa(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging.luptonConfig;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusLuptonColors",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",children:"Colors"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{children:"R"}),(0,n.jsx)(Q.Z.Select,{value:l.R,onChange:e=>s({type:t.SPLUS_LUPTON_CONFIG,payload:{R:e.target.value}}),children:se.map(e=>(0,n.jsx)("option",{children:e},e))})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{children:"G"}),(0,n.jsx)(Q.Z.Select,{value:l.G,onChange:e=>s({type:t.SPLUS_LUPTON_CONFIG,payload:{G:e.target.value}}),children:se.map(e=>(0,n.jsx)("option",{children:e},e))})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{children:"B"}),(0,n.jsx)(Q.Z.Select,{value:l.B,onChange:e=>s({type:t.SPLUS_LUPTON_CONFIG,payload:{B:e.target.value}}),children:se.map(e=>(0,n.jsx)("option",{children:e},e))})]})})]})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusLuptonParams",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{id:"lupton-param-noise",children:"Stretch"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Stretch","aria-describedby":"lupton-param-noise",value:l.stretch,onChange:e=>s({type:t.SPLUS_LUPTON_CONFIG,payload:{stretch:e.target.value}})})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(K.Z.Text,{id:"lupton-param-q",children:"Q"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Q","aria-describedby":"lupton-param-q",value:l.Q,onChange:e=>s({type:t.SPLUS_LUPTON_CONFIG,payload:{Q:e.target.value}})})]})}),(0,n.jsx)(V.Z,{children:(0,n.jsxs)(K.Z,{className:"mb-3",children:[(0,n.jsx)(K.Z.Text,{id:"pixelScale",children:"Pixel Scale"}),(0,n.jsx)(Q.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:t.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function st(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"splusImagingCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Enable"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show S-PLUS RGB images column",checked:l.enabled,onChange:e=>s({type:t.SPLUS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"classCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Type"}),(0,n.jsx)(V.Z,{sm:5,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(Q.Z.Select,{defaultValue:l.type,onChange:e=>s({type:t.SPLUS_IMAGING,payload:{type:e.target.value}}),children:[(0,n.jsx)("option",{value:"trilogy",children:"Trilogy"}),(0,n.jsx)("option",{value:"lupton",children:"Lupton"})]}),(0,n.jsxs)(q,{title:"Image Type",className:"ms-1",children:["The algorithm used to make RGB stamps from the FITS file",(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Trilogy: "})," The Trilogy algorithm",(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Lupton: "})," The Lupton method"]})]})})]}),"trilogy"==l.type?(0,n.jsx)(sl,{}):(0,n.jsx)(sa,{})]})}var sn=l(8582);let si=new(l(4146)).Z,sc={on:(e,s)=>si.on(e,s),once:(e,s)=>si.once(e,s),off:(e,s)=>si.off(e,s),emit:(e,s)=>si.emit(e,s),count:e=>si.listenerCount(e)};Object.freeze(sc);var sr=l(4304),so=l(5099);function sd(e){let{onChange:s}=e,{tcState:l}=j(),a=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(l.table.file&&a.current){let e=new DataTransfer;e.items.add(l.table.file);let s=e.files;a.current.files=s}},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"tableFile",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Table"}),(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(Q.Z.Control,{type:"file",onChange:s,ref:a}),(0,n.jsxs)(q,{title:"Local Upload",className:"ms-1",children:["Load a table available in local computer. The only required columns are ",(0,n.jsx)("code",{children:"RA"})," and ",(0,n.jsx)("code",{children:"DEC"})," in degrees.",(0,n.jsx)("br",{}),(0,n.jsx)("u",{children:"Available formars"}),": ",(0,n.jsx)("code",{children:"CSV"}),", ",(0,n.jsx)("code",{children:"TSV"}),", \xa0",(0,n.jsx)("code",{children:"DAT"}),", ",(0,n.jsx)("code",{children:"PARQUET"}),"."]})]})})]})})}function sm(e){let{onChange:s}=e,{tcState:l}=j();return(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"tableFile",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"URL"}),(0,n.jsx)(V.Z,{sm:10,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(Q.Z.Control,{placeholder:"File URL",onChange:s,value:l.table.url||""}),(0,n.jsxs)(q,{title:"Remote Upload",className:"ms-1",children:["Loads a table available remotely in the internet.",(0,n.jsx)("br",{}),(0,n.jsx)("u",{children:"Available formars"}),": ",(0,n.jsx)("code",{children:"CSV"}),", ",(0,n.jsx)("code",{children:"TSV"}),", \xa0",(0,n.jsx)("code",{children:"DAT"}),", ",(0,n.jsx)("code",{children:"PARQUET"}),"."]})]})})]})}let sh=e=>{let{state:s}=e;return"loading"==s?(0,n.jsx)("p",{className:"text-secondary",children:"Loading table..."}):"success"==s?(0,n.jsxs)("p",{className:"text-success",children:[(0,n.jsx)(sn.dZ6,{})," RA and DEC columns successfully detected"]}):"positionNotFound"==s?(0,n.jsxs)("p",{className:"text-danger",children:[(0,n.jsx)(sn.apv,{})," RA or DEC columns not detected"]}):"error"==s?(0,n.jsxs)("p",{className:"text-danger",children:[(0,n.jsx)(sn.apv,{})," Failed to load this table, check if it's a valid csv file"]}):null},su=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:c}=j(),[r,o]=(0,i.useState)(-1);return(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{id:"contained-modal-title-vcenter",children:"Select a column"})}),(0,n.jsx)(N.Z.Body,{children:(0,n.jsx)(Q.Z,{children:(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{xs:10,children:(0,n.jsxs)(Q.Z.Select,{defaultValue:-1,onChange:e=>o(parseInt(e.target.value)),children:[(0,n.jsx)("option",{value:-1,children:"Select a column to add"}),a.table.columns.map((e,s)=>({colName:e,originalIndex:s})).filter(e=>!a.table.selectedColumnsId.includes(e.originalIndex)).map(e=>(0,n.jsx)("option",{value:e.originalIndex,children:e.colName},e.originalIndex))]})}),(0,n.jsx)(V.Z,{children:(0,n.jsx)(I.Z,{variant:"success",onClick:()=>{r>=0&&!a.table.selectedColumnsId.includes(r)&&c({type:t.USER_FILE_INPUT,payload:{selectedColumnsId:[...a.table.selectedColumnsId,r]}})},children:"Add"})})]})})})]})},sp=()=>{let{tcState:e,tcDispatch:s}=j(),l=e=>{s({type:t.USER_FILE_INPUT,payload:{type:e.target.value}})};return(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"tableSourceSelector",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Source"}),(0,n.jsx)(V.Z,{sm:"5",children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(Q.Z.Check,{inline:!0,checked:"local"===e.table.type,label:"local",name:"tableType",type:"radio",value:"local",id:"tableType-1",onChange:l}),(0,n.jsx)(Q.Z.Check,{inline:!0,checked:"remote"===e.table.type,className:"ms-2",label:"remote",name:"tableType",type:"radio",value:"remote",id:"tableType-2",onChange:l}),(0,n.jsxs)(q,{title:"Upload Type",children:["Select upload type based on where the source table is stored.",(0,n.jsx)("br",{}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Local: "})," Table stored in local computer",(0,n.jsx)("br",{})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Remote: "})," Table available in internet"]})]})]})]})})]})};function sx(){let{tcState:e,tcDispatch:s}=j(),[l,a]=(0,i.useState)(!1),c=(0,i.useCallback)(l=>{if(l.target.files.length>0){let a=l.target.files[0];s({type:t.USER_FILE_INPUT,payload:{status:"loading"}}),eq.getTableSummary(a).then(l=>{if(null==l?void 0:l.positionFound){var n,i,c;let r="local"===e.table.type&&(a.name===(null===(n=e.table.file)||void 0===n?void 0:n.name)||a.size===(null===(i=e.table.file)||void 0===i?void 0:i.size)||a.lastModified===(null===(c=e.table.file)||void 0===c?void 0:c.lastModified));r||s({type:t.GRID_UPDATE,payload:{data:[],colDefs:[]}}),s({type:t.USER_FILE_INPUT,payload:{type:"local",columns:l.columns,selectedColumnsId:[l.raIndex,l.decIndex],raIndex:l.raIndex,decIndex:l.decIndex,dataTypes:l.dataTypes,status:"success",file:a,isSameFile:r}}),(0,sr.B)("load_file_local",{category:"load",label:"local",userId:so.I})}else s({type:t.USER_FILE_INPUT,payload:{status:"positionNotFound"}})}).catch(e=>{console.log(e),s({type:t.USER_FILE_INPUT,payload:{status:"error"}})})}},[e,s]),r=(0,i.useCallback)(function(l){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l.length>0&&(s({type:t.USER_FILE_INPUT,payload:{status:"loading"}}),eq.getTableSummary(l).then(n=>{if(null==n?void 0:n.positionFound){let i="remote"===e.table.type&&l==e.table.url;i||s({type:t.GRID_UPDATE,payload:{data:[],colDefs:[]}}),s({type:t.USER_FILE_INPUT,payload:{type:"remote",columns:n.columns,selectedColumnsId:[n.raIndex,n.decIndex],raIndex:n.raIndex,decIndex:n.decIndex,dataTypes:n.dataTypes,status:"success",url:l,isSameFile:i}}),a&&s({type:t.CURRENT_VIEW_CHANGE,payload:"grid"}),(0,sr.B)("load_file_remote",{category:"load",label:"remote",userId:so.I})}else s({type:t.USER_FILE_INPUT,payload:{status:"positionNotFound"}})}).catch(e=>{s({type:t.USER_FILE_INPUT,payload:{status:"error"}})}))},[s,e]),o=(l,a)=>{s({type:t.USER_FILE_INPUT,payload:{selectedColumnsId:e.table.selectedColumnsId.filter(e=>e!=a)}})};return(0,i.useEffect)(()=>{sc.on("INSERT_URL",e=>r(e.url,!0)),(0,sr.B)("load_file_example",{category:"load",label:"example",userId:so.I})},[r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sp,{}),"local"==e.table.type?(0,n.jsx)(sd,{onChange:c}):(0,n.jsx)(sm,{onChange:e=>r(e.target.value)}),(0,n.jsx)(sh,{state:e.table.state}),e.table.selectedColumnsId.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"fw-bold",children:"Selected columns:"})," ",e.table.selectedColumnsId.map(s=>(0,n.jsx)(eJ,{value:s,className:"mb-1 me-1",onClose:o,closeable:s!=e.table.raIndex&&s!=e.table.decIndex,children:e.table.columns[s]},"sourceColIdx_".concat(s))),(0,n.jsx)(I.Z,{variant:"link",className:"py-0",onClick:()=>a(!0),children:"Add more"})]}),(0,n.jsx)(su,{show:l,onHide:()=>a(!1)})]})}var sg=l(9797),sj=l(9800);class sf{callFunction(e){for(var s=arguments.length,l=Array(s>1?s-1:0),a=1;a<s;a++)l[a-1]=arguments[a];return new Promise((s,a)=>{this.currentRequests.push({resolve:s,reject:a,fnToCall:e,args:l}),this.tryNext()})}tryNext(){if(this.runningRequests<this.maxConcurrentRequests){let e=this.currentRequests.shift();if(e){this.runningRequests++;let s=e.args;e.fnToCall.apply(null,s).then(s=>e.resolve(s)).catch(s=>e.reject(s)).finally(()=>{this.runningRequests--,this.tryNext()})}}}clear(){this.currentRequests=[]}constructor(e=1){this.currentRequests=[],this.runningRequests=0,this.maxConcurrentRequests=e}}class sy{create(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e in this.pool||(this.pool[e]=new sf(s))}enqueue(e,s){for(var l=arguments.length,a=Array(l>2?l-2:0),t=2;t<l;t++)a[t-2]=arguments[t];return this.pool[e].callFunction(s,...a)}getSignal(){return this.controller.signal}clear(e){if(e)this.pool[e].clear();else for(let e in this.pool)this.pool[e].clear()}constructor(){this.pool={},this.controller=new AbortController}}let sb=new sy;var sC=l(7066),sS=l(4400),sv=l.n(sS),sI=l(6772);sb.create("sdss_cone_spec",4),sb.create("sdss_sql",2),sb.create("sdss_batch_query",2),sb.create("sdss_query",2);let sN=new sI.S({defaultOptions:{queries:{staleTime:R(1,"day","ms")}}});class sZ{getQuery(e,s,l,a){return"SELECT p.fiber2Mag_z ".concat(a.map(e=>"t.".concat(e)).join(","),"\n    FROM PhotoObj p, dbo.fGetNearbyObjEq(326.8952189, 0.7732093, 0.02) n\n    WHERE p.objID = n.objID")}getCrossIdQuery(e,s){let l="photo"==this.objType?"objID":"specObjID";return"\n    SELECT \n      ".concat(s.map(e=>"t.".concat(e)).join(","),"\n    FROM #upload u\n      JOIN #x x ON x.up_id = u.up_id\n      JOIN ").concat(e," t ON t.").concat(this.pkColumn||l," = x.").concat(l,"\n    ORDER by x.up_id\n    ").trim()}constructor(e){let{objType:s="photo",raColumn:l="ra",decColumn:a="dec",pkColumn:t=null}=e||{};this.raColumn=l,this.decColumn=a,this.pkColumn=t,this.objType=s}}let s_={PhotoTag:{searchStrategy:new sZ,type:"view"},SpecObjAll:{searchStrategy:new sZ({objType:"spectro"}),type:"table"},emissionLinesPort:{searchStrategy:new sZ({objType:"spectro"}),type:"table"},TwoMass:{searchStrategy:new sZ,type:"table"},zooSpec:{searchStrategy:new sZ,type:"table"},zooNoSpec:{searchStrategy:new sZ,type:"table"},zoo2MainSpecZ:{searchStrategy:new sZ({pkColumn:"dr8objid"}),type:"table"}};class sT{async getObjSpecId(e,s){try{return(await sN.fetchQuery({queryKey:["sdss-service-specid",e,s],queryFn:()=>sC.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SpectroQuery/ConeSpectro",{params:{ra:e,dec:s,radius:.01667,limit:1,format:"xml",specparams:"specObjID",imgparams:"none",zWarning:"on"},signal:sb.getSignal(),transformResponse:e=>{let s=new DOMParser().parseFromString(e,"application/xml").querySelector('Table[name="Table1"] > Row > Item[name="specObjID"]');return null==s?void 0:s.textContent}})})).data}catch(e){console.log(e)}}getTables(){return Object.keys(s_)}async getColumns(e){var s,l;let a;a="table"==s_[e].type?"SELECT name, description, unit \n      FROM DBColumns \n      WHERE tablename='".concat(e,"'"):"\n      SELECT tc.name name, tc.description description, tc.unit unit\n      FROM DBColumns tc\n      INNER JOIN DBViewCols vc ON vc.parent = tc.tablename AND vc.name = tc.name\n      WHERE vc.viewname='".concat(e,"' \n      ").trim();let t="".concat("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/SqlSearch","?cmd=").concat(encodeURIComponent(a),"&format=json");return null===(l=(await sN.fetchQuery({queryKey:["sdss-service-columns",e],queryFn:()=>sC.Z.get(t)})).data)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.Rows}getCsv(e){return"index,ra,dec\r\n"+(e.map(e=>"".concat(e.index,",").concat(e.ra,",").concat(e.dec)).join("\r\n")||"")}}class sw extends sT{async fetch(){let e=await this.getObjSpecId(this.ra,this.dec);if(e)return await sN.fetchQuery({queryKey:[e],queryFn:()=>sC.Z.get("https://astrotools.vercel.app/spec",{responseType:"blob",signal:sb.getSignal(),params:{id:e}})})}constructor(e,s){super(),this.ra=e,this.dec=s}}class sE extends sT{async fetch(){let e=s_[this.table].searchStrategy,s=e.getCrossIdQuery(this.table,[this.column]);return await sN.fetchQuery({queryKey:["sdss-query",this.ra,this.dec,this.table,this.column],queryFn:()=>sC.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/CrossIdSearch",{params:{searchtool:"CrossID",searchType:e.objType,photoScope:"nearPrim",spectroScope:"nearPrim",photoUpType:"ra-dec",spectroUpType:"ra-dec",radius:.016667,firstcol:1,paste:this.getCsv([{index:0,ra:this.ra,dec:this.dec}]),uquery:s,format:"JSON"},transformResponse:e=>{var s;let l=sv()({storeAsString:!0}).parse(e).find(e=>"Table1"==e.TableName).Rows;if(l.length>0)return null===(s=l[0])||void 0===s?void 0:s[this.column]}})})}constructor(e,s,l,a){super(),this.ra=e,this.dec=s,this.table=l,this.column=a}}var sL=l(9282);let sR=e=>{let{items:s,active:l,onClick:a,height:t,className:i}=e;return(0,n.jsx)(eW.Z,{className:"".concat(i," overflow-auto"),style:{height:t},children:s.map((e,s)=>(0,n.jsx)(eW.Z.Item,{action:!0,active:l==e,onClick:l=>a({title:e,index:s,event:l}),children:e},s))})},sA=e=>{let{items:s,active:l,onClick:a,height:t,className:i}=e;return(0,n.jsx)(eW.Z,{className:"".concat(i," overflow-auto"),style:{height:t},children:s.map((e,s)=>(0,n.jsx)(eW.Z.Item,{action:!0,variant:l&&l.includes(e)?"primary":"",onClick:l=>a({title:e,index:s,event:l}),children:e},s))})},sk=e=>{let{className:s,height:l}=e;return(0,n.jsxs)(eW.Z,{className:"".concat(s," overflow-auto"),style:{height:l},children:[(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:6})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:9})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:4})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:5})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:11})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:7})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:8})}),(0,n.jsx)(sL.Z,{as:eW.Z.Item,animation:"glow",children:(0,n.jsx)(sL.Z,{xs:5})})]})};function sU(e){let{items:s=[],active:l=[],multiple:a=!1,placeholder:t=!1,onClick:i=()=>{},height:c=260,className:r=""}=e;return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)(sk,{className:r,height:c}):a?(0,n.jsx)(sA,{items:s,active:l,onClick:i,height:c,className:r}):(0,n.jsx)(sR,{items:s,active:l,onClick:i,height:c,className:r})})}var sG=l(4908),sF=l.n(sG);let sP=new sT,sO=sP.getTables(),sD=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:c}=j(),[r,o]=(0,i.useState)(sO[0]),[d,m]=(0,i.useState)(""),[h,u]=(0,i.useState)([]),[p,x]=(0,i.useState)(!0),g=a.cols.sdssCatalog.selectedColumns;(0,i.useEffect)(()=>{sP.getColumns(r).then(e=>{x(!1),u(e)}).catch(()=>{})},[r]);let f=(0,i.useMemo)(()=>null==h?void 0:h.map(e=>e.name),[h])||[],y=(0,i.useMemo)(()=>null==h?void 0:h.find(e=>e.name==d),[h,d]),b=(0,i.useMemo)(()=>g.findIndex(e=>e.column==d&&e.table==r)>-1,[g,d,r]),C=(e,s)=>{let l=g.findIndex(l=>l.column==s&&l.table==e);c({type:t.SDSS_CATALOG,payload:{selectedColumns:g.filter((e,s)=>s!=l)}})},S=(e,s)=>{c({type:t.SDSS_CATALOG,payload:{selectedColumns:[...g,{table:e,column:s}]}})};return(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,n.jsx)(N.Z.Header,{className:"py-2",closeButton:!0,children:(0,n.jsx)(N.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Add SDSS columns"})}),(0,n.jsx)(N.Z.Body,{children:(0,n.jsxs)(W.Z,{children:[(0,n.jsxs)(V.Z,{sm:5,children:[(0,n.jsxs)(W.Z,{className:"align-items-center",children:[(0,n.jsx)(V.Z,{lg:2,children:"Table:"}),(0,n.jsx)(V.Z,{children:(0,n.jsx)(Q.Z.Select,{defaultValue:r,onChange:e=>{x(!0),m(""),o(e.target.value)},children:sO.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})})]}),(0,n.jsx)(sU,{placeholder:p,items:f,active:d,className:"mt-2",height:340,onClick:e=>{let{title:s}=e;return m(s)}})]}),p?(0,n.jsxs)(V.Z,{children:[(0,n.jsx)(sj.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,n.jsxs)("span",{className:"text-muted",children:["Loading columns of the ",(0,n.jsx)("u",{children:r})," table"]})]}):(0,n.jsxs)(V.Z,{children:[g.filter(e=>e.table==r).length>0&&(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsx)("span",{className:"text-muted fw-bold",children:"Selected columns:\xa0"}),g.filter(e=>e.table==r).map(e=>(0,n.jsx)(eJ,{closeable:!0,className:"mb-1 me-1",onClose:()=>C(r,e.column),children:e.column},e.column))]}),y&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("b",{children:[y.name,":"]}),"\xa0",y.description,".\xa0",y.unit&&(0,n.jsxs)(n.Fragment,{children:["Unit: ",(0,n.jsx)("i",{dangerouslySetInnerHTML:{__html:y.unit}})]})]}),(0,n.jsx)("div",{children:b?(0,n.jsxs)(I.Z,{variant:"outline-danger",size:"sm",onClick:()=>C(r,d),children:[(0,n.jsx)(sn.HeX,{})," Remove Selected Column"]}):(0,n.jsxs)(I.Z,{variant:"outline-success",size:"sm",onClick:()=>S(r,d),children:[(0,n.jsx)(H.poH,{size:16})," Add Selected Column"]})})]})]})]})})]})};function sz(){let{tcState:e,tcDispatch:s}=j(),[l,a]=(0,i.useState)(!1),c=e.cols.sdssCatalog.selectedColumns,r=(0,i.useMemo)(()=>sF()(c.map(e=>e.table)),[c]),o=(e,l)=>{let a=c.findIndex(s=>s.column==l&&s.table==e);s({type:t.SDSS_CATALOG,payload:{selectedColumns:c.filter((e,s)=>s!=a)}})};return(0,n.jsxs)(n.Fragment,{children:[c.length>0&&(0,n.jsx)(n.Fragment,{children:r.map(e=>(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("span",{className:"me-2 fw-bold",children:[e,":"]}),c.filter(s=>s.table==e).map(e=>(0,n.jsx)(eJ,{className:"mb-1 me-1",onClose:()=>o(e.table,e.column),children:e.column},e.column))]},e))}),(0,n.jsxs)(I.Z,{size:"sm",onClick:()=>a(!0),children:[(0,n.jsx)(H.poH,{size:16})," Add SDSS columns"]}),(0,n.jsx)(sD,{show:l,onHide:()=>a(!1)})]})}let sM=e=>{var s,l;let{index:a}=e,{tcState:i,tcDispatch:c}=j(),r=i.cols.customImaging.columns[a];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(K.Z,{className:"mb-2",size:"sm",children:[(0,n.jsx)(K.Z.Text,{children:"Base URL"}),(0,n.jsx)(Q.Z.Control,{value:r.url,onChange:e=>c({type:t.CUSTOM_IMAGE_UPDATE,payload:{index:a,url:e.target.value}})})]}),(0,n.jsxs)(q,{title:"Base Resource URL",className:"mb-2 ms-1",children:["The ",(0,n.jsx)("b",{children:"base resource url"})," is the first (static) part of the URL. This value must starts with ",(0,n.jsx)("code",{children:"http://"})," ","or ",(0,n.jsx)("code",{children:"https://"}),(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})}),(0,n.jsx)(V.Z,{sm:4,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(K.Z,{size:"sm",children:[(0,n.jsx)(K.Z.Text,{children:"Suffix"}),(0,n.jsx)(Q.Z.Control,{value:r.fileExtension,onChange:e=>c({type:t.CUSTOM_IMAGE_UPDATE,payload:{index:a,fileExtension:e.target.value}})})]}),(0,n.jsxs)(q,{title:"URL Suffix",className:"ms-1",children:["The ",(0,n.jsx)("b",{children:"url suffix"})," is the last (static) part of the URL and "," ","is used to specify the file extension, for example.",(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})})]}),(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(K.Z,{className:"",size:"sm",children:[(0,n.jsx)(K.Z.Text,{children:"RI column"}),(0,n.jsxs)(Q.Z.Select,{defaultValue:(null===(l=i.cols.customImaging.columns)||void 0===l?void 0:null===(s=l[a])||void 0===s?void 0:s.columnIndex)||-1,onChange:e=>c({type:t.CUSTOM_IMAGE_UPDATE,payload:{index:a,columnIndex:parseInt(e.target.value)}}),children:[(0,n.jsx)("option",{value:-1,children:"Select a column"}),i.table.columns.map((e,s)=>(0,n.jsx)("option",{value:s,children:e},s))]})]}),(0,n.jsxs)(q,{title:"Resource Identification Column",className:" ms-1",children:["The ",(0,n.jsx)("b",{children:"resource identification column"})," (RI column) is the "," ","only variable part of the url. This field must specify the "," ","column to use to make a specific url for each row.",(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI Column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})}),(0,n.jsx)(V.Z,{sm:4,children:(0,n.jsxs)(I.Z,{variant:"outline-danger",size:"sm",onClick:()=>c({type:t.CUSTOM_IMAGE_REMOVE,payload:{index:a,prevColumns:i.cols.customImaging.columns}}),children:[(0,n.jsx)(sn.HeX,{})," Remove column"]})})]})]})};function sB(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.customImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(Q.Z.Group,{as:W.Z,className:"mb-2",controlId:"customImagingCheck",children:[(0,n.jsx)(Q.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(V.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(Q.Z.Check,{type:"switch",label:"Show custom images columns",checked:l.enabled,onChange:e=>s({type:t.CUSTOM_IMAGE_ENABLE,payload:{enabled:e.target.checked}})})})]}),l.columns.map((e,s)=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(sM,{index:s}),(0,n.jsx)("hr",{className:"my-4"})]},s)),(0,n.jsx)(W.Z,{children:(0,n.jsx)(V.Z,{children:(0,n.jsxs)(I.Z,{size:"sm",onClick:()=>s({type:t.CUSTOM_IMAGE_NEW,payload:{prevColumns:e.cols.customImaging.columns}}),children:[(0,n.jsx)(H.poH,{size:16})," Add custom image column"]})})})]})}var sH=l(1950),sq=l(7405);let sV=e=>{let{name:s,url:l}=e,{tcDispatch:a}=j();return(0,n.jsx)(I.Z,{variant:"link",onClick:()=>{a({type:t.USER_FILE_INPUT,payload:{type:"remote",url:l}}),sc.emit("INSERT_URL",{url:l})},children:s})};function sQ(){let{tcState:e,tcDispatch:s}=j();return(0,n.jsxs)(C.Z,{className:"mt-5",children:[(0,n.jsxs)("div",{className:"border rounded rounded-3 p-4",style:{backgroundColor:"#fafafa"},children:[(0,n.jsxs)("h6",{className:"text-center mb-4 d-flex align-items-center justify-content-center",children:[(0,n.jsx)(sq.s7j,{className:"me-2",size:20}),(0,n.jsx)("span",{children:"Table Settings"})]}),(0,n.jsxs)(eK.Z.Container,{id:"list-group-tabs-example",defaultActiveKey:"#select-table",children:[(0,n.jsxs)(W.Z,{children:[(0,n.jsx)(V.Z,{sm:3,children:(0,n.jsxs)(eW.Z,{children:[(0,n.jsx)(eW.Z.Item,{action:!0,href:"#select-table",children:"Select a table"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#classification",children:"Classification"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#sdss",children:"SDSS catalog"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#splus",children:"S-PLUS images"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#legacy",children:"Legacy images"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#custom-images",children:"Custom images"}),(0,n.jsx)(eW.Z.Item,{action:!0,href:"#spectra",children:"Spectra & photo-spectra"})]})}),(0,n.jsx)(V.Z,{sm:9,children:(0,n.jsxs)(eK.Z.Content,{children:[(0,n.jsx)(eK.Z.Pane,{eventKey:"#select-table",children:(0,n.jsx)(sx,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#classification",children:(0,n.jsx)(e5,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#sdss",children:(0,n.jsx)(sz,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#splus",children:(0,n.jsx)(st,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#legacy",children:(0,n.jsx)(e4,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#custom-images",children:(0,n.jsx)(sB,{})}),(0,n.jsx)(eK.Z.Pane,{eventKey:"#spectra",children:(0,n.jsx)(e8,{})})]})})]}),(0,n.jsx)(W.Z,{children:(0,n.jsx)(V.Z,{sm:3,className:"mx-auto",children:(0,n.jsx)(I.Z,{className:"mt-3 w-100 fw-bold",variant:"success",size:"lg",onClick:e=>{s({type:t.CURRENT_VIEW_CHANGE,payload:"grid"})},disabled:"success"!==e.table.status,children:"loading"===e.table.status?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sj.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"light"})," Loading"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sH.tcg,{className:"me-2",size:30})," Load Table"]})})})})]})]}),(0,n.jsxs)(W.Z,{className:"mt-5",children:[(0,n.jsx)(V.Z,{sm:7,children:(0,n.jsxs)(sg.Z,{variant:"info",children:[(0,n.jsx)(sg.Z.Heading,{children:"\uD83C\uDF89 New Version!"}),(0,n.jsx)("h6",{children:"Features of the software release v1.0:"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["Add support to ",(0,n.jsx)("b",{children:"PARQUET"})," files"]}),(0,n.jsxs)("li",{children:["Handle ",(0,n.jsx)("b",{children:"big tables"})," (hundreds of thousands of rows)"]}),(0,n.jsxs)("li",{children:["Column relocation and row ",(0,n.jsx)("b",{children:"sorting and filtering"})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Faster loading"})," of resources with multiple parallel connections"]}),(0,n.jsxs)("li",{children:["Display of the ",(0,n.jsx)("b",{children:"loading status"})," of each external resource"]}),(0,n.jsx)("li",{children:"Support for remote files"})]})]})}),(0,n.jsx)(V.Z,{sm:5,children:(0,n.jsxs)(sg.Z,{variant:"success",children:[(0,n.jsx)(sg.Z.Heading,{children:"\uD83D\uDCA1 Examples"}),(0,n.jsx)("h6",{children:"Click on one of the links below to open an example table:"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(sV,{name:"galaxyzoo-small-sample.csv",url:"https://astroinspect.natanael.net/examples/galaxyzoo-small-sample.csv"}),"\xa0(250 rows, 11.5kB)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(sV,{name:"galaxyzoo-medium-sample.csv",url:"https://astroinspect.natanael.net/examples/galaxyzoo-medium-sample.csv"}),"\xa0(2,500 rows, 113.8kB)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(sV,{name:"galaxyzoo-big-sample.parquet",url:"https://astroinspect.natanael.net/examples/galaxyzoo-big-sample.parquet"}),"\xa0(250,000 rows, 6.8MB)"]})]})]})})]})]})}let sK=new sI.S({defaultOptions:{queries:{staleTime:R(1,"day","ms")}}});class sW{async fetch(){return await sK.fetchQuery({queryKey:[this.ra,this.dec,this.size,this.pixscale,this.layer],queryFn:()=>sC.Z.get("https://www.legacysurvey.org/viewer/cutout.jpg",{responseType:"blob",signal:sb.getSignal(),params:{ra:this.ra,dec:this.dec,size:this.size,pixscale:this.pixscale,layer:this.layer}})})}constructor(e,s,l,a,t="ls-dr10"){this.ra=e,this.dec=s,this.layer=t,this.pixscale=a,this.size=l}}l(6932);let sY=new sI.S({defaultOptions:{queries:{staleTime:R(12,"hour","ms")}}});sb.create("splus-flux-radius",1);class sX{getParams(){var e,s,l,a,t,n,i,c,r,o,d,m,h;return"trilogy"===this.type?{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(i=this.config)||void 0===i?void 0:null===(n=i.R)||void 0===n?void 0:n.join(","),g:null===(r=this.config)||void 0===r?void 0:null===(c=r.G)||void 0===c?void 0:c.join(","),b:null===(d=this.config)||void 0===d?void 0:null===(o=d.B)||void 0===o?void 0:o.join(","),noise:null===(m=this.config)||void 0===m?void 0:m.noise,q:null===(h=this.config)||void 0===h?void 0:h.Q}:{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(e=this.config)||void 0===e?void 0:e.R,g:null===(s=this.config)||void 0===s?void 0:s.G,b:null===(l=this.config)||void 0===l?void 0:l.B,stretch:null===(a=this.config)||void 0===a?void 0:a.stretch,q:null===(t=this.config)||void 0===t?void 0:t.Q}}getUrl(){return"trilogy"===this.type?"https://checker-melted-forsythia.glitch.me/trilogy.png":"https://checker-melted-forsythia.glitch.me/lupton.png"}async fetch(){return await sY.fetchQuery({queryKey:[this.ra,this.dec,this.stampSize,this.type,this.config],queryFn:()=>sC.Z.get(this.getUrl(),{responseType:"blob",signal:sb.getSignal(),params:this.getParams()})})}constructor(e,s,l,a,t){this.ra=e,this.dec=s,this.pixscale=l,this.type=a,this.config=t,this.stampSize=Math.min(Math.round(300*this.pixscale/.55),1e3)}}class sJ{async fetch(){return await sY.fetchQuery({queryKey:[this.ra,this.dec,this.lines],queryFn:()=>sC.Z.get("https://astrotools.vercel.app/plot",{responseType:"blob",signal:sb.getSignal(),params:{ra:this.ra,dec:this.dec,...this.lines.map(e=>({[e]:""}))}})})}constructor(e,s,l){this.ra=e,this.dec=s,this.lines=l}}l(3809),l(7180);var s$=l(975),s0=l(361),s1=l.n(s0),s2=l(4173);l(9422),sb.create("img:legacy",4),sb.create("img:splus",4),sb.create("img:splus_photospec",4),sb.create("img:sdss_spec",4),sb.create("sdss_cat",4);let s5=async e=>{let{resourceFetch:s,colId:l,rowId:a,grid:t,isImage:n=!0}=e,i=t.api.getRowNode(a);if(((null==i?void 0:i.data[l])===el||(null==i?void 0:i.data[l])===void 0)&&(null==i?void 0:i.data.hasOwnProperty(l)))try{null==i||i.setDataValue(l,ea);let e=await s.fetch();n?null==i||i.setDataValue(l,URL.createObjectURL(e.data)):null==i||i.setDataValue(l,e.data)}catch(e){null==i||i.setDataValue(l,et)}},s3=e=>{let{url:s,colId:l,rowId:a,grid:t}=e,n=t.api.getRowNode(a);if(((null==n?void 0:n.data[l])===el||(null==n?void 0:n.data[l])===void 0)&&(null==n?void 0:n.data.hasOwnProperty(l)))try{null==n||n.setDataValue(l,s)}catch(e){null==n||n.setDataValue(l,et)}};function s8(){let{tcState:e,tcDispatch:s}=j(),[l,a]=(0,i.useState)(!0),c=(0,i.useRef)(null),r=(0,i.useCallback)(async l=>{var n;let i,c;e.table.isSameFile&&(null===(n=e.grid.currColConfigs)||void 0===n?void 0:n.classification.enabled)&&e.cols.classification.enabled&&(c=e.grid.data.map(e=>({"ai:class":e["ai:class"]}))),i="local"===e.table.type?await eq.load(e.table.file):await eq.load(e.table.url);let{colDef:r,initVal:o}=eq.getColDefs(e);i=null==i?void 0:i.map((e,s,l)=>({...e,...o,"ai:id":String(s+1)})),c&&(i=null==i?void 0:i.map((e,s,l)=>({...e,...c[s]}))),a(!1),s({type:t.GRID_UPDATE,payload:{data:i,colDef:r,isLoaded:!0,currColConfigs:s1()(e.cols),currTable:{...e.table},api:l.api}}),s({type:t.USER_FILE_INPUT,payload:{isSameFile:!0}})},[e,s]),o=(0,i.useCallback)(s=>{let l=s.api.paginationGetPageSize(),a=s.api.paginationGetCurrentPage(),t=[];s.api.forEachNodeAfterFilterAndSort(e=>{t.push(e.data)});let n=a*l,i=t.slice(n,n+l),r=e.table.columns[e.table.raIndex],o=e.table.columns[e.table.decIndex];sb.clear(),i.forEach(s=>{let l=s["tab:".concat(r)],a=s["tab:".concat(o)],t=s["ai:id"];if(e.cols.legacyImaging.enabled&&sb.enqueue("img:legacy",s5,{resourceFetch:new sW(l,a,300,e.cols.legacyImaging.pixelScale),colId:"img:legacy",rowId:t,grid:c.current}),e.cols.splusImaging.enabled){let s="trilogy"===e.cols.splusImaging.type?e.cols.splusImaging.trilogyConfig:e.cols.splusImaging.luptonConfig;sb.enqueue("img:splus",s5,{resourceFetch:new sX(l,a,e.cols.splusImaging.pixelScale,e.cols.splusImaging.type,s),colId:"img:splus",rowId:t,grid:c.current})}e.cols.splusPhotoSpectra.enabled&&sb.enqueue("img:splus_photospec",s5,{resourceFetch:new sJ(l,a,e.cols.splusPhotoSpectra.selectedLines),colId:"img:splus_photospec",rowId:t,grid:c.current}),e.cols.sdssSpectra.enabled&&sb.enqueue("img:sdss_spec",s5,{resourceFetch:new sw(l,a),colId:"img:sdss_spec",rowId:t,grid:c.current}),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((l,a,n)=>{let i="tab:".concat(e.table.columns[l.columnIndex]);s3({url:"".concat(l.url).concat(String(s[i])).concat(l.fileExtension),colId:"img:custom_".concat(a),rowId:t,grid:c.current})}),e.cols.sdssCatalog.selectedColumns.forEach(e=>{sb.enqueue("sdss_cat",s5,{resourceFetch:new sE(l,a,e.table,e.column),colId:"sdss:".concat(e.table,"_").concat(e.column),rowId:t,grid:c.current,isImage:!1})})})},[e]),d=(0,i.useCallback)(s=>{let l=s.event;if(l){if("c"===l.key.toLowerCase()&&l.ctrlKey)navigator.clipboard.writeText(s.value),s2.Am.success("Copied: ".concat(s.value),{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"dark",delay:100});else if(e.cols.classification.enabled&&!l.altKey&&!l.ctrlKey&&!l.shiftKey)for(let[a,t]of Object.entries(e.cols.classification.keyMap))t.toLowerCase()==l.key.toLowerCase()&&s.node.setDataValue("ai:class",a)}},[]),m=(0,i.useCallback)(e=>e.data["ai:id"],[]),h=(0,i.useMemo)(()=>[25,50,75,100,150,200,400],[]),u={};return(e.cols.legacyImaging.enabled||e.cols.sdssSpectra.enabled||e.cols.splusPhotoSpectra.enabled||e.cols.customImaging.enabled&&e.cols.customImaging.columns.length>0)&&(u={rowHeight:120}),(0,n.jsxs)(C.Z,{fluid:!0,className:"px-0",style:{height:"100%"},children:[(0,n.jsx)("div",{className:"ag-theme-quartz",style:{width:"100%",height:"100%","--ag-cell-horizontal-padding":"8px","--ag-borders":"solid 1px","--ag-wrapper-border-radius":"0px","--ag-header-height":"38px"},children:(0,n.jsx)(s$.s,{gridOptions:u,ref:c,rowData:e.grid.data||[],columnDefs:e.grid.colDef||[],getRowId:m,loading:l,style:{height:"100%"},pagination:!0,paginationPageSize:50,paginationPageSizeSelector:h,onGridReady:r,onPaginationChanged:o,onSortChanged:o,onFilterChanged:o,onCellKeyDown:d,singleClickEdit:!0})}),(0,n.jsx)(s2.Ix,{})]})}function s4(){let{tcState:e}=j();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,n.jsx)(eQ,{}),(0,n.jsx)("div",{className:"flex-grow-1",children:"settings"==e.currentView?(0,n.jsx)(sQ,{}):(0,n.jsx)(s8,{})})]})})}function s6(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(b(),{children:[(0,n.jsx)("link",{rel:"icon",href:"data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>\uD83C\uDF0C</text></svg>"}),(0,n.jsx)("title",{children:"AstroInspect"})]}),(0,n.jsxs)(g,{children:[(0,n.jsx)(f,{}),(0,n.jsx)(s4,{})]})]})}},1549:function(e){e.exports={chip:"ButtonChip_chip__DD9VL"}},7615:function(e){e.exports={chip:"Chip_chip__5QeIu",pointer:"Chip_pointer__BzSv_",closebtn:"Chip_closebtn__JicWE"}}},function(e){e.O(0,[909,391,838,509,510,321,365,738,817,594,563,452,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);