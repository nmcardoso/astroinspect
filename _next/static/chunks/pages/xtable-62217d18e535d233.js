(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{4963:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/xtable",function(){return t(3299)}])},2612:function(e,n,t){"use strict";t.d(n,{Z:function(){return v}});var s=t(5893),a=t(5675),r=t.n(a),i=t(682),l=t(8443),c=t(5005),o=t(6212),u=t(7294),d=t(7977),h=t(4855),m=t(1664),p=t.n(m),x=t(3750),f=t(2461),g="10.5281/zenodo.7268504",j="@software{astrotools,\n    doi = {10.5281/zenodo.7268504},\n    url = {https://doi.org/10.5281/zenodo.7268504},\n    year = {2022},\n    month = oct,\n    publisher = {Zenodo},\n    author = {Cardoso, N. M.},\n    title = {Astrotools: Web-based astronomical tools}\n}",y=function(e){var n=e.show,t=e.onHide,a=(0,u.useState)(!1),r=a[0],i=a[1],l=(0,u.useState)(!1),m=l[0],p=l[1];return(0,u.useEffect)(function(){r&&setTimeout(function(){return i(!1)},3e3),m&&setTimeout(function(){return p(!1)},3e3)},[r,m]),(0,s.jsxs)(o.Z,{show:n,onHide:t,animation:!1,size:"lg",centered:!0,children:[(0,s.jsx)(o.Z.Header,{closeButton:!0,children:(0,s.jsx)(o.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"How to cite this software"})}),(0,s.jsxs)(o.Z.Body,{children:[(0,s.jsx)("p",{children:"If you used this software during the production process of your scientific project, please consider citing it with the information provided below."}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(d.Z,{children:"DOI"}),(0,s.jsx)(h.CopyToClipboard,{text:g,onCopy:function(){return i(!0)},children:(0,s.jsx)(c.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),r&&(0,s.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,s.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:g})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)(d.Z,{children:"BibTex"}),(0,s.jsx)(h.CopyToClipboard,{text:j,onCopy:function(){return p(!0)},children:(0,s.jsx)(c.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),m&&(0,s.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,s.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:j})]})]})]})};function v(e){var n=e.title,t=(0,u.useState)(!1),a=t[0],o=t[1];return(0,s.jsx)(l.Z,{bg:"light",expand:"lg",className:"border-bottom",children:(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(l.Z.Brand,{href:"#",children:(0,s.jsx)(p(),{href:"/",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsx)(r(),{alt:"",src:"".concat((0,f.BS)(),"galaxy_128.png"),width:"30",height:"30",className:"d-inline-block align-top"}),(0,s.jsx)("span",{className:"ms-2",children:"AstroTools"})]})})}),(0,s.jsx)("div",{className:"mx-auto",children:(0,s.jsx)("span",{className:"fw-bold",children:void 0===n?"":n})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c.Z,{className:"me-2",size:"sm",variant:"outline-primary",href:"https://github.com/nmcardoso/astrotools",target:"_BLANK",children:(0,s.jsx)(x.rFR,{size:20})}),(0,s.jsx)(c.Z,{size:"sm",variant:"outline-primary",onClick:function(){return o(!0)},children:"Cite this software"}),(0,s.jsx)(y,{show:a,onHide:function(){return o(!1)}})]})]})})}},3299:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return nA}});var s,a=t(5893),r=t(682),i=t(2612),l=t(7294),c=t(9483),o=t.n(c),u=t(6042),d=t(9396),h=t(9815),m=function(){return{schemaVersion:9,table:{type:"local",file:null,url:null,selectedColumnsId:[],columns:[],raIndex:null,decIndex:null,processing:!1},classification:{enabled:!1,type:"categorical",classNames:[],positiveClass:"",negativeClass:"",filterUnclassified:!0,keyMap:{}},splusCatalog:{},sdssCatalog:{selectedColumns:[]},splusImaging:{enabled:!0,type:"trilogy",pixelScale:.25,trilogyConfig:{R:["R","I","F861","Z"],G:["G","F515","F660"],B:["U","F378","F395","F410","F430"],noise:.15,Q:.2},luptonConfig:{R:"I",G:"R",B:"G",stretch:1.4,Q:6.2}},legacyImaging:{enabled:!0,pixelScale:.25,dataRelease:"10"},sdssSpectra:{enabled:!0},splusPhotoSpectra:{enabled:!0,selectedLines:["iso","aper6"]},nearbyRedshifts:{enabled:!1},stampModal:{showAutoFluxRadius:!1,showPetroFluxRadius:!1,showRedshift:!1},customImaging:{enabled:!1,columns:[{url:"",fileExtension:"",columnIndex:-1}]}}},p=m(),x=function(e){var n=(0,d.Z)((0,u.Z)({},e),{table:m().table});o().setItem("tableConfigState",n,function(e,n){e&&console.error(e)})},f=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.splusImaging.trilogyConfig[s]=n.payload[s];return x(t),t},g=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.splusImaging[s]=n.payload[s];return x(t),t},j=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.splusImaging.luptonConfig[s]=n.payload[s];return x(t),t},y=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.table[s]=n.payload[s];return x(t),t},v=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.classification[s]=n.payload[s];return x(t),t},b=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.legacyImaging[s]=n.payload[s];return x(t),t},Z=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.sdssSpectra[s]=n.payload[s];return x(t),t},S=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.sdssCatalog[s]=n.payload[s];return x(t),t},C=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.splusPhotoSpectra[s]=n.payload[s];return x(t),t},I=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.nearbyRedshifts[s]=n.payload[s];return x(t),t},N=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.stampModal[s]=n.payload[s];return x(t),t},w=function(e,n){var t=(0,u.Z)({},e);return t.customImaging.columns=(0,h.Z)(n.payload.prevColumns).concat([{url:"",fileExtension:"",columnIndex:-1}]),x(t),t},k=function(e,n){var t=(0,u.Z)({},e);for(var s in n.payload)t.customImaging.columns[n.payload.index][s]=n.payload[s];return x(t),t},R=function(e,n){var t=(0,u.Z)({},e);return t.customImaging.columns=n.payload.prevColumns.filter(function(e,t){return t!=n.payload.index}),x(t),t},T=function(e,n){var t=(0,u.Z)({},e);return t.customImaging.enabled=n.payload.enabled,x(t),t},F=function(e,n){switch(n.type){case"loadSavedState":var t;return n.payload;case"setSplusTrilogyConfig":return f(e,n);case"setSplusImaging":return g(e,n);case"setSplusLuptonConfig":return j(e,n);case"setFileInput":return y(e,n);case"setClassification":return v(e,n);case"setLegacyImaging":return b(e,n);case"setSdssImaging":return Z(e,n);case"setSdssCatalog":return S(e,n);case"setSplusPhotoSpectra":return C(e,n);case"setNearbyRedshifts":return I(e,n);case"setStampModal":return N(e,n);case"addCustomImaging":return w(e,n);case"updateCustomImaging":return k(e,n);case"removeCustomImaging":return R(e,n);case"enableCustomImaging":return T(e,n);default:return console.log("Action ".concat(n.type," not found")),(0,u.Z)({},e)}},L=(0,l.createContext)({tcState:p,tcDispatch:function(){}}),D=function(e){var n=e.children,t=(0,l.useReducer)(F,p),s=t[0],r=t[1];return(0,a.jsx)(L.Provider,{value:{tcState:s,tcDispatch:r},children:n})},P=function(){return(0,l.useContext)(L)};function _(){var e=P().tcDispatch;return(0,l.useEffect)(function(){o().getItem("tableConfigState",function(n,t){n||null===t||9!==t.schemaVersion||e({type:"loadSavedState",payload:t})})},[e]),null}var z=t(1555),E=t(4051),B=t(4213),G=t(5888),U=t(4924),H=t(9301),M=t(1604),A=t(5005),O=t(9534),q=t(7070),Q=t(7516);function W(e){var n=e.children,t=e.title,s=void 0===t?null:t,r=e.placement,i=e.className,l=(0,a.jsxs)(q.Z,{id:"help-popover",children:[s&&(0,a.jsx)(q.Z.Header,{as:"h3",children:s}),(0,a.jsx)(q.Z.Body,{children:n})]});return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(O.Z,{trigger:"click",rootClose:!0,placement:void 0===r?"auto":r,overlay:l,children:(0,a.jsx)(A.Z,{variant:"link",className:"p-0 d-inline-flex align-items-center ".concat(void 0===i?"":i),children:(0,a.jsx)(Q.CUu,{size:20})})})})}var V=t(8193),K=t(7077),X=t.n(K);function J(e){var n=e.children,t=e.value,s=void 0===t?null:t,r=e.className,i=e.onClose,l=void 0===i?function(){}:i,c=e.closeable;return(0,a.jsxs)("div",{className:"".concat(X().chip," ").concat(void 0===r?"":r),children:[n,(void 0===c||c)&&(0,a.jsx)("span",{className:X().closebtn,onClick:function(e){l(e,s)},children:"\xd7"})]})}var $=t(7460),Y=t.n($),ee=t(828),en=t(4788),et=t.n(en),es={data:[],sourceData:[],sourceColumns:[],raIndex:-1,decIndex:-1,schema:{sourceTable:[],sdssCatalog:[],classification:!1,legacyImaging:{enabled:!1,pixelScale:.55},splusImaging:!1,customImaging:{enabled:!1,nCols:0},sdssSpectra:!1,splusPhotoSpectra:!1,nearbyRedshifts:!1}},ea=function(e,n){var t,s,a,r,i,l,c=(0,u.Z)({},e);return c.sourceData=null!==(t=n.payload.sourceData)&&void 0!==t?t:c.sourceData,c.sourceColumns=null!==(s=n.payload.sourceColumns)&&void 0!==s?s:c.sourceColumns,c.raIndex=null!==(a=n.payload.raIndex)&&void 0!==a?a:c.raIndex,c.decIndex=null!==(r=n.payload.decIndex)&&void 0!==r?r:c.decIndex,c.data=null!==(i=n.payload.initialData)&&void 0!==i?i:Array(n.payload.sourceData.length-1),c.schema=null!==(l=n.payload.schema)&&void 0!==l?l:c.schema,c},er=function(e,n){var t=(0,u.Z)({},e),s=et()(n.payload.columns,n.payload.keys),a=!0,r=!1,i=void 0;try{for(var l,c=n.payload.data[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var o=l.value,d=!0,h=!1,m=void 0;try{for(var p,x=s[Symbol.iterator]();!(d=(p=x.next()).done);d=!0){var f=(0,ee.Z)(p.value,2),g=f[0],j=f[1];t.data[o.index][j]=o[g]}}catch(y){h=!0,m=y}finally{try{d||null==x.return||x.return()}finally{if(h)throw m}}}}catch(v){r=!0,i=v}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return t},ei=function(e,n){var t=(0,u.Z)({},e);return e.data[n.payload.rowId].classification=n.payload.class,t},el=function(e,n){switch(n.type){case"setBatchData":return er(e,n);case"initTable":return ea(e,n);case"setClass":return ei(e,n);default:return e}},ec=(0,l.createContext)({tdState:es,tdDispatch:function(){}}),eo=function(e){var n=e.children,t=(0,l.useReducer)(el,es),s=t[0],r=t[1];return(0,a.jsx)(ec.Provider,{value:{tdState:s,tdDispatch:r},children:n})},eu=function(){return(0,l.useContext)(ec)},ed=t(9583),eh=t(6212),em=function(e,n,t){var s=e.trim();s&&!n.includes(s)&&(n.push(s),t({type:"setClassification",payload:{classNames:n}}))},ep=function(e,n,t){t({type:"setClassification",payload:{classNames:n.filter(function(n){return n!=e})}})};function ex(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.classification,r=(0,l.useState)(""),i=r[0],c=r[1],o=(0,l.useState)(!1),u=o[0],d=o[1];return(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"classNames",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:1,children:"Classes"}),(0,a.jsxs)(z.Z,{sm:8,children:[(0,a.jsx)(H.Z,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),em(i,s.classNames,t),c("")},children:(0,a.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(H.Z.Control,{placeholder:"Class name",value:i,onChange:function(e){return c(e.target.value)}}),(0,a.jsx)(A.Z,{variant:"success",type:"submit",children:"Add"})]}),(0,a.jsxs)(W,{title:"Class Name",className:"ms-1",children:["Type the class name and press ",(0,a.jsx)("kbd",{children:"ENTER"})," or click Add button"]}),(0,a.jsxs)(A.Z,{style:{whiteSpace:"nowrap"},className:"ms-4",variant:"outline-primary",disabled:0==n.classification.classNames.length,onClick:function(){return d(!0)},children:[(0,a.jsx)(ed.P2_,{size:20,className:"me-1"})," Hotkeys"]}),(0,a.jsx)(W,{title:"Hotkeys",className:"ms-1",children:"Classify your table quickly by configuring keyboard keys to select classes"}),(0,a.jsx)(ef,{show:u,onHide:function(){return d(!1)}})]})}),s.classNames.map(function(e){return(0,a.jsxs)(J,{className:"mb-1 me-1",onClose:function(){return ep(e,s.classNames,t)},children:[e,e in n.classification.keyMap&&(0,a.jsxs)("span",{children:[" (",(0,a.jsx)("b",{children:n.classification.keyMap[e].toUpperCase()}),")"]})]},"cname_".concat(e))})]})]})}function ef(e){var n=e.show,t=e.onHide,s=P(),r=s.tcState,i=s.tcDispatch,c=r.classification,o=(0,l.useState)(-1),h=o[0],m=o[1],p=(0,l.useCallback)(function(e){e.stopPropagation(),/^[\w\d]$/i.test(e.key)&&-1!=h&&i({type:"setClassification",payload:{keyMap:(0,d.Z)((0,u.Z)({},r.classification.keyMap),(0,U.Z)({},h,e.key))}})},[i,r,h]);return(0,l.useEffect)(function(){return n?document.addEventListener("keydown",p,!0):document.removeEventListener("keydown",p,!0),function(){document.removeEventListener("keydown",p,!0)}},[p,n]),(0,a.jsxs)(eh.Z,{show:n,onHide:t,animation:!1,centered:!0,children:[(0,a.jsx)(eh.Z.Header,{closeButton:!0,children:(0,a.jsx)(eh.Z.Title,{id:"contained-modal-title-vcenter",children:"Hotkeys configuration"})}),(0,a.jsxs)(eh.Z.Body,{children:[(0,a.jsx)("p",{className:"mb-3",children:"Select a class below and press an alphanumeric (A-Z, 0-9) character on the keyboard. After associating the keyboard shortcuts for the desired classes, just click on the table row and press the key referring to the class."}),(0,a.jsxs)(H.Z,{onSubmit:function(e){return e.preventDefault()},children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-3",controlId:"hotkeyClass",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:2,children:"Class"}),(0,a.jsx)(z.Z,{sm:10,children:(0,a.jsxs)(H.Z.Select,{value:h,onChange:function(e){return m(e.target.value)},children:[(0,a.jsx)("option",{value:-1,children:"Select a class"}),c.classNames.map(function(e){return(0,a.jsx)("option",{value:e,children:e},e)})]})})]}),(0,a.jsxs)(E.Z,{className:"d-inline-flex align-items-center",children:[(0,a.jsx)(z.Z,{sm:2,children:"Hotkey"}),(0,a.jsx)(z.Z,{sm:3,children:(0,a.jsx)(H.Z.Control,{readOnly:!0,type:"text",size:"lg",value:c.keyMap[h]?c.keyMap[h].toUpperCase():"",style:{fontWeight:800,textAlign:"center"}})}),(0,a.jsx)(z.Z,{children:(0,a.jsx)(A.Z,{className:"ps-0",variant:"link",onClick:function(){var e=r.classification.keyMap;h in e&&(delete e[h],i({type:"setClassification",payload:{keyMap:e}}))},children:"Clear"})})]})]})]})]})}function eg(){var e=P(),n=e.tcState,t=e.tcDispatch,s=eu().tdState,r=n.classification,i=function(e){e.preventDefault();var n=s.data,t=e.target.classDownload.value;if(t&&(null==t?void 0:t.trim())&&(null==n?void 0:n.length)){t=t.endsWith(".csv")?t:t+".csv";var a=Object.keys(n[0]).map(function(e){return"classification"==e?{from:e,to:"XTableClass"}:e.startsWith("sourceTable:")?{from:e,to:e.split(":")[1]}:e.startsWith("sdss:")?{from:e,to:e.split(".")[1]}:null}).filter(function(e){return null!=e}),i=(r.enabled&&r.filterUnclassified?n.filter(function(e){return!!e.classification}):n).map(function(e){var n={},t=!0,s=!1,r=void 0;try{for(var i,l=a[Symbol.iterator]();!(t=(i=l.next()).done);t=!0){var c=i.value;n[c.to]=e[c.from]}}catch(o){s=!0,r=o}finally{try{t||null==l.return||l.return()}finally{if(s)throw r}}return n}),l=Y().unparse(i,{header:!0}),c=document.createElement("a");c.setAttribute("href",encodeURI("data:text/csv;charset=utf-8,"+l)),c.setAttribute("download",t),document.body.appendChild(c),c.click(),c.remove()}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"classCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show Classification Column",checked:r.enabled,onChange:function(e){return t({type:"setClassification",payload:{enabled:e.target.checked}})}}),(0,a.jsx)(W,{title:"Enable Classifications",className:"ms-1",children:"Select this option if you want to classify the table, unsect to hide the classification column"})]})})]}),(0,a.jsx)(ex,{}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)(H.Z,{className:"mt-3",onSubmit:i,children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"classDownload",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Save"}),(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(H.Z.Control,{placeholder:"File name"}),(0,a.jsxs)(A.Z,{variant:"primary",type:"submit",children:[(0,a.jsx)(V.xOH,{size:18,className:"me-1"})," ","Download classifications"]})]}),(0,a.jsx)(W,{title:"Save Classifications",className:"ms-1",children:"Choose a name and save your classifications in local computer"})]})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"classFilter",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1"}),(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(H.Z.Check,{type:"switch",label:"Filter unclassified rows",checked:n.classification.filterUnclassified,onChange:function(e){return t({type:"setClassification",payload:{filterUnclassified:e.target.checked}})}}),(0,a.jsx)(W,{title:"Filter unclassified",className:"ms-1",children:"Download file without the unclassified rows"})]})})]})]})]})}var ej=["iso","aper3","aper6","auto","petro","pstotal"];function ey(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.sdssSpectra,r=n.splusPhotoSpectra.selectedLines,i=function(e,n){n.includes(e)?t({type:"setSplusPhotoSpectra",payload:{selectedLines:n.filter(function(n){return n!=e})}}):t({type:"setSplusPhotoSpectra",payload:{selectedLines:(0,h.Z)(n).concat([e])}})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"sloanSpecCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:3,children:"SDSS Spectra"}),(0,a.jsx)(z.Z,{sm:9,className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show SDSS Spectra Column",checked:s.enabled,onChange:function(e){return t({type:"setSdssImaging",payload:{enabled:e.target.checked}})}})})]}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"nearby-redshift-check",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:3,children:"Nearby Redshift"}),(0,a.jsx)(z.Z,{sm:9,className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show SDSS Redshifts of Nearby Objects",checked:n.nearbyRedshifts.enabled,onChange:function(e){return t({type:"setNearbyRedshifts",payload:{enabled:e.target.checked}})}})})]}),(0,a.jsx)("hr",{className:"my-4"}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:3,children:"S-PLUS PhotoSpectra"}),(0,a.jsx)(z.Z,{sm:9,className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show S-PLUS PhotoSpectra Column",checked:n.splusPhotoSpectra.enabled,onChange:function(){return t({type:"setSplusPhotoSpectra",payload:{enabled:!n.splusPhotoSpectra.enabled}})}})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:3,children:"Selected Lines"}),(0,a.jsx)(z.Z,{sm:9,className:"d-flex align-items-center",children:ej.map(function(e){return(0,a.jsxs)(H.Z.Check,{inline:!0,type:"checkbox",id:"splus-photospectra-line-".concat(e),className:"me-3",children:[(0,a.jsx)(H.Z.Check.Input,{type:"checkbox",checked:r.includes(e),onChange:function(){return i(e,r)}}),(0,a.jsx)(H.Z.Check.Label,{children:e})]},e)})})]})]})}function ev(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.legacyImaging;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"legacyImagingCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show Legacy RGB Images Column",checked:s.enabled,onChange:function(e){return t({type:"setLegacyImaging",payload:{enabled:e.target.checked}})}})})]}),(0,a.jsx)(E.Z,{children:(0,a.jsx)(z.Z,{sm:5,children:(0,a.jsxs)(M.Z,{className:"mb-3",children:[(0,a.jsx)(M.Z.Text,{id:"legacyImagingPixScale",children:"Pixel Scale"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"legacyImagingPixScale",value:s.pixelScale,onChange:function(e){return t({type:"setLegacyImaging",payload:{pixelScale:e.target.value}})}})]})})}),(0,a.jsx)(E.Z,{children:(0,a.jsx)(z.Z,{sm:5,children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{children:"DR"}),(0,a.jsxs)(H.Z.Select,{value:s.dataRelease,onChange:function(e){return t({type:"setLegacyImaging",payload:{dataRelease:e.target.value}})},children:[(0,a.jsx)("option",{value:"10",children:"10"}),(0,a.jsx)("option",{value:"9",children:"9"})]})]})})})]})}var eb=t(768),eZ=t.n(eb);function eS(e){var n=e.children,t=e.className,s=e.onClick;return(0,a.jsx)("div",{className:"".concat(eZ().chip," ").concat(void 0===t?"btn-light":t),onClick:void 0===s?function(){}:s,children:n})}var eC=["U","F378","F395","F410","F430","G","F515","R","F660","I","F861","Z"];function eI(e){var n=e.band,t=e.channel,s=e.variant,r=P(),i=r.tcState,l=r.tcDispatch,c=i.splusImaging.trilogyConfig,o=c.R,d=c.G,h=c.B,m=c[t].includes(n)?"btn-".concat(s):"btn-outline-".concat(s);return(0,a.jsx)(eS,{className:"".concat(m," me-1"),onClick:function(){return l({type:"setSplusTrilogyConfig",payload:function(e,n,t){var s=(0,u.Z)({},e);for(var a in e)if(a!=n&&(s[a]=e[a].filter(function(e){return e!=t})),s[a].length<1)return e;return s[n].includes(t)?s[n]=s[n].filter(function(e){return e!=t}):s[n].push(t),s}({R:o,G:d,B:h},t,n)})},children:n})}function eN(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.splusImaging.trilogyConfig;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusTrilogyR",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"R"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[eC.map(function(e){return(0,a.jsx)(eI,{band:e,channel:"R",variant:"danger"},"R_".concat(e))}),(0,a.jsxs)(W,{title:"Red Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,a.jsx)("span",{className:"text-danger",children:"red"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusTrilogyG",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"G"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[eC.map(function(e){return(0,a.jsx)(eI,{band:e,channel:"G",variant:"success"},"G_".concat(e))}),(0,a.jsxs)(W,{title:"Green Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,a.jsx)("span",{className:"text-success",children:"green"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusTrilogyB",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"B"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[eC.map(function(e){return(0,a.jsx)(eI,{band:e,channel:"B",variant:"primary"},"B_".concat(e))}),(0,a.jsxs)(W,{title:"Blue Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,a.jsx)("span",{className:"text-primary",children:"blue"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusTrilogyParams",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,a.jsx)(z.Z,{sm:9,children:(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{className:"mb-3",children:[(0,a.jsx)(M.Z.Text,{id:"trilogy-param-noise",children:"Noise"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Noise","aria-describedby":"trilogy-param-noise",value:s.noise,onChange:function(e){return t({type:"setSplusTrilogyConfig",payload:{noise:e.target.value}})}})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{className:"mb-3",children:[(0,a.jsx)(M.Z.Text,{id:"trilogy-param-q",children:"Q"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Q","aria-describedby":"trilogy-param-q",value:s.Q,onChange:function(e){return t({type:"setSplusTrilogyConfig",payload:{Q:e.target.value}})}})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{className:"mb-3",children:[(0,a.jsx)(M.Z.Text,{id:"pixelScale",children:"Pixel Scale"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"pixelScale",value:n.splusImaging.pixelScale,onChange:function(e){return t({type:"setSplusImaging",payload:{pixelScale:e.target.value}})}})]})})]})})]})]})}function ew(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.splusImaging.luptonConfig;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusLuptonColors",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Colors"}),(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{children:"R"}),(0,a.jsx)(H.Z.Select,{value:s.R,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{R:e.target.value}})},children:eC.map(function(e){return(0,a.jsx)("option",{children:e},e)})})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{children:"G"}),(0,a.jsx)(H.Z.Select,{value:s.G,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{G:e.target.value}})},children:eC.map(function(e){return(0,a.jsx)("option",{children:e},e)})})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{children:"B"}),(0,a.jsx)(H.Z.Select,{value:s.B,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{B:e.target.value}})},children:eC.map(function(e){return(0,a.jsx)("option",{children:e},e)})})]})})]})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusLuptonParams",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{id:"lupton-param-noise",children:"Stretch"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Stretch","aria-describedby":"lupton-param-noise",value:s.stretch,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{stretch:e.target.value}})}})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{children:[(0,a.jsx)(M.Z.Text,{id:"lupton-param-q",children:"Q"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Q","aria-describedby":"lupton-param-q",value:s.Q,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{Q:e.target.value}})}})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsxs)(M.Z,{className:"mb-3",children:[(0,a.jsx)(M.Z.Text,{id:"pixelScale",children:"Pixel Scale"}),(0,a.jsx)(H.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"pixelScale",value:n.splusImaging.pixelScale,onChange:function(e){return t({type:"setSplusImaging",payload:{pixelScale:e.target.value}})}})]})})]})})]})]})}function ek(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.splusImaging;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"splusImagingCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show S-PLUS RGB Images Column",checked:s.enabled,onChange:function(e){return t({type:"setSplusImaging",payload:{enabled:e.target.checked}})}})})]}),(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"classCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Type"}),(0,a.jsx)(z.Z,{sm:5,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsxs)(H.Z.Select,{defaultValue:s.type,onChange:function(e){return t({type:"setSplusImaging",payload:{type:e.target.value}})},children:[(0,a.jsx)("option",{value:"trilogy",children:"Trilogy"}),(0,a.jsx)("option",{value:"lupton",children:"Lupton"})]}),(0,a.jsxs)(W,{title:"Image Type",className:"ms-1",children:["The algorithm used to make RGB stamps from the FITS file",(0,a.jsx)("br",{}),(0,a.jsx)("b",{children:"Trilogy: "})," The Trilogy algorithm",(0,a.jsx)("br",{}),(0,a.jsx)("b",{children:"Lupton: "})," The Lupton method"]})]})})]}),"trilogy"==s.type?(0,a.jsx)(eN,{}):(0,a.jsx)(ew,{})]})}var eR,eT=t(3854),eF=t(1438),eL=function(e,n){var t="^".concat(e,"[_d]*?$"),s=RegExp(t,"gi");return n.findIndex(function(e,n){return null!==s.exec(e)})},eD=new(function(){function e(){(0,eF.Z)(this,e)}var n=e.prototype;return n.load=function(e,n){e&&Y().parse(e,{complete:n,skipEmptyLines:!0})},n.getHeaderSummary=function(e){var n=eL("ra",e),t=eL("dec",e);return{raIndex:n,decIndex:t,columns:e,positionFound:n>-1&&t>-1}},n.getTableSummary=function(e){var n=this;return new Promise(function(t,s){var a=function(e){if(e.errors.length>0)return s(e.errors);var a=e.data[0];t(n.getHeaderSummary(a))};Y().parse(e,{complete:a,preview:1})})},n.getRa=function(e,n){return null!=n.raIndex&&e<n.data.length?n.sourceData[e+1][n.raIndex]:null},n.getDec=function(e,n){return null!=n.decIndex&&e<n.data.length?n.sourceData[e+1][n.decIndex]:null},n.getCellValue=function(e,n,t){var s,a;return null===(s=t.data)||void 0===s?void 0:null===(a=s[e])||void 0===a?void 0:a[n]},e}());function eP(e){var n=e.onChange;return(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"tableFile",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Table"}),(0,a.jsx)(z.Z,{sm:6,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(H.Z.Control,{type:"file",onChange:n}),(0,a.jsxs)(W,{title:"Local Upload",className:"ms-1",children:["Loads a CSV table available in local computer. The only required columns are ",(0,a.jsx)("code",{children:"RA"})," and ",(0,a.jsx)("code",{children:"DEC"})," in degrees."]})]})})]})}function e_(){return(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"tableFile",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"URL"}),(0,a.jsx)(z.Z,{sm:"5",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(H.Z.Control,{placeholder:"File URL"}),(0,a.jsx)(W,{title:"Remote Upload",className:"ms-1",children:"Loads a table available remotely over the internet"})]})}),(0,a.jsx)(z.Z,{sm:"2",className:"d-flex align-items-center",children:(0,a.jsx)(A.Z,{variant:"link",className:"px-1 py-1",children:"Load Example"})})]})}(eR=s||(s={})).unloaded="unloaded",eR.loading="loading",eR.success="sucess",eR.positionNotFound="positionNotFound",eR.error="error";var ez=function(e){var n=e.state;return n==s.loading?(0,a.jsx)("p",{className:"text-secondary",children:"Loading table..."}):n==s.success?(0,a.jsxs)("p",{className:"text-success",children:[(0,a.jsx)(eT.dZ6,{})," RA and DEC columns successfully detected"]}):n==s.positionNotFound?(0,a.jsxs)("p",{className:"text-danger",children:[(0,a.jsx)(eT.apv,{})," RA or DEC columns not detected"]}):n==s.error?(0,a.jsxs)("p",{className:"text-danger",children:[(0,a.jsx)(eT.apv,{})," Failed to load this table, check if it's a valid csv file"]}):null},eE=function(e){var n=e.show,t=e.onHide,s=P(),r=s.tcState,i=s.tcDispatch,c=(0,l.useState)(-1),o=c[0],u=c[1],d=function(){o>=0&&!r.table.selectedColumnsId.includes(o)&&i({type:"setFileInput",payload:{selectedColumnsId:(0,h.Z)(r.table.selectedColumnsId).concat([o])}})};return(0,a.jsxs)(eh.Z,{show:n,onHide:t,animation:!1,centered:!0,children:[(0,a.jsx)(eh.Z.Header,{closeButton:!0,children:(0,a.jsx)(eh.Z.Title,{id:"contained-modal-title-vcenter",children:"Select a column"})}),(0,a.jsx)(eh.Z.Body,{children:(0,a.jsx)(H.Z,{children:(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{xs:10,children:(0,a.jsxs)(H.Z.Select,{defaultValue:-1,onChange:function(e){return u(parseInt(e.target.value))},children:[(0,a.jsx)("option",{value:-1,children:"Select a column to add"}),r.table.columns.map(function(e,n){return{colName:e,originalIndex:n}}).filter(function(e){return!r.table.selectedColumnsId.includes(e.originalIndex)}).map(function(e){return(0,a.jsx)("option",{value:e.originalIndex,children:e.colName},e.originalIndex)})]})}),(0,a.jsx)(z.Z,{children:(0,a.jsx)(A.Z,{variant:"success",onClick:d,children:"Add"})})]})})})]})};function eB(){var e=P(),n=e.tcState,t=e.tcDispatch,r=n.table,i=(0,l.useState)(s.unloaded),c=i[0],o=i[1],u=(0,l.useState)(!1),d=u[0],h=u[1],m=function(e){if(e.target.files.length>0){var n=e.target.files[0];o(s.loading),eD.getTableSummary(n).then(function(e){(null==e?void 0:e.positionFound)?(o(s.success),t({type:"setFileInput",payload:{type:"local",columns:e.columns,selectedColumnsId:[e.raIndex,e.decIndex],raIndex:e.raIndex,decIndex:e.decIndex,file:n}})):o(s.positionNotFound)}).catch(function(e){o(s.error)})}},p=function(e,s){t({type:"setFileInput",payload:{selectedColumnsId:n.table.selectedColumnsId.filter(function(e){return e!=s})}})};return(0,a.jsxs)(a.Fragment,{children:["local"==r.type?(0,a.jsx)(eP,{onChange:m}):(0,a.jsx)(e_,{}),(0,a.jsx)(ez,{state:c}),r.selectedColumnsId.length>0&&(0,a.jsxs)("div",{children:["Selected Columns: ",r.selectedColumnsId.map(function(e){return(0,a.jsx)(J,{value:e,className:"mb-1 me-1",onClose:p,closeable:e!=r.raIndex&&e!=r.decIndex,children:r.columns[e]},"sourceColIdx_".concat(e))}),(0,a.jsx)(A.Z,{variant:"link",className:"py-0",onClick:function(){return h(!0)},children:"Add more"})]}),(0,a.jsx)(eE,{show:d,onHide:function(){return h(!1)}})]})}var eG=t(6729),eU=new(t.n(eG)()),eH={on:function(e,n){return eU.on(e,n)},once:function(e,n){return eU.once(e,n)},off:function(e,n){return eU.off(e,n)},emit:function(e,n){return eU.emit(e,n)},count:function(e){return eU.listenerCount(e)}};Object.freeze(eH);var eM=t(6968),eA=t(7568),eO=t(2222),eq=t(655),eQ=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,eF.Z)(this,e),this.currentRequests=[],this.runningRequests=0,this.maxConcurrentRequests=n}var n=e.prototype;return n.callFunction=function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),s=1;s<n;s++)t[s-1]=arguments[s];var a=this;return new Promise(function(n,s){a.currentRequests.push({resolve:n,reject:s,fnToCall:e,args:t}),eH.on("cancel",function(){console.log("cancelling"),s("cancelled")}),a.tryNext()})},n.tryNext=function(){var e=this;if(this.runningRequests<this.maxConcurrentRequests){var n=this.currentRequests.shift();if(n){this.runningRequests++;var t=n.args;n.fnToCall.apply(null,t).then(function(e){return n.resolve(e)}).catch(function(e){return n.reject(e)}).finally(function(){e.runningRequests--,e.tryNext()})}}},e}(),eW=new(function(){function e(){(0,eF.Z)(this,e),this.pool={},this.controller=new AbortController}var n=e.prototype;return n.create=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e in this.pool||(this.pool[e]=new eQ(n))},n.enqueue=function(e,n){for(var t,s=arguments.length,a=Array(s>2?s-2:0),r=2;r<s;r++)a[r-2]=arguments[r];return(t=this.pool[e]).callFunction.apply(t,[n].concat((0,h.Z)(a)))},n.getSignal=function(){return this.controller.signal},n.clear=function(){for(var e in eH.emit("cancel",null),this.pool);},e}()),eV=t(9669),eK=t.n(eV),eX=t(2461),eJ=t(4400),e$=t.n(eJ),eY=t(8400),e0=t.n(eY),e1=t(8709);eW.create("sdss_cone_spec",1),eW.create("sdss_sql",2),eW.create("sdss_batch_query",2);var e2=(0,eX.V5)(10,"day","ms"),e3=new e1.S({defaultOptions:{queries:{staleTime:e2}}}),e6=function(){function e(n){(0,eF.Z)(this,e);var t=n||{},s=t.objType,a=t.raColumn,r=t.decColumn,i=t.pkColumn;this.raColumn=void 0===a?"ra":a,this.decColumn=void 0===r?"dec":r,this.pkColumn=void 0===i?null:i,this.objType=void 0===s?"photo":s}var n=e.prototype;return n.getQuery=function(e,n,t,s){return"SELECT p.fiber2Mag_z ".concat(s.map(function(e){return"t.".concat(e)}).join(","),"\n    FROM PhotoObj p, dbo.fGetNearbyObjEq(326.8952189, 0.7732093, 0.02) n\n    WHERE p.objID = n.objID")},n.getCrossIdQuery=function(e,n){var t="photo"==this.objType?"objID":"specObjID";return"\n    SELECT \n      ".concat(n.map(function(e){return"t.".concat(e)}).join(","),"\n    FROM #upload u\n      JOIN #x x ON x.up_id = u.up_id\n      JOIN ").concat(e," t ON t.").concat(this.pkColumn||t," = x.").concat(t,"\n    ORDER by x.up_id\n    ").trim()},e}(),e5={PhotoTag:{searchStrategy:new e6,type:"view"},SpecObjAll:{searchStrategy:new e6({objType:"spectro"}),type:"table"},emissionLinesPort:{searchStrategy:new e6({objType:"spectro"}),type:"table"},TwoMass:{searchStrategy:new e6,type:"table"},zooSpec:{searchStrategy:new e6,type:"table"},zooNoSpec:{searchStrategy:new e6,type:"table"},zoo2MainSpecZ:{searchStrategy:new e6({pkColumn:"dr8objid"}),type:"table"}},e4=function(){function e(){(0,eF.Z)(this,e)}var n=e.prototype;return n.getObjSpecId=function(e,n){return eW.enqueue("sdss_cone_spec",(0,eA.Z)(function(){var t,s,a,r,i;return(0,eq.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e3.fetchQuery(["sdss-service-specid",e,n],function(){return eK().get("https://skyserver.sdss.org/dr16/SkyServerWS/SpectroQuery/ConeSpectro",{params:{ra:e,dec:n,radius:.01667,limit:1,format:"xml",specparams:"specObjID",imgparams:"none",zWarning:"on"},signal:eW.getSignal()})})];case 1:return t=s.sent(),[2,null==(r=new DOMParser().parseFromString(t.data,"application/xml").querySelector('Table[name="Table1"] > Row > Item[name="specObjID"]'))?void 0:r.textContent];case 2:return i=s.sent(),console.log(void 0===i?"undefined":(0,eO.Z)(i)),console.log(i),[3,3];case 3:return[2]}})}))},n.getSpecPlotUrl=function(e,n){var t=this;return(0,eA.Z)(function(){var s;return(0,eq.__generator)(this,function(a){switch(a.label){case 0:return[4,t.getObjSpecId(e,n)];case 1:return s=a.sent(),[2,"https://skyserver.sdss.org/dr16/en/get/SpecById.ashx?id=".concat(s)]}})})()},n.getSpecPlotUrlById=function(e){return"https://skyserver.sdss.org/dr16/en/get/SpecById.ashx?id=".concat(e)},n.getTables=function(){return Object.keys(e5)},n.getColumns=function(e){return(0,eA.Z)(function(){var n,t,s,a,r;return(0,eq.__generator)(this,function(r){switch(r.label){case 0:return s="table"==e5[e].type?"SELECT name, description, unit \n      FROM DBColumns \n      WHERE tablename='".concat(e,"'"):"\n      SELECT tc.name name, tc.description description, tc.unit unit\n      FROM DBColumns tc\n      INNER JOIN DBViewCols vc ON vc.parent = tc.tablename AND vc.name = tc.name\n      WHERE vc.viewname='".concat(e,"' \n      ").trim(),console.log(s),a="".concat("https://skyserver.sdss.org/dr16/SkyServerWS/SearchTools/SqlSearch","?cmd=").concat(encodeURIComponent(s),"&format=json"),[4,e3.fetchQuery(["sdss-service-columns",e],function(){return eK().get(a)})];case 1:return[2,null===(n=r.sent().data)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.Rows]}})})()},n.batchQuery=function(e,n,t,s,a,r){var i=this;return(0,eA.Z)(function(){return(0,eq.__generator)(this,function(l){return[2,eW.enqueue("sdss_batch_query",(0,eA.Z)(function(){var l,c,o,m,p;return(0,eq.__generator)(this,function(m){switch(m.label){case 0:return c=(l=e5[n].searchStrategy).getCrossIdQuery(n,t),[4,e3.fetchQuery(["sdss-service-batchQuery",n].concat((0,h.Z)(t),[s,a,r]),function(){return eK().get("https://skyserver.sdss.org/dr16/SkyServerWS/SearchTools/CrossIdSearch",{params:{searchtool:"CrossID",searchType:l.objType,photoScope:"nearPrim",spectroScope:"nearPrim",photoUpType:"ra-dec",spectroUpType:"ra-dec",radius:.016667,firstcol:1,paste:i.getCsv(e),uquery:c,format:"JSON"},transformResponse:[function(e){return e}]})})];case 1:return o=m.sent(),[2,(0,e$()({storeAsString:!0}).parse(o.data).find(function(e){return"Table1"==e.TableName}).Rows).map(function(e){return(0,d.Z)((0,u.Z)({},e),{index:parseInt(e.index)})})]}})}))]})})()},n.chunckedQuery=function(e,n,t,s,a){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=this,l=e0()(e,25),c=t.reduce(function(e,n){return e[n]=null,e},{});l.map(function(e,a){return i.batchQuery(e,n,t,a,s.name,s.lastModified)}).forEach(function(e,n){e.then(function(e){var t=e.map(function(e){return e.index}),s=l[n].map(function(e){return e.index}).filter(function(e){return!t.includes(e)}).map(function(e){return(0,u.Z)({index:e},c)}),i=(0,h.Z)(e).concat((0,h.Z)(s));if(r){var o=!0,d=!1,m=void 0;try{for(var p,x=i[Symbol.iterator]();!(o=(p=x.next()).done);o=!0){var f=p.value;a(f)}}catch(g){d=!0,m=g}finally{try{o||null==x.return||x.return()}finally{if(d)throw m}}}else a(i)})})},n.getCsv=function(e){return"index,ra,dec\r\n"+(e.map(function(e){return"".concat(e.index,",").concat(e.ra,",").concat(e.dec)}).join("\r\n")||"")},e}(),e8=t(4331),e9=function(e){var n=e.items,t=e.active,s=e.onClick,r=e.height,i=e.className;return(0,a.jsx)(G.Z,{className:"".concat(i," overflow-auto"),style:{height:r},children:n.map(function(e,n){return(0,a.jsx)(G.Z.Item,{action:!0,active:t==e,onClick:function(t){return s({title:e,index:n,event:t})},children:e},n)})})},e7=function(e){var n=e.items,t=e.active,s=e.onClick,r=e.height,i=e.className;return(0,a.jsx)(G.Z,{className:"".concat(i," overflow-auto"),style:{height:r},children:n.map(function(e,n){return(0,a.jsx)(G.Z.Item,{action:!0,variant:t&&t.includes(e)?"primary":"",onClick:function(t){return s({title:e,index:n,event:t})},children:e},n)})})},ne=function(e){var n=e.className,t=e.height;return(0,a.jsxs)(G.Z,{className:"".concat(n," overflow-auto"),style:{height:t},children:[(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:6})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:9})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:4})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:5})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:11})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:7})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:8})}),(0,a.jsx)(e8.Z,{as:G.Z.Item,animation:"glow",children:(0,a.jsx)(e8.Z,{xs:5})})]})};function nn(e){var n=e.items,t=void 0===n?[]:n,s=e.active,r=void 0===s?[]:s,i=e.multiple,l=e.placeholder,c=e.onClick,o=void 0===c?function(){}:c,u=e.height,d=void 0===u?260:u,h=e.className,m=void 0===h?"":h;return(0,a.jsx)(a.Fragment,{children:void 0!==l&&l?(0,a.jsx)(ne,{className:m,height:d}):void 0!==i&&i?(0,a.jsx)(e7,{items:t,active:r,onClick:o,height:d,className:m}):(0,a.jsx)(e9,{items:t,active:r,onClick:o,height:d,className:m})})}var nt=t(4908),ns=t.n(nt),na=new e4,nr=na.getTables(),ni=function(e){var n=e.show,t=e.onHide,s=P(),r=s.tcState,i=s.tcDispatch,c=(0,l.useState)(nr[0]),o=c[0],u=c[1],d=(0,l.useState)(""),m=d[0],p=d[1],x=(0,l.useState)([]),f=x[0],g=x[1],j=(0,l.useState)(!0),y=j[0],v=j[1],b=r.sdssCatalog.selectedColumns;(0,l.useEffect)(function(){na.getColumns(o).then(function(e){v(!1),g(e)}).catch(function(){})},[o]);var Z=(0,l.useMemo)(function(){return null==f?void 0:f.map(function(e){return e.name})},[f])||[],S=(0,l.useMemo)(function(){return null==f?void 0:f.find(function(e){return e.name==m})},[f,m]),C=(0,l.useMemo)(function(){return b.findIndex(function(e){return e.column==m&&e.table==o})>-1},[b,m,o]),I=function(e,n){var t=b.findIndex(function(t){return t.column==n&&t.table==e});i({type:"setSdssCatalog",payload:{selectedColumns:b.filter(function(e,n){return n!=t})}})},N=function(e,n){i({type:"setSdssCatalog",payload:{selectedColumns:(0,h.Z)(b).concat([{table:e,column:n}])}})};return(0,a.jsxs)(eh.Z,{show:n,onHide:t,animation:!1,size:"lg",centered:!0,children:[(0,a.jsx)(eh.Z.Header,{className:"py-2",closeButton:!0,children:(0,a.jsx)(eh.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Add SDSS columns"})}),(0,a.jsx)(eh.Z.Body,{children:(0,a.jsxs)(E.Z,{children:[(0,a.jsxs)(z.Z,{sm:5,children:[(0,a.jsxs)(E.Z,{className:"align-items-center",children:[(0,a.jsx)(z.Z,{lg:2,children:"Table:"}),(0,a.jsx)(z.Z,{children:(0,a.jsx)(H.Z.Select,{defaultValue:o,onChange:function(e){v(!0),p(""),u(e.target.value)},children:nr.map(function(e){return(0,a.jsx)("option",{value:e,children:e},e)})})})]}),(0,a.jsx)(nn,{placeholder:y,items:Z,active:m,className:"mt-2",height:340,onClick:function(e){return p(e.title)}})]}),y?(0,a.jsxs)(z.Z,{children:[(0,a.jsx)(eM.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,a.jsxs)("span",{className:"text-muted",children:["Loading columns of the ",(0,a.jsx)("u",{children:o})," table"]})]}):(0,a.jsxs)(z.Z,{children:[b.filter(function(e){return e.table==o}).length>0&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("span",{className:"text-muted fw-bold",children:"Selected columns:\xa0"}),b.filter(function(e){return e.table==o}).map(function(e){return(0,a.jsx)(J,{closeable:!0,className:"mb-1 me-1",onClose:function(){return I(o,e.column)},children:e.column},e.column)})]}),S&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("b",{children:[S.name,":"]}),"\xa0",S.description,".\xa0",S.unit&&(0,a.jsxs)(a.Fragment,{children:["Unit: ",(0,a.jsx)("i",{dangerouslySetInnerHTML:{__html:S.unit}})]})]}),(0,a.jsx)("div",{children:C?(0,a.jsxs)(A.Z,{variant:"outline-danger",size:"sm",onClick:function(){return I(o,m)},children:[(0,a.jsx)(eT.HeX,{})," Remove Selected Column"]}):(0,a.jsxs)(A.Z,{variant:"outline-success",size:"sm",onClick:function(){return N(o,m)},children:[(0,a.jsx)(Q.poH,{size:16})," Add Selected Column"]})})]})]})]})})]})};function nl(){var e=P(),n=e.tcState,t=e.tcDispatch,s=(0,l.useState)(!1),r=s[0],i=s[1],c=n.sdssCatalog.selectedColumns,o=(0,l.useMemo)(function(){return ns()(c.map(function(e){return e.table}))},[c]),u=function(e,n){var s=c.findIndex(function(t){return t.column==n&&t.table==e});t({type:"setSdssCatalog",payload:{selectedColumns:c.filter(function(e,n){return n!=s})}})};return(0,a.jsxs)(a.Fragment,{children:[c.length>0&&(0,a.jsx)(a.Fragment,{children:o.map(function(e){return(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("span",{className:"me-2 fw-bold",children:[e,":"]}),c.filter(function(n){return n.table==e}).map(function(e){return(0,a.jsx)(J,{className:"mb-1 me-1",onClose:function(){return u(e.table,e.column)},children:e.column},e.column)})]},e)})}),(0,a.jsxs)(A.Z,{size:"sm",onClick:function(){return i(!0)},children:[(0,a.jsx)(Q.poH,{size:16})," Add SDSS Columns"]}),(0,a.jsx)(ni,{show:r,onHide:function(){return i(!1)}})]})}var nc=function(e){var n=e.index,t=P(),s=t.tcState,r=t.tcDispatch,i=s.customImaging.columns[n];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsxs)(M.Z,{className:"mb-2",size:"sm",children:[(0,a.jsx)(M.Z.Text,{children:"Base URL"}),(0,a.jsx)(H.Z.Control,{value:i.url,onChange:function(e){return r({type:"updateCustomImaging",payload:{index:n,url:e.target.value}})}})]}),(0,a.jsxs)(W,{title:"Base Resource URL",className:"mb-2 ms-1",children:["The ",(0,a.jsx)("b",{children:"base resource url"})," is the first (static) part of the URL. This value must starts with ",(0,a.jsx)("code",{children:"http://"})," ","or ",(0,a.jsx)("code",{children:"https://"}),(0,a.jsx)("br",{}),"The final url for each row is:",(0,a.jsx)("br",{}),(0,a.jsx)("kbd",{children:"Base URL"})," + ",(0,a.jsx)("kbd",{children:"RI Column"})," + ",(0,a.jsx)("kbd",{children:"suffix"})]})]})}),(0,a.jsx)(z.Z,{sm:4,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsxs)(M.Z,{size:"sm",children:[(0,a.jsx)(M.Z.Text,{children:"Suffix"}),(0,a.jsx)(H.Z.Control,{value:i.fileExtension,onChange:function(e){return r({type:"updateCustomImaging",payload:{index:n,fileExtension:e.target.value}})}})]}),(0,a.jsxs)(W,{title:"URL Suffix",className:"ms-1",children:["The ",(0,a.jsx)("b",{children:"url suffix"})," is the last (static) part of the URL and "," ","is used to specify the file extension, for example.",(0,a.jsx)("br",{}),"The final url for each row is:",(0,a.jsx)("br",{}),(0,a.jsx)("kbd",{children:"Base URL"})," + ",(0,a.jsx)("kbd",{children:"RI Column"})," + ",(0,a.jsx)("kbd",{children:"suffix"})]})]})})]}),(0,a.jsxs)(E.Z,{children:[(0,a.jsx)(z.Z,{sm:8,children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsxs)(M.Z,{className:"",size:"sm",children:[(0,a.jsx)(M.Z.Text,{children:"RI Column"}),(0,a.jsxs)(H.Z.Select,{defaultValue:-1,onChange:function(e){return r({type:"updateCustomImaging",payload:{index:n,columnIndex:parseInt(e.target.value)}})},children:[(0,a.jsx)("option",{value:-1,children:"Select a column"}),s.table.columns.map(function(e,n){return(0,a.jsx)("option",{value:n,children:e},n)})]})]}),(0,a.jsxs)(W,{title:"Resource Identification Column",className:" ms-1",children:["The ",(0,a.jsx)("b",{children:"resource identification column"})," (RI column) is the "," ","only variable part of the url. This field must specify the "," ","column to use to make a specific url for each row.",(0,a.jsx)("br",{}),"The final url for each row is:",(0,a.jsx)("br",{}),(0,a.jsx)("kbd",{children:"Base URL"})," + ",(0,a.jsx)("kbd",{children:"RI Column"})," + ",(0,a.jsx)("kbd",{children:"suffix"})]})]})}),(0,a.jsx)(z.Z,{sm:4,children:(0,a.jsxs)(A.Z,{variant:"outline-danger",size:"sm",onClick:function(){return r({type:"removeCustomImaging",payload:{index:n,prevColumns:s.customImaging.columns}})},children:[(0,a.jsx)(eT.HeX,{})," Remove Column"]})})]})]})};function no(){var e=P(),n=e.tcState,t=e.tcDispatch,s=n.customImaging;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(H.Z.Group,{as:E.Z,className:"mb-2",controlId:"customImagingCheck",children:[(0,a.jsx)(H.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,a.jsx)(z.Z,{sm:"11",className:"d-flex align-items-center",children:(0,a.jsx)(H.Z.Check,{type:"switch",label:"Show Custom Images Column",checked:s.enabled,onChange:function(e){return t({type:"enableCustomImaging",payload:{enabled:e.target.checked}})}})})]}),s.columns.map(function(e,n){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(nc,{index:n}),(0,a.jsx)("hr",{className:"my-4"})]})}),(0,a.jsx)(E.Z,{children:(0,a.jsx)(z.Z,{children:(0,a.jsxs)(A.Z,{size:"sm",onClick:function(){return t({type:"addCustomImaging",payload:{prevColumns:n.customImaging.columns}})},children:[(0,a.jsx)(Q.poH,{size:16})," Add Custom Imaging Column"]})})})]})}function nu(){var e=P(),n=e.tcState;e.tcDispatch;var t=function(e){eH.emit("load_table",!0)};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(B.Z.Container,{id:"list-group-tabs-example",defaultActiveKey:"#link0",children:(0,a.jsxs)(E.Z,{children:[(0,a.jsxs)(z.Z,{sm:3,children:[(0,a.jsxs)(G.Z,{children:[(0,a.jsx)(G.Z.Item,{action:!0,href:"#select-table",children:"Select Table"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#classification",children:"Classification"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#sdss",children:"SDSS Catalog"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#splus",children:"S-PLUS Imaging"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#legacy",children:"Legacy Imaging"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#custom-imaging",children:"Custom Imaging"}),(0,a.jsx)(G.Z.Item,{action:!0,href:"#spectra",children:"Spectra & PhotoSpectra"})]}),(0,a.jsx)(A.Z,{className:"mt-2 w-100 fw-bold",variant:"success",onClick:t,disabled:!n.table.file||n.table.processing,children:n.table.processing?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eM.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"light"})," Loading"]}):(0,a.jsx)(a.Fragment,{children:"Load Table"})})]}),(0,a.jsx)(z.Z,{sm:9,children:(0,a.jsxs)(B.Z.Content,{children:[(0,a.jsx)(B.Z.Pane,{eventKey:"#select-table",children:(0,a.jsx)(eB,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#classification",children:(0,a.jsx)(eg,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#sdss",children:(0,a.jsx)(nl,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#splus",children:(0,a.jsx)(ek,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#legacy",children:(0,a.jsx)(ev,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#custom-imaging",children:(0,a.jsx)(no,{})}),(0,a.jsx)(B.Z.Pane,{eventKey:"#spectra",children:(0,a.jsx)(ey,{})})]})})]})})})}var nd=t(5147),nh=t(2679);eW.create("legacy_nearby_z",1);var nm,np=(0,eX.V5)(10,"day","ms"),nx=new e1.S({defaultOptions:{queries:{staleTime:np}}}),nf=(nm=(0,eA.Z)(function(e,n){var t,s,a,r,i,l,c;return(0,eq.__generator)(this,function(a){switch(a.label){case 0:return t=20/3600,s=[],[4,eK().get("https://bittersweet-large-ticket.glitch.me/https://www.legacysurvey.org/viewer/spec/1/cat.json",{params:{ralo:parseFloat(e)-t,rahi:parseFloat(e)+t,declo:parseFloat(n)-t,dechi:parseFloat(n)+t}})];case 1:for(i=0,r=a.sent().data;i<r.name.length;i++)s.push({ra:parseFloat(r.rd[i][0]),dec:parseFloat(r.rd[i][1]),z:null===(c=null===(l=r.name[i])||void 0===l?void 0:l.match(/z=.*/))||void 0===c?void 0:c[0],name:r.name});return[2,s.filter(function(e){return!!e.z})]}})}),function(e,n){return nm.apply(this,arguments)}),ng=function(){function e(){(0,eF.Z)(this,e)}var n=e.prototype;return n.getRGBUrl=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"10";return"".concat("https://www.legacysurvey.org/viewer/cutout.jpg","?ra=").concat(e,"&dec=").concat(n,"&layer=").concat("10"==s?"ls-dr10":"ls-dr9","&pixscale=0.4&size=").concat(t)},n.getNearbyRedshift=function(e,n,t){return(0,eA.Z)(function(){return(0,eq.__generator)(this,function(t){return[2,eW.enqueue("legacy_nearby_z",function(){return nx.fetchQuery(["legacy-service-nearby-z",String(e),String(n)],function(){return nf(e,n)})})]})})()},e}(),nj=t(6932),ny=new e1.S({defaultOptions:{queries:{staleTime:(0,eX.V5)(2,"hour","ms")}}});eW.create("splus-flux-radius",1);var nv=function(){function e(){(0,eF.Z)(this,e),this.httpClient=eK().create({baseURL:"https://bittersweet-large-ticket.glitch.me/https://splus.cloud/public-TAP/tap/"}),this.publicSchemas=null,this.cachedTables=null}var n=e.prototype;return n.getTables=function(e){var n=this;return(0,eA.Z)(function(){var t,s,a,r,i,l,c,o,u;return(0,eq.__generator)(this,function(s){switch(s.label){case 0:if(null!=n.cachedTables)return[3,2];return[4,n.httpClient.get("tables")];case 1:a=s.sent().data,l=new nj.XMLParser().parse(a)["vosi:tableset"].schema,n.publicSchemas=l,s.label=2;case 2:return Array.isArray(o=(c=null===(t=n.publicSchemas)||void 0===t?void 0:t.find(function(n){return n.name==e}))&&c.table)||(o=[o]),[2,o.map(function(e){return e.name})]}})})()},n.getColumns=function(e,n){var t=this;return(0,eA.Z)(function(){var s,a,r,i,l;return(0,eq.__generator)(this,function(l){return null==t.publicSchemas?[2,[]]:(Array.isArray(r=(a=t.publicSchemas.find(function(n){return n.name==e}))&&a.table)||(r=[r]),[2,null==(i=r.find(function(e){return e.name==n}))?void 0:null===(s=i.column)||void 0===s?void 0:s.map(function(e){return e.name})])})})()},n.getTrilogyUrl=function(e,n,t,s){var a,r,i,l={ra:e,dec:n,size:t,r:null==s?void 0:null===(a=s.R)||void 0===a?void 0:a.join(","),g:null==s?void 0:null===(r=s.G)||void 0===r?void 0:r.join(","),b:null==s?void 0:null===(i=s.B)||void 0===i?void 0:i.join(","),noise:null==s?void 0:s.noise,q:null==s?void 0:s.Q},c=(0,eX.Dt)(l);return"".concat("https://checker-melted-forsythia.glitch.me/trilogy.png","?").concat(c)},n.getLuptonUrl=function(e,n,t,s){var a={ra:e,dec:n,size:t,r:null==s?void 0:s.R,g:null==s?void 0:s.G,b:null==s?void 0:s.B,stretch:null==s?void 0:s.stretch,q:null==s?void 0:s.Q},r=(0,eX.Dt)(a);return"".concat("https://checker-melted-forsythia.glitch.me/lupton.png","?").concat(r)},n.getPhotoSpecUrl=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return"".concat("https://astrotools.vercel.app/plot","?ra=").concat(e,"&dec=").concat(n,"&").concat(t.join("&"))},n.getFluxRadius=function(e,n){return(0,eA.Z)(function(){return(0,eq.__generator)(this,function(t){return[2,eW.enqueue("splus-flux-radius",(0,eA.Z)(function(){var t;return(0,eq.__generator)(this,function(t){switch(t.label){case 0:return[4,ny.fetchQuery(["splus-service-flux-radius",e,n],(0,eA.Z)(function(){var t;return(0,eq.__generator)(this,function(t){switch(t.label){case 0:return[4,eK().get("https://checker-melted-forsythia.glitch.me/fluxRadius",{params:{ra:e,dec:n}})];case 1:return[2,t.sent().data]}})}))];case 1:return[2,t.sent()]}})}))]})})()},e}(),nb=new ng,nZ=new nv,nS=function(e){var n=e.refRa,t=e.refDec,s=e.sourceSize,r=e.targetSize,i=e.pixScale,l=e.redshifts,c=r/2,o=r/(i*s/3600);return(0,a.jsxs)("svg",{viewBox:"0 0 ".concat(r," ").concat(r),children:[(0,a.jsxs)("defs",{children:[(0,a.jsxs)("filter",{x:"-0.03",y:"-0.03",width:"1.06",height:"1.06",id:"bg-text",children:[(0,a.jsx)("feFlood",{floodColor:"#FFFFFF"}),(0,a.jsx)("feComposite",{in:"SourceGraphic",operator:"over"})]}),(0,a.jsxs)("filter",{x:"-0.03",y:"-0.03",width:"1.06",height:"1.06",id:"bg-text-hover",children:[(0,a.jsx)("feFlood",{floodColor:"#AFEEEE"}),(0,a.jsx)("feComposite",{in:"SourceGraphic",operator:"over"})]})]}),l.map(function(e,s){return(0,a.jsxs)("g",{className:"circle-group",children:[(0,a.jsx)("circle",{cx:c+(n-e.ra)*o,cy:c+(t-e.dec)*o,r:"40",strokeWidth:"2px",fill:"transparent"}),(0,a.jsx)("text",{x:c+(n-e.ra)*o,y:c+35+(t-e.dec)*o,fill:"black",stroke:"transparent",textAnchor:"middle",alignmentBaseline:"hanging",children:e.z})]},s)})]})},nC=function(e){var n=e.targetSize,t=e.pixScale,s=e.majorAxis,r=e.minorAxis,i=e.rotation,l=n/2;return(0,a.jsx)("svg",{viewBox:"0 0 ".concat(n," ").concat(n),children:(0,a.jsx)("g",{children:(0,a.jsx)("ellipse",{cx:l,cy:l,rx:s/t,ry:r/t,transform:"rotate(".concat(90+i,", ").concat(l,", ").concat(l,")"),stroke:"#FFF",strokeWidth:1.5,fill:"transparent"})})})},nI=function(e){var n=e.show,t=e.onHide,s=e.src,r=e.ra,i=e.dec,c=e.showFooter,o=e.size,u=e.zoomWidth,d=e.zoomHeight,h=e.pixScale,m=(0,l.useState)(null),p=m[0],x=m[1],f=(0,l.useState)(null),g=f[0],j=f[1],y=(0,l.useState)(!1),v=y[0],b=y[1],Z=(0,l.useState)(!1),S=Z[0],C=Z[1],I=P(),N=I.tcState,w=I.tcDispatch,k=N.stampModal.showRedshift,R=N.stampModal.showAutoFluxRadius;return N.stampModal.showPetroFluxRadius,(0,l.useEffect)(function(){n&&c&&k&&null===p&&(b(!0),nb.getNearbyRedshift(r,i,0).then(function(e){b(!1),x(e)}))},[r,i,n,p,k,c]),(0,l.useEffect)(function(){n&&c&&R&&null===g&&(C(!0),nZ.getFluxRadius(r,i).then(function(e){C(!1),j(e)}))},[r,i,n,g,c,R]),(0,a.jsxs)(eh.Z,{centered:!0,show:n,onHide:t,animation:!1,size:o,children:[(0,a.jsx)(eh.Z.Body,{className:"mx-auto px-0 py-2",children:(0,a.jsxs)("div",{className:"img-overlay-wrap",children:[(0,a.jsx)("img",{src:s,width:u,height:d,alt:""}),c&&k&&p&&(0,a.jsx)(nS,{refRa:r,refDec:i,sourceSize:256,targetSize:u,pixScale:h,redshifts:p}),c&&R&&g&&(0,a.jsx)(nC,{targetSize:u,pixScale:h,majorAxis:g.A*g.kronRadius,minorAxis:g.B*g.kronRadius,rotation:g.theta})]})}),c&&(0,a.jsxs)(eh.Z.Footer,{className:"py-2",children:[(v||S)&&(0,a.jsxs)("div",{className:"me-3",children:[(0,a.jsx)(eM.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,a.jsx)("span",{className:"text-muted",children:"Loading..."})]}),(0,a.jsx)(H.Z.Check,{type:"switch",className:"me-3",id:"image-modal-auto-flux-toogle",label:"Auto flux",defaultChecked:R,disabled:S,onChange:function(e){return w({type:"setStampModal",payload:{showAutoFluxRadius:e.target.checked}})}}),(0,a.jsx)(H.Z.Check,{type:"switch",id:"image-modal-redshift-toogle",label:"Redshit",defaultChecked:k,disabled:v,onChange:function(e){return w({type:"setStampModal",payload:{showRedshift:e.target.checked}})}})]})]})},nN=function(){return(0,a.jsx)(eM.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"secondary"})};function nw(e){var n=e.src,t=e.rowId,s=e.pixScale,r=e.zoomWidth,i=e.zoomHeight,c=e.showFooter,o=e.modalSize,u=(0,l.useState)(!1),d=u[0],h=u[1],m=(0,l.useState)(!1),p=m[0],x=m[1],f=eu().tdState,g=(0,l.useMemo)(function(){return eD.getRa(t,f)},[t,f]),j=(0,l.useMemo)(function(){return eD.getDec(t,f)},[t,f]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(nh.LazyLoadImage,{src:p?"https://dummyimage.com/90x90/e8e8e8/474747.jpg&text=Not+Found":n,height:100,placeholder:(0,a.jsx)(nN,{}),onClick:function(){return!p&&h(!0)},className:"cursor-pointer",onError:function(){return x(!0)}}),(0,a.jsx)(nI,{show:d,onHide:function(){return h(!1)},src:n,ra:g,dec:j,showFooter:void 0===c||c,size:void 0===o?"":o,zoomWidth:r,zoomHeight:i,pixScale:s})]})}function nk(e){var n=e.rowId,t=P().tcState,s=eu(),r=s.tdState,i=s.tdDispatch;return(0,a.jsxs)(H.Z.Select,{defaultValue:"",value:r.data[n].classification,onChange:function(e){i({type:"setClass",payload:{class:e.target.value,rowId:n}})},children:[(0,a.jsx)("option",{value:"",children:"-"}),t.classification.classNames.map(function(e){return(0,a.jsx)("option",{value:e,children:e},e)})]})}var nR=new e4,nT=function(e){var n=e.show,t=e.onHide,s=e.src;return(0,a.jsx)(eh.Z,{centered:!0,show:n,onHide:t,animation:!1,size:"lg",children:(0,a.jsx)(eh.Z.Body,{className:"p-1",children:(0,a.jsx)("img",{src:s,width:"100%",alt:""})})})};function nF(e){var n=e.rowId,t=(0,l.useState)(!1),s=t[0],r=t[1],i=eu().tdState,c=eD.getCellValue(n,"sdssSpectra",i),o=nR.getSpecPlotUrlById(c);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{className:"cursor-pointer",src:null===c?"https://dummyimage.com/90x90/e8e8e8/474747.jpg&text=Not+Found":o,height:90,alt:"",onClick:function(){return r(!0)}}),(0,a.jsx)(nT,{src:o,show:s,onHide:function(){return r(!1)}})]})}function nL(e){var n=e.rowId,t=e.colId,s=eu().tdState,r=eD.getCellValue(n,t,s);return(0,a.jsx)(a.Fragment,{children:void 0===r?(0,a.jsx)(eM.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"secondary"}):null===r?(0,a.jsx)(a.Fragment,{children:"-"}):(0,a.jsx)(a.Fragment,{children:r})})}var nD=t(4799),nP=new ng,n_=function(e){var n=e.redshifts;return(0,a.jsx)(a.Fragment,{children:n.map(function(e,t){return(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{children:e}),t!=n.length-1&&(0,a.jsx)("hr",{className:"my-1"})]},t)})})};function nz(e){var n=e.rowId,t=(0,l.useState)(null),s=t[0],r=t[1],i=eu().tdState,c=(0,l.useMemo)(function(){return eD.getRa(n,i)},[n,i]),o=(0,l.useMemo)(function(){return eD.getDec(n,i)},[n,i]);return(0,l.useEffect)(function(){nP.getNearbyRedshift(c,o,0).then(function(e){var n,t;console.log(null===(n=e[0])||void 0===n?void 0:n.name.slice(0,3)),r(null===(t=e[0])||void 0===t?void 0:t.name.slice(0,3))})},[c,o]),(0,a.jsx)(a.Fragment,{children:null===s?(0,a.jsx)(eM.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"secondary"}):void 0===s?(0,a.jsx)(a.Fragment,{children:"-"}):(0,a.jsx)(n_,{redshifts:s})})}var nE=new nv,nB=new ng,nG=new e4,nU=(0,nD.createColumnHelper)(),nH={sourceTable:function(e){return nU.accessor("sourceTable:".concat(e),{cell:function(e){return e.getValue()},header:e})},legacyImaging:function(e){return nU.accessor("legacyImaging",{cell:function(n){return(0,a.jsx)(nw,{src:n.getValue(),rowId:n.row.index,pixScale:e,zoomWidth:600,zoomHeight:600,modalSize:"lg"})},header:"Legacy"})},splusImaging:function(){return nU.accessor("splusImaging",{cell:function(e){return(0,a.jsx)(nw,{pixScale:.55,src:e.getValue(),rowId:e.row.index,zoomWidth:600,zoomHeight:600,modalSize:"lg"})},header:"S-PLUS"})},customImaging:function(e){return nU.accessor("customImaging:".concat(e),{cell:function(e){return(0,a.jsx)(nw,{src:e.getValue(),rowId:e.row.index,showFooter:!1,zoomWidth:900,zoomHeight:900,modalSize:"xl"})},header:"Custom"})},classification:function(){return nU.accessor("classification",{cell:function(e){return(0,a.jsx)(nk,{rowId:e.row.index})},header:"Class"})},sdssSpectra:function(){return nU.accessor("sdssSpectra",{cell:function(e){return(0,a.jsx)(nF,{rowId:e.row.index})},header:"SDSS Spec"})},sdssCatalog:function(e,n){return nU.accessor("sdss:".concat(e,".").concat(n),{cell:function(t){return(0,a.jsx)(nL,{rowId:t.row.index,colId:"sdss:".concat(e,".").concat(n)})},header:n})},splusPhotoSpectra:function(){return nU.accessor("splusPhotoSpectra",{cell:function(e){return(0,a.jsx)(nw,{src:e.getValue(),rowId:e.row.index,showFooter:!1,modalSize:"lg",zoomWidth:780})},header:"PhotoSpec"})},nearbyRedshifts:function(){return nU.accessor("nearbyRedshifts",{cell:function(e){return(0,a.jsx)(nz,{rowId:e.row.index})},header:"z"})}};function nM(){var e=P(),n=e.tcState,t=e.tcDispatch,s=eu(),r=s.tdState,i=s.tdDispatch,c=(0,l.useState)("-1"),o=c[0],u=c[1],d=r.data,m=(0,l.useMemo)(function(){var e,n=r.schema.sourceTable.map(function(e){return nH.sourceTable(e.colName)}),t=(null===(e=r.schema.legacyImaging)||void 0===e?void 0:e.enabled)?[nH.legacyImaging(r.schema.legacyImaging.pixelScale)]:[],s=r.schema.splusImaging?[nH.splusImaging()]:[],a=r.schema.classification?[nH.classification()]:[],i=r.schema.sdssSpectra?[nH.sdssSpectra()]:[],l=r.schema.sdssCatalog.map(function(e){return nH.sdssCatalog(e.tableName,e.colName)}),c=r.schema.splusPhotoSpectra?[nH.splusPhotoSpectra()]:[],o=r.schema.nearbyRedshifts?[nH.nearbyRedshifts()]:[],u=[];if(r.schema.customImaging.enabled)for(var d=0;d<r.schema.customImaging.nCols;d++)u.push(nH.customImaging(d));return(0,h.Z)(a).concat((0,h.Z)(n),(0,h.Z)(l),(0,h.Z)(o),(0,h.Z)(c),(0,h.Z)(i),(0,h.Z)(t),(0,h.Z)(s),(0,h.Z)(u))},[r.schema]),p=(0,nD.useReactTable)({data:d,columns:m,getCoreRowModel:(0,nD.getCoreRowModel)()});(0,l.useEffect)(function(){eH.on("load_table",function(){t({type:"setFileInput",payload:{processing:!0}}),eD.load(n.table.file,function(e){for(var s=function(e){var t=a[e+1][l.raIndex],s=a[e+1][l.decIndex],r={};if(o.sourceTable.forEach(function(n){r["sourceTable:".concat(n.colName)]=a[e+1][n.colId]}),o.sdssCatalog.forEach(function(e){r["sdss:".concat(e.tableName,".").concat(e.colName)]=void 0}),o.legacyImaging){var i=Math.round(600*n.legacyImaging.pixelScale/.4);r.legacyImaging=nB.getRGBUrl(t,s,i,n.legacyImaging.dataRelease)}if(o.splusImaging){var u=n.splusImaging.type,d=Math.round(600*n.splusImaging.pixelScale/.55);r.splusImaging="trilogy"==u?nE.getTrilogyUrl(t,s,d,n.splusImaging.trilogyConfig):nE.getLuptonUrl(t,s,d,n.splusImaging.luptonConfig)}o.customImaging&&n.customImaging.columns.forEach(function(n,t){var s=a[e+1][n.columnIndex];r["customImaging:".concat(t)]="".concat(n.url).concat(s).concat(n.fileExtension)}),o.classification&&(r.classification=void 0),o.sdssSpectra&&(r.sdssSpectra=void 0),o.splusPhotoSpectra&&(r.splusPhotoSpectra=nE.getPhotoSpecUrl(t,s,n.splusPhotoSpectra.selectedLines)),o.nearbyRedshifts&&(r.nearbyRedshifts=void 0),c[e]=r},a=e.data,r=e.data[0],l=eD.getHeaderSummary(r),c=Array(a.length-1),o={sourceTable:n.table.selectedColumnsId.map(function(e){return{colId:e,colName:n.table.columns[e]}}),sdssCatalog:n.sdssCatalog.selectedColumns.map(function(e){return{tableName:e.table,colName:e.column}}),legacyImaging:{enabled:n.legacyImaging.enabled,pixelScale:n.legacyImaging.pixelScale},splusImaging:!!n.splusImaging.enabled,customImaging:{enabled:!!n.customImaging.enabled,nCols:n.customImaging.columns.length},classification:n.classification.enabled,sdssSpectra:n.sdssSpectra.enabled,splusPhotoSpectra:n.splusPhotoSpectra.enabled,nearbyRedshifts:n.nearbyRedshifts.enabled},u=0;u<a.length-1;u++)s(u);i({type:"initTable",payload:{initialData:c,sourceData:a,sourceColumns:r,raIndex:l.raIndex,decIndex:l.decIndex,schema:o}});var d=a.slice(1).map(function(e,n){return{index:n,ra:e[l.raIndex],dec:e[l.decIndex]}}),h={name:null===(f=n.table.file)||void 0===f?void 0:f.name,lastModified:null===(g=n.table.file)||void 0===g?void 0:g.lastModified},m=!0,p=!1,x=void 0;try{for(var f,g,j,y=o.sdssCatalog[Symbol.iterator]();!(m=(j=y.next()).done);m=!0)!function(){var e=j.value;nG.chunckedQuery(d,e.tableName,[e.colName],h,function(n){i({type:"setBatchData",payload:{data:n,keys:["sdss:".concat(e.tableName,".").concat(e.colName)],columns:[e.colName]}})})}()}catch(v){p=!0,x=v}finally{try{m||null==y.return||y.return()}finally{if(p)throw x}}o.sdssSpectra&&nG.chunckedQuery(d,"SpecObjAll",["specObjId"],h,function(e){i({type:"setBatchData",payload:{data:e,keys:["sdssSpectra"],columns:["specObjId"]}})}),t({type:"setFileInput",payload:{processing:!1}})})})},[n,t,r,i]);var x=(0,l.useCallback)(function(e){(e.stopPropagation(),/^[\w\d]$/i.test(e.key)&&parseInt(o)>=0)?i({type:"setClass",payload:{class:Object.keys(n.classification.keyMap).find(function(t){return n.classification.keyMap[t]==e.key}),rowId:parseInt(o)}}):"ArrowDown"==e.key?u(String(parseInt(o)+1)):"ArrowUp"==e.key&&u(String(parseInt(o)-1))},[n,i,o]);return(0,l.useEffect)(function(){return document.addEventListener("keydown",x,!0),function(){document.removeEventListener("keydown",x,!0)}},[x]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(nd.Z,{striped:!0,bordered:!0,hover:!0,className:"mt-3",style:{position:"relative",borderCollapse:"collapse"},children:[(0,a.jsx)("thead",{children:p.getHeaderGroups().map(function(e){return(0,a.jsx)("tr",{style:{},children:e.headers.map(function(e){return(0,a.jsx)("th",{style:{position:"sticky",top:0,backgroundClip:"padding-box",backgroundColor:"white",padding:"0px"},children:(0,a.jsx)("div",{className:"border-bottom border-1",style:{padding:"8px"},children:e.isPlaceholder?null:(0,nD.flexRender)(e.column.columnDef.header,e.getContext())})},e.id)})},e.id)})}),(0,a.jsx)("tbody",{children:p.getRowModel().rows.map(function(e){return(0,a.jsx)("tr",{className:e.id==o?"table-primary":"",onClick:function(){e.id==o?u("-1"):u(e.id)},children:e.getVisibleCells().map(function(e){return(0,a.jsx)("td",{className:"p-1",children:(0,nD.flexRender)(e.column.columnDef.cell,e.getContext())},e.id)})},e.id)})})]})})}function nA(){return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(D,{children:[(0,a.jsx)(_,{}),(0,a.jsx)(i.Z,{title:"XTable"}),(0,a.jsxs)(eo,{children:[(0,a.jsx)(r.Z,{className:"mt-3",children:(0,a.jsx)(nu,{})}),(0,a.jsx)(r.Z,{fluid:!0,className:"px-0",children:(0,a.jsx)(nM,{})})]})]})})}},768:function(e){e.exports={chip:"ButtonChip_chip__MTWn5"}},7077:function(e){e.exports={chip:"Chip_chip__tunY0",pointer:"Chip_pointer___ocw2",closebtn:"Chip_closebtn__MtFlG"}}},function(e){e.O(0,[13,556,445,874,617,245,352,774,888,179],function(){return e(e.s=4963)}),_N_E=e.O()}]);