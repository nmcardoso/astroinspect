(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7594:function(e){function s(e){return Promise.resolve().then(function(){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s})}s.keys=function(){return[]},s.resolve=s,s.id=7594,e.exports=s},8312:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(6543)}])},6543:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return lg}});var t,a,n=l(5893),i=l(7294),o=l(9483),r=l.n(o);(t=a||(a={}))[t.LOAD_SAVED_STATE=0]="LOAD_SAVED_STATE",t[t.USER_FILE_INPUT=1]="USER_FILE_INPUT",t[t.GRID_UPDATE=2]="GRID_UPDATE",t[t.CLASSIFICATION_CONFIG=3]="CLASSIFICATION_CONFIG",t[t.SPLUS_TRILOGY_CONFIG=4]="SPLUS_TRILOGY_CONFIG",t[t.SPLUS_IMAGING=5]="SPLUS_IMAGING",t[t.SPLUS_LUPTON_CONFIG=6]="SPLUS_LUPTON_CONFIG",t[t.SPLUS_PHOTO_SPECTRA=7]="SPLUS_PHOTO_SPECTRA",t[t.LEGACY_IMAGING=8]="LEGACY_IMAGING",t[t.SDSS_IMAGING=9]="SDSS_IMAGING",t[t.SDSS_CATALOG=10]="SDSS_CATALOG",t[t.CUSTOM_IMAGE_NEW=11]="CUSTOM_IMAGE_NEW",t[t.CUSTOM_IMAGE_UPDATE=12]="CUSTOM_IMAGE_UPDATE",t[t.CUSTOM_IMAGE_REMOVE=13]="CUSTOM_IMAGE_REMOVE",t[t.CUSTOM_IMAGE_ENABLE=14]="CUSTOM_IMAGE_ENABLE",t[t.CURRENT_VIEW_CHANGE=15]="CURRENT_VIEW_CHANGE",t[t.SCATTER_PLOT_SETUP=16]="SCATTER_PLOT_SETUP",t[t.COLOR_PLOT_SETUP=17]="COLOR_PLOT_SETUP",t[t.HISTOGRAM_PLOT_SETUP=18]="HISTOGRAM_PLOT_SETUP",t[t.PLOT_VIEW_CHANGE=19]="PLOT_VIEW_CHANGE",t[t.PLOT_SETUP=20]="PLOT_SETUP";let c=()=>({schemaVersion:21,table:{type:"local",file:null,url:null,selectedColumnsId:[],columns:[],raIndex:null,decIndex:null,state:"unloaded",isSameFile:!1,dataTypes:void 0},grid:{data:void 0,colDef:void 0,api:void 0,isLoaded:!1,currColConfigs:void 0,currTale:void 0,editable:!1},currentView:"settings",cols:{classification:{enabled:!1,type:"categorical",classNames:[],positiveClass:"",negativeClass:"",filterUnclassified:!0,keyMap:{}},sdssCatalog:{selectedColumns:[]},splusImaging:{enabled:!0,type:"trilogy",pixelScale:.4,trilogyConfig:{R:["R","I","F861","Z"],G:["G","F515","F660"],B:["U","F378","F395","F410","F430"],noise:.15,Q:.2},luptonConfig:{R:"I",G:"R",B:"G",stretch:1.4,Q:6.2}},legacyImaging:{enabled:!0,pixelScale:.4,autoPixelScale:!0,dataRelease:"10"},sdssSpectra:{enabled:!0},splusPhotoSpectra:{enabled:!0,selectedLines:["iso","aper6"]},customImaging:{enabled:!1,columns:[{url:"",fileExtension:"",columnIndex:-1}]}},plots:{scatter:{xColumn:"",yColumn:"",colorColumn:"",sizeColumn:"",filterOutliers:!0},color:{xColumn1:"",xColumn2:"",yColumn1:"",yColumn2:"",colorColumn:"",sizeColumn:"",filterOutliers:!0},histogram:{column:"",bins:30,filterOutliers:!0},currentView:"scatter",filterIndex:[],filterView:void 0,inspectSelected:!1}}),d=c(),u=e=>{let s={...e,table:c().table,grid:c().grid,currentView:c().currentView};r().setItem("tableConfigState",s,(e,s)=>{e&&console.error(e)})};function m(e,s,l){let t={...e};for(let e in s.payload)l(t)[e]=s.payload[e];return u(t),t}let h={[a.LOAD_SAVED_STATE]:(e,s)=>s.payload,[a.USER_FILE_INPUT]:(e,s)=>m(e,s,e=>e.table),[a.CLASSIFICATION_CONFIG]:(e,s)=>m(e,s,e=>e.cols.classification),[a.SPLUS_TRILOGY_CONFIG]:(e,s)=>m(e,s,e=>e.cols.splusImaging.trilogyConfig),[a.SPLUS_IMAGING]:(e,s)=>m(e,s,e=>e.cols.splusImaging),[a.SPLUS_LUPTON_CONFIG]:(e,s)=>m(e,s,e=>e.cols.splusImaging.luptonConfig),[a.SPLUS_PHOTO_SPECTRA]:(e,s)=>m(e,s,e=>e.cols.splusPhotoSpectra),[a.LEGACY_IMAGING]:(e,s)=>m(e,s,e=>e.cols.legacyImaging),[a.SDSS_IMAGING]:(e,s)=>m(e,s,e=>e.cols.sdssSpectra),[a.SDSS_CATALOG]:(e,s)=>m(e,s,e=>e.cols.sdssCatalog),[a.CUSTOM_IMAGE_NEW]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=[...s.payload.prevColumns,{url:"",fileExtension:"",columnIndex:-1}],u(l),l},[a.CUSTOM_IMAGE_UPDATE]:(e,s)=>m(e,s,e=>e.cols.customImaging.columns[s.payload.index]),[a.CUSTOM_IMAGE_REMOVE]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=s.payload.prevColumns.filter((e,l)=>l!=s.payload.index),u(l),l},[a.CUSTOM_IMAGE_ENABLE]:(e,s)=>m(e,s,e=>e.cols.customImaging),[a.GRID_UPDATE]:(e,s)=>m(e,s,e=>e.grid),[a.CURRENT_VIEW_CHANGE]:(e,s)=>{let l={...e};return l.currentView=s.payload,l},[a.SCATTER_PLOT_SETUP]:(e,s)=>m(e,s,e=>e.plots.scatter),[a.COLOR_PLOT_SETUP]:(e,s)=>m(e,s,e=>e.plots.color),[a.HISTOGRAM_PLOT_SETUP]:(e,s)=>m(e,s,e=>e.plots.histogram),[a.PLOT_VIEW_CHANGE]:(e,s)=>{let l={...e};return l.plots.currentView=s.payload,l},[a.PLOT_SETUP]:(e,s)=>m(e,s,e=>e.plots)},p=(e,s)=>h[s.type](e,s),x=(0,i.createContext)({tcState:d,tcDispatch:()=>{}}),g=e=>{let{children:s}=e,[l,t]=(0,i.useReducer)(p,d);return(0,n.jsx)(x.Provider,{value:{tcState:l,tcDispatch:t},children:s})},j=()=>(0,i.useContext)(x);function y(){let{tcDispatch:e}=j();return(0,i.useEffect)(()=>{r().getItem("tableConfigState",(s,l)=>{s||null===l||21!==l.schemaVersion||e({type:a.LOAD_SAVED_STATE,payload:l})})},[e]),null}var f=l(9008),b=l.n(f),v=l(688),C=l(2184),S=l(6698),I=l(7083),N=l(8447),Z=l(4855),T=l(404);let _="10.5281/zenodo.7268504",w="@software{astrotools,\n    doi = {10.5281/zenodo.7268504},\n    url = {https://doi.org/10.5281/zenodo.7268504},\n    year = {2022},\n    month = oct,\n    publisher = {Zenodo},\n    author = {Cardoso, N. M.},\n    title = {Astrotools: Web-based astronomical tools}\n}",E=e=>{let{show:s,onHide:l}=e,[t,a]=(0,i.useState)(!1),[o,r]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{t&&setTimeout(()=>a(!1),3e3),o&&setTimeout(()=>r(!1),3e3)},[t,o]),(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"How to cite this software"})}),(0,n.jsxs)(N.Z.Body,{children:[(0,n.jsx)("p",{children:"If you used this software during the production process of your scientific project, please consider citing it with the information provided below."}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(S.Z,{children:"DOI"}),(0,n.jsx)(Z.CopyToClipboard,{text:_,onCopy:()=>a(!0),children:(0,n.jsx)(I.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),t&&(0,n.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,n.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:_})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)(S.Z,{children:"BibTex"}),(0,n.jsx)(Z.CopyToClipboard,{text:w,onCopy:()=>r(!0),children:(0,n.jsx)(I.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),o&&(0,n.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,n.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:w})]})]})]})};function L(){let[e,s]=(0,i.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.Z,{size:"sm",variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>s(!0),children:[(0,n.jsx)(T.X1l,{className:"me-1",size:18}),(0,n.jsx)("span",{children:"Cite this software"})]}),(0,n.jsx)(E,{show:e,onHide:()=>s(!1)})]})}function P(e,s,l){if("ms"===l)switch(s){case"sec":return 1e3*e;case"min":return 6e4*e;case"hour":return 36e5*e;case"day":return 864e5*e;case"week":return 252e5*e;case"month":return 2592e6*e}}function O(e,s){let l=RegExp("^".concat(e,"_?J?d*?$"),"gi");return s.findIndex((e,s)=>null!==l.exec(e))}var k=l(5675),R=l.n(k),A=l(1664),U=l.n(A);function G(){return(0,n.jsx)(C.Z.Brand,{as:"div",className:"",children:(0,n.jsx)(U(),{href:"/",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(R(),{alt:"AstronInspect",src:"".concat("/","galaxy_128.png"),width:"30",height:"30",className:"d-inline-block align-top"}),(0,n.jsx)("span",{className:"ms-2 fw-bold",children:"AstroInspect"})]})})})}var F=l(5071),z=l(4055),D=l(1470);function M(e){let{children:s,title:l=null,placement:t="auto",className:a=""}=e,i=(0,n.jsxs)(z.Z,{id:"help-popover",children:[l&&(0,n.jsx)(z.Z.Header,{as:"h3",children:l}),(0,n.jsx)(z.Z.Body,{children:s})]});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(F.Z,{trigger:"click",rootClose:!0,placement:t,overlay:i,children:(0,n.jsx)(I.Z,{variant:"link",className:"p-0 d-inline-flex align-items-center ".concat(a),children:(0,n.jsx)(D.CUu,{size:20})})})})}var B=l(1409),V=l(7772),H=l(4940),q=l(8587),K=l(1096);let W=e=>{let{show:s,onHide:l}=e,{tcState:t,tcDispatch:a}=j(),[o,r]=(0,i.useState)(""),[c,d]=(0,i.useState)("all"),[u,m]=(0,i.useState)("all"),[h,p]=(0,i.useState)(!1);return(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Download current table"})}),(0,n.jsx)(N.Z.Body,{children:(0,n.jsxs)(V.Z,{onSubmit:e=>{let s;e.preventDefault(),t.grid.api.exportDataAsCsv({suppressQuotes:!0,columnKeys:[..."all"===c?t.table.selectedColumnsId.map(e=>"tab:".concat(t.table.columns[e])):t.table.columns.map(e=>"tab:".concat(e)),...t.cols.sdssCatalog.selectedColumns.map(e=>"sdss:".concat(e.table,"_").concat(e.column)),...t.cols.classification.enabled?["ai:class"]:[]],fileName:o||"AstroInspect",exportedRows:h?"filteredAndSorted":"all",shouldRowBeSkipped:"classified"===u?e=>{var s,l;let{node:t}=e;return(null===(s=t.data)||void 0===s?void 0:s["ai:class"])===void 0||(null===(l=t.data)||void 0===l?void 0:l["ai:class"])===""}:"unclassified"===u?e=>{var s,l;let{node:t}=e;return(null===(s=t.data)||void 0===s?void 0:s["ai:class"])!==void 0||(null===(l=t.data)||void 0===l?void 0:l["ai:class"])!==""}:void 0,processHeaderCallback:e=>{let{column:s}=e;return"ai:class"===s.getColDef().field?"AstroInspectClass":s.getColDef().headerName}})},className:"mt-3",children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"classDownload",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"2",className:"text-end",children:"File name"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(V.Z.Control,{value:o,onChange:e=>r(e.target.value),placeholder:"File name"}),(0,n.jsx)(H.Z.Text,{id:"basic-addon2",children:".csv"})]}),(0,n.jsx)(M,{title:"File name",className:"ms-2",children:"Choose a name and save your classifications in local computer"})]})})]}),t.cols.classification.enabled&&(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"colFilter",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Classification"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(V.Z.Check,{inline:!0,className:"me-4",checked:"all"===u,label:"all",name:"filterClass",type:"radio",value:"all",id:"filterClass-1",onChange:e=>m("all")}),(0,n.jsx)(V.Z.Check,{inline:!0,className:"me-4",checked:"classified"===u,label:"classified only",name:"filterClass",type:"radio",value:"classified",id:"filterClass-2",onChange:e=>m("classified")}),(0,n.jsx)(V.Z.Check,{inline:!0,className:"me-2",checked:"unclassified"===u,label:"unclassified only",name:"filterClass",type:"radio",value:"unclassified",id:"filterClass-3",onChange:e=>m("unclassified")}),(0,n.jsxs)(M,{title:"Filter rows by class",className:"ms-0",children:["This setting will sample the rows based in the classification state:",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"all: "})," in this case, no filtering is performed and the output table will contain all rows, including both classified and unclassified rows"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"classified only: "})," the output table will contain only classified rows"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"unclassified only: "})," the output table will contain only unclassified rows"]})]})]})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"filterRow-2",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Rows"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(V.Z.Check,{inline:!0,checked:h,label:"filter & sort",name:"filterRow",type:"checkbox",value:"filteredAndSorted",id:"filterRow-2",onChange:e=>p(!h)}),(0,n.jsxs)(M,{title:"Filter rows by filter",className:"ms-0",children:["This setting will sample the rows based in the following criteria:",(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["If this option is ",(0,n.jsx)("b",{children:"selected"}),", the same filters applied in the application will also be applied to the output table, that is, it will contain the ",(0,n.jsx)("u",{children:"same rows that you are seeing in the application"})," and in the same order."]}),(0,n.jsxs)("li",{children:["If this option is ",(0,n.jsx)("b",{children:"unselected"}),", no filtering is performed and the output table will have the ",(0,n.jsx)("u",{children:"same rows as the input table"})," and in same order."]})]}),(0,n.jsx)("b",{children:"Note: "})," If you have not applied any filtering or sorting to the columns, then the result will be the same for any option in this setting."]})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"my-3",controlId:"classDownloadBtn",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"2",className:"text-end"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsx)(H.Z,{children:(0,n.jsxs)(I.Z,{variant:"primary",type:"submit",children:[(0,n.jsx)(K.xOH,{size:18,className:"me-1"})," ","Download table"]})})})]})]})})]})};function Q(){let{tcState:e}=j(),[s,l]=(0,i.useState)(!1);return e.grid.isLoaded?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(I.Z,{variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>l(!0),size:"sm",children:[(0,n.jsx)(K.xOH,{size:19,className:"me-1"}),(0,n.jsx)("span",{children:"Download"})]}),(0,n.jsx)(W,{show:s,onHide:()=>l(!1)})]}):null}var Y=l(5555),X=l(9556),J=l(8937);let $=Symbol("Queued"),ee=Symbol("Loading"),es=Symbol("Load Error"),el=()=>(0,n.jsxs)("span",{className:"text-dark",children:[(0,n.jsx)(J.xps,{size:15})," Queued"]}),et=()=>(0,n.jsxs)("span",{className:"text-primary",children:[(0,n.jsx)(Y.uKn,{size:15})," Downloading"]}),ea=()=>(0,n.jsxs)("span",{className:"text-danger",children:[(0,n.jsx)(Y.wr$,{size:15})," Server Error"]});function en(e){let s=(0,i.useMemo)(()=>e.value===$?el:e.value===ee?et:e.value===es?ea:()=>(0,n.jsx)("span",{children:e.value}),[e.value]);return(0,n.jsx)(s,{})}let ei=e=>{let{show:s,onHide:l,src:t,size:a,zoomWidth:i,zoomHeight:o}=e;return(0,n.jsx)(N.Z,{centered:!0,show:s,onHide:l,animation:!1,size:a,children:(0,n.jsx)(N.Z.Body,{className:"mx-auto px-0 py-2",children:(0,n.jsx)("img",{src:t,width:i,height:o,alt:""})})})},eo=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-dark",children:[(0,n.jsx)(J.xps,{size:15})," Queued"]})}),er=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-primary",children:[(0,n.jsx)(Y.uKn,{size:15})," Downloading"]})}),ec=()=>(0,n.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,n.jsxs)("span",{className:"text-danger",children:[(0,n.jsx)(Y.wr$,{size:15})," Server Error"]})});function ed(e){let{src:s,zoomWidth:l,zoomHeight:t,modalSize:a="",lazy:o=!1}=e,[r,c]=(0,i.useState)(!1),d=(0,i.useMemo)(()=>s===$?eo:s===ee?er:s===es?ec:()=>(0,n.jsx)("img",{src:s,alt:"",loading:o?"lazy":"eager",height:120,style:{cursor:"zoom-in"},onClick:()=>c(!0)}),[s,o]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d,{}),(0,n.jsx)(ei,{show:r,onHide:()=>c(!1),src:s,size:a,zoomWidth:l,zoomHeight:t})]})}function eu(e){let{zoomWidth:s,zoomHeight:l,modalSize:t="",lazy:a=!1}=e;return function(e){return(0,n.jsx)(ed,{src:e.value,zoomWidth:s,zoomHeight:l,modalSize:t,lazy:a})}}var em=l(7460),eh=l.n(em),ep=l(918),ex=l(2634);let eg=e=>{if(e)return new Promise((s,l)=>{eh().parse(e,{complete:e=>{let{data:l}=e;return s(l)},error:e=>l(e),skipEmptyLines:!0,header:!0,dynamicTyping:!0,transformHeader:(e,s)=>"tab:".concat(e)})})},ej=e=>{if(e)return new Promise((s,l)=>{eh().parse(e,{complete:e=>{let{data:l}=e;return s(l)},error:e=>l(e),skipEmptyLines:!0,header:!0,dynamicTyping:!0,download:!0,transformHeader:(e,s)=>"tab:".concat(e)})})},ey=e=>"string"==typeof e||e instanceof String?ej(e):eg(e),ef=e=>new Promise((s,l)=>{eh().parse(e,{complete:e=>{var t;if(e.errors.length>0)return l(e.errors);s(null===(t=e.data)||void 0===t?void 0:t[0])},preview:1})}),eb=e=>new Promise((s,l)=>{eh().parse(e,{complete:e=>{var t;if(e.errors.length>0)return l(e.errors);s(null===(t=e.data)||void 0===t?void 0:t[0])},preview:1,download:!0})}),ev=e=>"string"==typeof e||e instanceof String?eb(e):ef(e),eC=e=>new Promise((s,l)=>{(async()=>{await (0,ep.RL)({file:await e.arrayBuffer(),onComplete:e=>s(e),compressors:ex.F})})().catch(e=>l(e))}),eS=e=>new Promise((s,l)=>{(async()=>{await (0,ep.RL)({file:await (0,ep.EU)(e),onComplete:e=>s(e),compressors:ex.F})})().catch(e=>l(e))}),eI=e=>"string"==typeof e||e instanceof String?eS(e):eC(e),eN=async e=>{let s=(0,ep.tI)(await e.arrayBuffer());return console.log(s),s.schema.filter(e=>"schema"!==e.name).map(e=>e.name)},eZ=async e=>(await (0,ep.uI)(await (0,ep.EU)(e))).schema.filter(e=>"schema"!==e.name).map(e=>e.name),eT=e=>"string"==typeof e||e instanceof String?eZ(e):eN(e),e_=async e=>{let s=(0,ep.tI)(await e.arrayBuffer()),l={BOOLEAN:"boolean",INT32:"number",INT64:void 0,INT96:void 0,FLOAT:"number",DOUBLE:"number",STRING:"text",BYTE_ARRAY:"object",FIXED_LEN_BYTE_ARRAY:"object",DEFAULT:void 0};return s.schema.filter(e=>"schema"!==e.name).map(e=>{var s,t,a;return l[(null===(t=e.logical_type)||void 0===t?void 0:null===(s=t.type)||void 0===s?void 0:s.toUpperCase())||(null===(a=e.type)||void 0===a?void 0:a.toUpperCase())||"DEFAULT"]})},ew=async e=>{let s=await (0,ep.uI)(await (0,ep.EU)(e)),l={BOOLEAN:"boolean",INT32:"number",INT64:void 0,INT96:void 0,FLOAT:"number",DOUBLE:"number",STRING:"text",BYTE_ARRAY:"object",FIXED_LEN_BYTE_ARRAY:"object",DEFAULT:void 0};return s.schema.filter(e=>"schema"!==e.name).map(e=>{var s,t,a;return l[(null===(t=e.logical_type)||void 0===t?void 0:null===(s=t.type)||void 0===s?void 0:s.toUpperCase())||(null===(a=e.type)||void 0===a?void 0:a.toUpperCase())||"DEFAULT"]})},eE=e=>"string"==typeof e||e instanceof String?ew(e):e_(e);class eL{getFileExt(){if(!this.ext){var e,s;this.isUrl?this.ext=null===(s=this.file.split(".").pop())||void 0===s?void 0:s.toLowerCase():this.ext=null===(e=this.file.name.split(".").pop())||void 0===e?void 0:e.toLowerCase()}return this.ext}async read(){if(["csv","tsv","dat","txt"].includes(this.getFileExt()||""))return await ey(this.file);if(["parquet","parq","par","pq"].includes(this.getFileExt()||"")){let e=await eI(this.file),s=await this.getColumns();return s?e.map(e=>Object.fromEntries(Object.entries(e).map(e=>{let[l,t]=e;return["tab:".concat(s[l]),t]}))):e}}async getColumns(){return["csv","tsv","dat","txt"].includes(this.getFileExt()||"")?this.columns=await ev(this.file):["parquet","parq","par","pq"].includes(this.getFileExt()||"")&&(this.columns=await eT(this.file)),this.columns}async getDataTypes(){let e;return["csv","tsv","dat","txt"].includes(this.getFileExt()||"")?e=void 0:["parquet","parq","par","pq"].includes(this.getFileExt()||"")&&(e=await eE(this.file)),e}constructor(e){this.ext=void 0,this.columns=void 0,this.isUrl="string"==typeof e||e instanceof String,this.file=e}}let eP={field:"ai:id",maxWidth:80,headerName:"#"},eO={field:"ai:class",flex:1,headerName:"class",filter:!0,cellRenderer:function(e){let{tcState:s}=j();return(0,n.jsxs)(V.Z.Select,{value:e.value,onChange:s=>{var l;null===(l=e.api.getRowNode(e.data["ai:id"]))||void 0===l||l.setDataValue("ai:class",s.target.value)},children:[(0,n.jsx)("option",{value:"",children:"-"}),s.cols.classification.classNames.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}},ek={field:"img:splus",flex:1,headerName:"splus",cellRenderer:eu({zoomHeight:650,modalSize:"lg"})},eR={field:"img:legacy",flex:1,headerName:"legacy",cellRenderer:eu({zoomHeight:650,modalSize:"lg"})},eA={field:"img:sdss_spec",flex:1,headerName:"spec",cellRenderer:eu({zoomHeight:620,modalSize:"lg"})},eU={field:"img:splus_photospec",flex:1,headerName:"photo spec",cellRenderer:eu({zoomHeight:625,modalSize:"lg"})},eG=e=>({field:"img:custom_".concat(e),flex:1,headerName:"custom ".concat(e+1),cellRenderer:eu({zoomHeight:650,modalSize:"lg",lazy:!0})}),eF=(e,s)=>({field:"sdss:".concat(e,"_").concat(s),flex:1,headerName:s.toLowerCase(),filter:!0,cellRenderer:en}),ez=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,t=l?{cellDataType:l}:{};return console.log(e,t),{field:"tab:".concat(e),flex:1,headerName:e.toLowerCase(),filter:!0,editable:s,...t}};class eD{async load(e){let s=new eL(e);return await s.read()}getHeaderSummary(e){let s=O("ra",e),l=O("dec",e);return{raIndex:s,decIndex:l,columns:e,positionFound:s>-1&&l>-1}}async getTableSummary(e){let s=new eL(e),l=await s.getColumns(),t=await s.getDataTypes();return(console.log(t),l)?{...this.getHeaderSummary(l),dataTypes:t}:void 0}getColDefs(e){let s=[eP],l={};if(e.cols.classification.enabled&&(s.push(eO),l["ai:class"]=void 0),e.table.selectedColumnsId)for(let l of e.table.selectedColumnsId){var t;let a=e.table.columns[l],n=null===(t=e.table.dataTypes)||void 0===t?void 0:t[l],i=e.grid.editable;s.push(ez(a,i,n))}if(e.cols.sdssCatalog.selectedColumns)for(let t of e.cols.sdssCatalog.selectedColumns)s.push(eF(t.table,t.column)),l["sdss:".concat(t.table,"_").concat(t.column)]=$;return e.cols.sdssSpectra.enabled&&(s.push(eA),l["img:sdss_spec"]=$),e.cols.splusPhotoSpectra.enabled&&(s.push(eU),l["img:splus_photospec"]=$),e.cols.legacyImaging.enabled&&(s.push(eR),l["img:legacy"]=$),e.cols.splusImaging.enabled&&(s.push(ek),l["img:splus"]=$),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((e,t,a)=>{s.push(eG(t)),l["img:custom_".concat(t)]=$}),{colDef:s,initVal:l}}}var eM=new eD;function eB(){let{tcState:e}=j(),[s,l]=(0,i.useState)(!1),t=()=>{let t={...e};t.grid.editable=!s;let{colDef:a}=eM.getColDefs(t);e.grid.api.setGridOption("columnDefs",a),l(!s)};return"grid"!=e.currentView?null:(0,n.jsx)(n.Fragment,{children:s?(0,n.jsxs)(I.Z,{size:"sm",variant:"success",className:"d-inline-flex align-items-center",onClick:t,children:[(0,n.jsx)(Y.zmo,{size:18,className:"me-1"}),(0,n.jsx)("span",{children:"Edit"})]}):(0,n.jsxs)(I.Z,{size:"sm",variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:t,children:[(0,n.jsx)(X.bt0,{size:18,className:"me-1"}),(0,n.jsx)("span",{children:"View"})]})})}var eV=l(8687);let eH="bg-white text-primary px-3 rounded-5",eq="rounded-5";function eK(){let{tcState:e,tcDispatch:s}=j(),l=e=>{s({type:a.CURRENT_VIEW_CHANGE,payload:e})};return(0,n.jsxs)(eV.Z,{className:"bg-primary rounded-5",children:[(0,n.jsx)(I.Z,{variant:"primary",className:"settings"==e.currentView?eH:eq,size:"sm",onClick:()=>l("settings"),children:"Setup"}),(0,n.jsx)(I.Z,{variant:"primary",className:"grid"==e.currentView?eH:eq,size:"sm",disabled:!e.grid.isLoaded,onClick:()=>l("grid"),children:"Table"}),(0,n.jsx)(I.Z,{variant:"primary",className:"plots"==e.currentView?eH:eq,size:"sm",disabled:!e.grid.isLoaded,onClick:()=>l("plots"),children:"Plots"})]})}var eW=l(1643);function eQ(){var e,s;let{tcState:l}=j();return(0,n.jsx)("div",{className:"text-muted",style:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"240px",whiteSpace:"nowrap"},children:null===(s=l.table)||void 0===s?void 0:null===(e=s.file)||void 0===e?void 0:e.name})}function eY(){let{tcState:e}=j();return(0,n.jsx)(C.Z,{bg:"light",expand:"lg",className:"p-1",children:(0,n.jsxs)(v.Z,{children:[(0,n.jsx)(eK,{}),(0,n.jsxs)(eW.Z,{direction:"horizontal",className:"mx-auto",children:[(0,n.jsx)(G,{}),(0,n.jsx)(eQ,{})]}),(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)(Q,{}),(0,n.jsx)(eB,{}),(0,n.jsx)(L,{})]})]})})}var eX=l(7142),eJ=l(7518),e$=l(7615),e0=l.n(e$);function e1(e){let{children:s,value:l=null,className:t="",onClose:a=()=>{},closeable:i=!0}=e;return(0,n.jsxs)("div",{className:"".concat(e0().chip," ").concat(t),children:[s,i&&(0,n.jsx)("span",{className:e0().closebtn,onClick:e=>{a(e,l)},children:"\xd7"})]})}var e2=l(9540);let e5=(e,s,l)=>{let t=e.trim();t&&!s.includes(t)&&(s.push(t),l({type:a.CLASSIFICATION_CONFIG,payload:{classNames:s}}))},e3=(e,s,l)=>{let t=s.filter(s=>s!=e);l({type:a.CLASSIFICATION_CONFIG,payload:{classNames:t}})};function e4(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.classification,[t,a]=(0,i.useState)(""),[o,r]=(0,i.useState)(!1);return(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"classNames",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:1,children:"Classes"}),(0,n.jsxs)(B.Z,{sm:8,children:[(0,n.jsx)(V.Z,{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),e5(t,l.classNames,s),a("")},children:(0,n.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(V.Z.Control,{placeholder:"Class name",value:t,onChange:e=>a(e.target.value)}),(0,n.jsxs)(I.Z,{variant:"primary",type:"submit",className:"d-inline-flex align-items-center",children:[(0,n.jsx)(D.poH,{size:20,className:"me-1"}),(0,n.jsx)("span",{children:"Add"})]})]}),(0,n.jsxs)(M,{title:"Class Name",className:"ms-1",children:["Type the class name and press ",(0,n.jsx)("kbd",{children:"ENTER"})," or click Add button"]}),(0,n.jsxs)(I.Z,{style:{whiteSpace:"nowrap"},className:"ms-4",variant:"outline-primary",disabled:0==e.cols.classification.classNames.length,onClick:()=>r(!0),children:[(0,n.jsx)(e2.P2_,{size:20,className:"me-1"})," Hotkeys"]}),(0,n.jsx)(M,{title:"Hotkeys",className:"ms-1",children:"Classify your table quickly by configuring keyboard keys to select classes"}),(0,n.jsx)(e8,{show:o,onHide:()=>r(!1)})]})}),l.classNames.map(t=>(0,n.jsxs)(e1,{className:"mb-1 me-1",onClose:()=>e3(t,l.classNames,s),children:[t,t in e.cols.classification.keyMap&&(0,n.jsxs)("span",{children:[" (",(0,n.jsx)("b",{children:e.cols.classification.keyMap[t].toUpperCase()}),")"]})]},"cname_".concat(t)))]})]})}function e8(e){let{show:s,onHide:l}=e,{tcState:t,tcDispatch:o}=j(),r=t.cols.classification,[c,d]=(0,i.useState)(-1),u=(0,i.useCallback)(e=>{e.stopPropagation(),/^[\w\d]$/i.test(e.key)&&-1!=c&&o({type:a.CLASSIFICATION_CONFIG,payload:{keyMap:{...t.cols.classification.keyMap,[c]:e.key}}})},[o,t,c]);return(0,i.useEffect)(()=>(s?document.addEventListener("keydown",u,!0):document.removeEventListener("keydown",u,!0),()=>{document.removeEventListener("keydown",u,!0)}),[u,s]),(0,n.jsxs)(N.Z,{show:s,onHide:l,animation:!1,centered:!0,children:[(0,n.jsx)(N.Z.Header,{closeButton:!0,children:(0,n.jsx)(N.Z.Title,{id:"contained-modal-title-vcenter",children:"Hotkeys configuration"})}),(0,n.jsxs)(N.Z.Body,{children:[(0,n.jsx)("p",{className:"mb-3",children:"Select a class below and press an alphanumeric (A-Z, 0-9) character on the keyboard. After associating the keyboard shortcuts for the desired classes, just click on the table row and press the key referring to the class."}),(0,n.jsxs)(V.Z,{onSubmit:e=>e.preventDefault(),children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-3",controlId:"hotkeyClass",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:2,children:"Class"}),(0,n.jsx)(B.Z,{sm:10,children:(0,n.jsxs)(V.Z.Select,{value:c,onChange:e=>d(e.target.value),children:[(0,n.jsx)("option",{value:-1,children:"Select a class"}),r.classNames.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})})]}),(0,n.jsxs)(q.Z,{className:"d-inline-flex align-items-center",children:[(0,n.jsx)(B.Z,{sm:2,children:"Hotkey"}),(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsx)(V.Z.Control,{readOnly:!0,type:"text",size:"lg",value:r.keyMap[c]?r.keyMap[c].toUpperCase():"",style:{fontWeight:800,textAlign:"center"}})}),(0,n.jsx)(B.Z,{children:(0,n.jsx)(I.Z,{className:"ps-0",variant:"link",onClick:()=>{let e=t.cols.classification.keyMap;c in e&&(delete e[c],o({type:a.CLASSIFICATION_CONFIG,payload:{keyMap:e}}))},children:"Clear"})})]})]})]})]})}function e6(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.classification;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"classCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show classification column",checked:l.enabled,onChange:e=>s({type:a.CLASSIFICATION_CONFIG,payload:{enabled:e.target.checked}})}),(0,n.jsx)(M,{title:"Enable Classifications",className:"ms-1",children:"Select this option if you want to classify the table, unsect to hide the classification column"})]})})]}),(0,n.jsx)(e4,{})]})}let e9=["iso","aper3","aper6","auto","petro","pstotal"];function e7(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.sdssSpectra,t=e.cols.splusPhotoSpectra.selectedLines,i=(e,l)=>{l.includes(e)?s({type:a.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:l.filter(s=>s!=e)}}):s({type:a.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:[...l,e]}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"sloanSpecCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:3,className:"text-end",children:"SDSS spectra"}),(0,n.jsx)(B.Z,{sm:9,className:"d-flex align-items-center",children:(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show SDSS spectra column",checked:l.enabled,onChange:e=>s({type:a.SDSS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsx)("hr",{className:"my-4"}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:3,className:"text-end",children:"S-PLUS photo-spectra"}),(0,n.jsx)(B.Z,{sm:9,className:"d-flex align-items-center",children:(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show S-PLUS photo-spectra column",checked:e.cols.splusPhotoSpectra.enabled,onChange:()=>s({type:a.SPLUS_PHOTO_SPECTRA,payload:{enabled:!e.cols.splusPhotoSpectra.enabled}})})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:3,className:"text-end",children:"Selected lines"}),(0,n.jsx)(B.Z,{sm:9,className:"d-flex align-items-center",children:e9.map(e=>(0,n.jsxs)(V.Z.Check,{inline:!0,type:"checkbox",id:"splus-photospectra-line-".concat(e),className:"me-3",children:[(0,n.jsx)(V.Z.Check.Input,{type:"checkbox",checked:t.includes(e),onChange:()=>i(e,t)}),(0,n.jsx)(V.Z.Check.Label,{children:e})]},e))})]})]})}function se(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.legacyImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"legacyImagingCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show Legacy Survey RGB images column",checked:l.enabled,onChange:e=>s({type:a.LEGACY_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsxs)(q.Z,{className:"mb-3",children:[(0,n.jsx)(B.Z,{sm:5,children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{id:"legacyImagingPixScale",children:"Pixel scale"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"legacyImagingPixScale",value:l.pixelScale,onChange:e=>s({type:a.LEGACY_IMAGING,payload:{pixelScale:e.target.value}})}),(0,n.jsx)(H.Z.Text,{id:"legacyImagingPixScale2",children:"arcsec/pixel"})]})}),(0,n.jsx)(B.Z,{sm:4,className:"align-content-center",children:(0,n.jsxs)("div",{className:"d-flex",children:[(0,n.jsx)(V.Z.Check,{type:"switch",id:"auto-pix-scale",label:"Auto pixscale",className:"me-2",checked:l.autoPixelScale,onChange:e=>s({type:a.LEGACY_IMAGING,payload:{autoPixelScale:e.target.checked}})}),(0,n.jsx)(M,{title:"Add Columns",children:(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["When ",(0,n.jsx)("i",{children:"auto pixscale"})," is ",(0,n.jsx)("b",{children:"enabled"}),", AstroInspect will compute the pixscale for each object based on the",(0,n.jsx)("code",{children:"mag_r"})," and ",(0,n.jsx)("code",{children:"shape_r"})," values from the Legacy Survey catalogue. The specified value of pixscale will be used in cases where catalog values are not available."]}),(0,n.jsxs)("li",{children:["When ",(0,n.jsx)("i",{children:"auto pixscale"})," is ",(0,n.jsx)("b",{children:"disbled"}),", AstroInspect will only use the specified value of the pixscale."]})]})})]})})]}),(0,n.jsx)(q.Z,{children:(0,n.jsx)(B.Z,{sm:5,children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{children:"Data Release"}),(0,n.jsxs)(V.Z.Select,{value:l.dataRelease,onChange:e=>s({type:a.LEGACY_IMAGING,payload:{dataRelease:e.target.value}}),children:[(0,n.jsx)("option",{value:"10",children:"10"}),(0,n.jsx)("option",{value:"9",children:"9"})]})]})})})]})}var ss=l(1549),sl=l.n(ss);function st(e){let{children:s,className:l="btn-light",onClick:t=()=>{}}=e;return(0,n.jsx)("div",{className:"".concat(sl().chip," ").concat(l),onClick:t,children:s})}let sa=["U","F378","F395","F410","F430","G","F515","R","F660","I","F861","Z"];function sn(e){let{band:s,channel:l,variant:t}=e,{tcState:i,tcDispatch:o}=j(),r=i.cols.splusImaging.trilogyConfig,{R:c,G:d,B:u}=r,m=r[l].includes(s)?"btn-".concat(t):"btn-outline-".concat(t);return(0,n.jsx)(st,{className:"".concat(m," me-1"),onClick:()=>o({type:a.SPLUS_TRILOGY_CONFIG,payload:function(e,s,l){let t={...e};for(let a in e)a!=s&&(t[a]=e[a].filter(e=>e!=l));return t[s].includes(l)?t[s]=t[s].filter(e=>e!=l):t[s].push(l),t}({R:c,G:d,B:u},l,s)}),children:s})}function si(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging.trilogyConfig;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusTrilogyR",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"R"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[sa.map(e=>(0,n.jsx)(sn,{band:e,channel:"R",variant:"danger"},"R_".concat(e))),(0,n.jsxs)(M,{title:"Red Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-danger",children:"red"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusTrilogyG",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"G"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[sa.map(e=>(0,n.jsx)(sn,{band:e,channel:"G",variant:"success"},"G_".concat(e))),(0,n.jsxs)(M,{title:"Green Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-success",children:"green"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusTrilogyB",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"B"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[sa.map(e=>(0,n.jsx)(sn,{band:e,channel:"B",variant:"primary"},"B_".concat(e))),(0,n.jsxs)(M,{title:"Blue Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,n.jsx)("span",{className:"text-primary",children:"blue"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusTrilogyParams",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Params"}),(0,n.jsx)(B.Z,{sm:9,children:(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{className:"mb-3",children:[(0,n.jsx)(H.Z.Text,{id:"trilogy-param-noise",children:"Noise"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Noise","aria-describedby":"trilogy-param-noise",value:l.noise,onChange:e=>s({type:a.SPLUS_TRILOGY_CONFIG,payload:{noise:e.target.value}})})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{className:"mb-3",children:[(0,n.jsx)(H.Z.Text,{id:"trilogy-param-q",children:"Q"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Q","aria-describedby":"trilogy-param-q",value:l.Q,onChange:e=>s({type:a.SPLUS_TRILOGY_CONFIG,payload:{Q:e.target.value}})})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{className:"mb-3",children:[(0,n.jsx)(H.Z.Text,{id:"pixelScale",children:"Pixel scale"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Pixel scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:a.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function so(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging.luptonConfig;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusLuptonColors",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",children:"Colors"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{children:"R"}),(0,n.jsx)(V.Z.Select,{value:l.R,onChange:e=>s({type:a.SPLUS_LUPTON_CONFIG,payload:{R:e.target.value}}),children:sa.map(e=>(0,n.jsx)("option",{children:e},e))})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{children:"G"}),(0,n.jsx)(V.Z.Select,{value:l.G,onChange:e=>s({type:a.SPLUS_LUPTON_CONFIG,payload:{G:e.target.value}}),children:sa.map(e=>(0,n.jsx)("option",{children:e},e))})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{children:"B"}),(0,n.jsx)(V.Z.Select,{value:l.B,onChange:e=>s({type:a.SPLUS_LUPTON_CONFIG,payload:{B:e.target.value}}),children:sa.map(e=>(0,n.jsx)("option",{children:e},e))})]})})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusLuptonParams",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{id:"lupton-param-noise",children:"Stretch"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Stretch","aria-describedby":"lupton-param-noise",value:l.stretch,onChange:e=>s({type:a.SPLUS_LUPTON_CONFIG,payload:{stretch:e.target.value}})})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{children:[(0,n.jsx)(H.Z.Text,{id:"lupton-param-q",children:"Q"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Q","aria-describedby":"lupton-param-q",value:l.Q,onChange:e=>s({type:a.SPLUS_LUPTON_CONFIG,payload:{Q:e.target.value}})})]})}),(0,n.jsx)(B.Z,{children:(0,n.jsxs)(H.Z,{className:"mb-3",children:[(0,n.jsx)(H.Z.Text,{id:"pixelScale",children:"Pixel Scale"}),(0,n.jsx)(V.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:a.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function sr(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.splusImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"splusImagingCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Enable"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show S-PLUS RGB images column",checked:l.enabled,onChange:e=>s({type:a.SPLUS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"classCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Type"}),(0,n.jsx)(B.Z,{sm:5,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(V.Z.Select,{defaultValue:l.type,onChange:e=>s({type:a.SPLUS_IMAGING,payload:{type:e.target.value}}),children:[(0,n.jsx)("option",{value:"trilogy",children:"Trilogy"}),(0,n.jsx)("option",{value:"lupton",children:"Lupton"})]}),(0,n.jsxs)(M,{title:"Image Type",className:"ms-1",children:["The algorithm used to make RGB stamps from the FITS file",(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Trilogy: "})," The Trilogy algorithm",(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Lupton: "})," The Lupton method"]})]})})]}),"trilogy"==l.type?(0,n.jsx)(si,{}):(0,n.jsx)(so,{})]})}let sc=new(l(4146)).Z,sd={on:(e,s)=>sc.on(e,s),once:(e,s)=>sc.once(e,s),off:(e,s)=>sc.off(e,s),emit:(e,s)=>sc.emit(e,s),count:e=>sc.listenerCount(e)};Object.freeze(sd);var su=l(5099),sm=l(4304),sh=l(8582);function sp(e){let{onChange:s}=e,{tcState:l}=j(),t=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(l.table.file&&t.current){let e=new DataTransfer;e.items.add(l.table.file);let s=e.files;t.current.files=s}},[l.table.file]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"tableFile",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Table"}),(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(V.Z.Control,{type:"file",onChange:s,ref:t}),(0,n.jsxs)(M,{title:"Local Upload",className:"ms-1",children:["Load a table available in local computer. The only required columns are ",(0,n.jsx)("code",{children:"RA"})," and ",(0,n.jsx)("code",{children:"DEC"})," in degrees.",(0,n.jsx)("br",{}),(0,n.jsx)("u",{children:"Available formars"}),": ",(0,n.jsx)("code",{children:"CSV"}),", ",(0,n.jsx)("code",{children:"TSV"}),", \xa0",(0,n.jsx)("code",{children:"DAT"}),", ",(0,n.jsx)("code",{children:"PARQUET"}),"."]})]})})]})})}function sx(e){let{onChange:s}=e,{tcState:l}=j();return(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"tableFile",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"URL"}),(0,n.jsx)(B.Z,{sm:10,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsx)(V.Z.Control,{placeholder:"File URL",onChange:s,value:l.table.url||""}),(0,n.jsxs)(M,{title:"Remote Upload",className:"ms-1",children:["Loads a table available remotely in the internet.",(0,n.jsx)("br",{}),(0,n.jsx)("u",{children:"Available formars"}),": ",(0,n.jsx)("code",{children:"CSV"}),", ",(0,n.jsx)("code",{children:"TSV"}),", \xa0",(0,n.jsx)("code",{children:"DAT"}),", ",(0,n.jsx)("code",{children:"PARQUET"}),"."]})]})})]})}let sg=e=>{let{state:s}=e;return"loading"==s?(0,n.jsx)("p",{className:"text-secondary",children:"Loading table..."}):"success"==s?(0,n.jsxs)("p",{className:"text-success",children:[(0,n.jsx)(sh.dZ6,{})," RA and DEC columns successfully detected"]}):"positionNotFound"==s?(0,n.jsxs)("p",{className:"text-danger",children:[(0,n.jsx)(sh.apv,{})," RA or DEC columns not detected"]}):"error"==s?(0,n.jsxs)("p",{className:"text-danger",children:[(0,n.jsx)(sh.apv,{})," Failed to load this table, check if it's a valid csv file"]}):null},sj=()=>{let{tcState:e,tcDispatch:s}=j(),l=e=>{s({type:a.USER_FILE_INPUT,payload:{type:e.target.value}})};return(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"tableSourceSelector",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Source"}),(0,n.jsx)(B.Z,{sm:"5",children:(0,n.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,n.jsx)(V.Z.Check,{inline:!0,checked:"local"===e.table.type,label:"local",name:"tableType",type:"radio",value:"local",id:"tableType-1",onChange:l}),(0,n.jsx)(V.Z.Check,{inline:!0,checked:"remote"===e.table.type,className:"ms-2",label:"remote",name:"tableType",type:"radio",value:"remote",id:"tableType-2",onChange:l}),(0,n.jsxs)(M,{title:"Upload Type",children:["Select upload type based on where the source table is stored.",(0,n.jsx)("br",{}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Local: "})," Table stored in local computer",(0,n.jsx)("br",{})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Remote: "})," Table available in internet"]})]})]})]})})]})};function sy(e){let{colName:s,colId:l}=e,{tcState:t,tcDispatch:i}=j(),o=t.table.selectedColumnsId.includes(l)?"btn-primary":"btn-outline-primary";return(0,n.jsx)(st,{className:"".concat(o," me-2 mt-1"),onClick:()=>{let e=[];if(t.table.selectedColumnsId.includes(l)){let s=t.table.selectedColumnsId.indexOf(l);(e=[...t.table.selectedColumnsId]).splice(s,1)}else e=[...t.table.selectedColumnsId,l];i({type:a.USER_FILE_INPUT,payload:{selectedColumnsId:e}})},children:s})}function sf(){let{tcState:e,tcDispatch:s}=j(),l=(0,i.useCallback)(l=>{if(l.target.files.length>0){let t=l.target.files[0];s({type:a.USER_FILE_INPUT,payload:{status:"loading"}}),eM.getTableSummary(t).then(l=>{if(console.log("positionFound",null==l?void 0:l.positionFound),null==l?void 0:l.positionFound){var n,i,o;let r="local"===e.table.type&&(t.name===(null===(n=e.table.file)||void 0===n?void 0:n.name)||t.size===(null===(i=e.table.file)||void 0===i?void 0:i.size)||t.lastModified===(null===(o=e.table.file)||void 0===o?void 0:o.lastModified));r||s({type:a.GRID_UPDATE,payload:{data:[],colDefs:[]}}),s({type:a.USER_FILE_INPUT,payload:{type:"local",columns:l.columns,selectedColumnsId:[l.raIndex,l.decIndex],raIndex:l.raIndex,decIndex:l.decIndex,dataTypes:l.dataTypes,status:"success",file:t,isSameFile:r}}),(0,sm.B)("load_file_local",{category:"load",label:"local",userId:su.I})}else s({type:a.USER_FILE_INPUT,payload:{status:"positionNotFound"}})}).catch(e=>{console.log(e),s({type:a.USER_FILE_INPUT,payload:{status:"error"}})})}},[e,s]),t=(0,i.useCallback)(function(l){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l.length>0&&(s({type:a.USER_FILE_INPUT,payload:{status:"loading"}}),eM.getTableSummary(l).then(n=>{if(null==n?void 0:n.positionFound){let i="remote"===e.table.type&&l==e.table.url;i||s({type:a.GRID_UPDATE,payload:{data:[],colDefs:[]}}),s({type:a.USER_FILE_INPUT,payload:{type:"remote",columns:n.columns,selectedColumnsId:[n.raIndex,n.decIndex],raIndex:n.raIndex,decIndex:n.decIndex,dataTypes:n.dataTypes,status:"success",url:l,isSameFile:i}}),t&&s({type:a.CURRENT_VIEW_CHANGE,payload:"grid"}),(0,sm.B)("load_file_remote",{category:"load",label:"remote",userId:su.I})}else s({type:a.USER_FILE_INPUT,payload:{status:"positionNotFound"}})}).catch(e=>{s({type:a.USER_FILE_INPUT,payload:{status:"error"}})}))},[s,e]);return(0,i.useEffect)(()=>{sd.on("INSERT_URL",e=>t(e.url,!0)),(0,sm.B)("load_file_example",{category:"load",label:"example",userId:su.I})},[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sj,{}),"local"==e.table.type?(0,n.jsx)(sp,{onChange:l}):(0,n.jsx)(sx,{onChange:e=>t(e.target.value)}),(0,n.jsx)(sg,{state:e.table.state}),e.table.columns&&e.table.columns.length>0&&(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"tableSourceSelector",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",className:"text-end",children:"Columns"}),(0,n.jsx)(B.Z,{sm:"11",children:(0,n.jsxs)("div",{style:{maxHeight:250,overflow:"auto"},children:[e.table.columns.map((e,s)=>(0,n.jsx)(sy,{colId:s,colName:e},s)),(0,n.jsx)(M,{title:"Add Columns",children:"Select columns from input table to include."})]})})]})]})}var sb=l(3236),sv=l(9800);class sC{callFunction(e){for(var s=arguments.length,l=Array(s>1?s-1:0),t=1;t<s;t++)l[t-1]=arguments[t];return new Promise((s,t)=>{this.currentRequests.push({resolve:s,reject:t,fnToCall:e,args:l}),this.tryNext()})}tryNext(){if(this.runningRequests<this.maxConcurrentRequests){let e=this.currentRequests.shift();if(e){this.runningRequests++;let s=e.args;e.fnToCall.apply(null,s).then(s=>e.resolve(s)).catch(s=>e.reject(s)).finally(()=>{this.runningRequests--,this.tryNext()})}}}clear(){this.currentRequests=[]}constructor(e=1){this.currentRequests=[],this.runningRequests=0,this.maxConcurrentRequests=e}}class sS{create(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e in this.pool||(this.pool[e]=new sC(s))}enqueue(e,s){for(var l=arguments.length,t=Array(l>2?l-2:0),a=2;a<l;a++)t[a-2]=arguments[a];return this.pool[e].callFunction(s,...t)}getSignal(){return this.controller.signal}clear(e){if(e)this.pool[e].clear();else for(let e in this.pool)this.pool[e].clear()}constructor(){this.pool={},this.controller=new AbortController}}let sI=new sS;var sN=l(7066),sZ=l(4400),sT=l.n(sZ),s_=l(6772);async function sw(e){try{let s=await e();return{statusCode:s.status,error:!1,data:s.data}}catch(e){return{error:!0,statusCode:null==e?void 0:e.status,data:void 0}}}sI.create("sdss_cone_spec",4),sI.create("sdss_sql",2),sI.create("sdss_batch_query",2),sI.create("sdss_query",2);let sE=new s_.S({defaultOptions:{queries:{staleTime:P(1,"day","ms")}}});class sL{getQuery(e,s,l,t){return"SELECT p.fiber2Mag_z ".concat(t.map(e=>"t.".concat(e)).join(","),"\n    FROM PhotoObj p, dbo.fGetNearbyObjEq(326.8952189, 0.7732093, 0.02) n\n    WHERE p.objID = n.objID")}getCrossIdQuery(e,s){let l="photo"==this.objType?"objID":"specObjID";return"\n    SELECT \n      ".concat(s.map(e=>"t.".concat(e)).join(","),"\n    FROM #upload u\n      JOIN #x x ON x.up_id = u.up_id\n      JOIN ").concat(e," t ON t.").concat(this.pkColumn||l," = x.").concat(l,"\n    ORDER by x.up_id\n    ").trim()}constructor(e){let{objType:s="photo",raColumn:l="ra",decColumn:t="dec",pkColumn:a=null}=e||{};this.raColumn=l,this.decColumn=t,this.pkColumn=a,this.objType=s}}let sP={PhotoTag:{searchStrategy:new sL,type:"view"},SpecObjAll:{searchStrategy:new sL({objType:"spectro"}),type:"table"},emissionLinesPort:{searchStrategy:new sL({objType:"spectro"}),type:"table"},TwoMass:{searchStrategy:new sL,type:"table"},zooSpec:{searchStrategy:new sL,type:"table"},zooNoSpec:{searchStrategy:new sL,type:"table"},zoo2MainSpecZ:{searchStrategy:new sL({pkColumn:"dr8objid"}),type:"table"}};class sO{async getObjSpecId(e,s){try{return(await sE.fetchQuery({queryKey:["sdss-service-specid",e,s],queryFn:()=>sN.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SpectroQuery/ConeSpectro",{params:{ra:e,dec:s,radius:.01667,limit:1,format:"xml",specparams:"specObjID",imgparams:"none",zWarning:"on"},signal:sI.getSignal(),transformResponse:e=>{let s=new DOMParser().parseFromString(e,"application/xml").querySelector('Table[name="Table1"] > Row > Item[name="specObjID"]');return null==s?void 0:s.textContent}})})).data}catch(e){console.log(e)}}async getTables(){return Object.keys(sP)}async getColumns(e){var s,l;let t;t="table"==sP[e].type?"SELECT name, description, unit \n      FROM DBColumns \n      WHERE tablename='".concat(e,"'"):"\n      SELECT tc.name name, tc.description description, tc.unit unit\n      FROM DBColumns tc\n      INNER JOIN DBViewCols vc ON vc.parent = tc.tablename AND vc.name = tc.name\n      WHERE vc.viewname='".concat(e,"' \n      ").trim();let a="".concat("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/SqlSearch","?cmd=").concat(encodeURIComponent(t),"&format=json");return null===(l=(await sE.fetchQuery({queryKey:["sdss-service-columns",e],queryFn:()=>sN.Z.get(a)})).data)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.Rows}getCsv(e){return"index,ra,dec\r\n"+(e.map(e=>"".concat(e.index,",").concat(e.ra,",").concat(e.dec)).join("\r\n")||"")}}class sk extends sO{async fetch(){let e=await this.getObjSpecId(this.ra,this.dec);if(e)return{data:"".concat("https://skyserver.sdss.org/dr18/en/get/SpecById.ashx","?id=").concat(e)}}constructor(e,s){super(),this.ra=e,this.dec=s}}class sR extends sO{async fetch(){let e=sP[this.table].searchStrategy,s=e.getCrossIdQuery(this.table,[this.column]);return await sE.fetchQuery({queryKey:["sdss-query",this.ra,this.dec,this.table,this.column],queryFn:()=>sw(()=>sN.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/CrossIdSearch",{params:{searchtool:"CrossID",searchType:e.objType,photoScope:"nearPrim",spectroScope:"nearPrim",photoUpType:"ra-dec",spectroUpType:"ra-dec",radius:.016667,firstcol:1,paste:this.getCsv([{index:0,ra:this.ra,dec:this.dec}]),uquery:s,format:"JSON"},transformResponse:e=>{var s;let l=sT()({storeAsString:!0}).parse(e).find(e=>"Table1"==e.TableName).Rows;if(l.length>0)return null===(s=l[0])||void 0===s?void 0:s[this.column]}}))})}constructor(e,s,l,t){super(),this.ra=e,this.dec=s,this.table=l,this.column=t}}var sA=l(9282);let sU=e=>{let{items:s,active:l,onClick:t,height:a,className:i}=e;return(0,n.jsx)(eJ.Z,{className:"".concat(i," overflow-auto"),style:{height:a},children:s.map((e,s)=>(0,n.jsx)(eJ.Z.Item,{action:!0,active:l==e,onClick:l=>t({title:e,index:s,event:l}),children:e},s))})},sG=e=>{let{items:s,active:l,onClick:t,height:a,className:i}=e;return(0,n.jsx)(eJ.Z,{className:"".concat(i," overflow-auto"),style:{height:a},children:s.map((e,s)=>(0,n.jsx)(eJ.Z.Item,{action:!0,variant:l&&l.includes(e)?"primary":"",onClick:l=>t({title:e,index:s,event:l}),children:e},s))})},sF=e=>{let{className:s,height:l}=e;return(0,n.jsxs)(eJ.Z,{className:"".concat(s," overflow-auto"),style:{height:l},children:[(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:6})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:9})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:4})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:5})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:11})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:7})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:8})}),(0,n.jsx)(sA.Z,{as:eJ.Z.Item,animation:"glow",children:(0,n.jsx)(sA.Z,{xs:5})})]})};function sz(e){let{items:s=[],active:l=[],multiple:t=!1,placeholder:a=!1,onClick:i=()=>{},height:o=260,className:r=""}=e;return(0,n.jsx)(n.Fragment,{children:a?(0,n.jsx)(sF,{className:r,height:o}):t?(0,n.jsx)(sG,{items:s,active:l,onClick:i,height:o,className:r}):(0,n.jsx)(sU,{items:s,active:l,onClick:i,height:o,className:r})})}var sD=l(4908),sM=l.n(sD);function sB(e){let{initialSelectedTable:s="",service:l,selectedColumns:t=[],onAddColumn:a,onRemoveColumn:o}=e,[r,c]=(0,i.useState)(s),[d,u]=(0,i.useState)(""),[m,h]=(0,i.useState)([]),[p,x]=(0,i.useState)(void 0),[g,j]=(0,i.useState)(!0),y=(0,i.useMemo)(()=>sM()(t.map(e=>e.table)),[t]);(0,i.useEffect)(()=>{r&&(j(!0),l.getColumns(r).then(e=>{h(e),j(!1)}).catch(console.log))},[r,l]),(0,i.useEffect)(()=>{l.getTables().then(e=>{x(e),j(!1),e.length>0&&c(e[0])}).catch(console.log)},[l]);let f=(0,i.useMemo)(()=>null==m?void 0:m.map(e=>e.name),[m])||[],b=(0,i.useMemo)(()=>null==m?void 0:m.find(e=>e.name==d),[m,d]),v=(0,i.useMemo)(()=>t.findIndex(e=>e.column==d&&e.table==r)>-1,[t,d,r]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(q.Z,{children:[(0,n.jsxs)(B.Z,{sm:5,children:[(0,n.jsxs)(q.Z,{className:"align-items-center",children:[(0,n.jsx)(B.Z,{lg:2,children:(0,n.jsx)("span",{className:"text-muted fw-bold",children:"Table:"})}),(0,n.jsx)(B.Z,{children:(0,n.jsx)(V.Z.Select,{defaultValue:r,onChange:e=>{j(!0),u(""),c(e.target.value)},children:p&&p.map(e=>(0,n.jsx)("option",{value:e,children:e},e))})})]}),(0,n.jsx)(sz,{placeholder:g,items:f,active:d,className:"mt-2",height:290,onClick:e=>{let{title:s}=e;return u(s)}})]}),g?(0,n.jsxs)(B.Z,{children:[(0,n.jsx)(sv.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,n.jsxs)("span",{className:"text-muted",children:["Loading columns of the ",(0,n.jsx)("u",{children:r})," table"]})]}):(0,n.jsxs)(B.Z,{children:[b&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("b",{children:[b.name,":"]}),"\xa0",b.description,".\xa0",b.unit&&(0,n.jsxs)(n.Fragment,{children:["Unit: ",(0,n.jsx)("i",{dangerouslySetInnerHTML:{__html:b.unit}})]})]}),(0,n.jsx)("div",{children:v?(0,n.jsxs)(I.Z,{variant:"outline-danger",size:"sm",onClick:()=>o(r,d),children:[(0,n.jsx)(sh.HeX,{})," Remove Selected Column"]}):(0,n.jsxs)(I.Z,{variant:"outline-success",size:"sm",onClick:()=>a(r,d),children:[(0,n.jsx)(D.poH,{size:16})," Add Selected Column"]})})]}),t.length>0&&(0,n.jsx)("div",{className:"mt-4",children:y.map(e=>(0,n.jsxs)("div",{className:"mb-1",children:[(0,n.jsxs)("span",{className:"me-2 fw-bold text-muted",children:[e,":"]}),t.filter(s=>s.table==e).map(e=>(0,n.jsx)(e1,{className:"mb-1 me-1",onClose:()=>o(e.table,e.column),children:e.column},e.column))]},e))})]})]})})}let sV=new sO;function sH(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.sdssCatalog.selectedColumns;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(sB,{onAddColumn:(e,t)=>{e&&t&&s({type:a.SDSS_CATALOG,payload:{selectedColumns:[...l,{table:e,column:t}]}})},onRemoveColumn:(e,t)=>{if(!e||!t)return;let n=l.findIndex(s=>s.column==t&&s.table==e);s({type:a.SDSS_CATALOG,payload:{selectedColumns:l.filter((e,s)=>s!=n)}})},selectedColumns:l,service:sV})})}let sq=e=>{var s,l;let{index:t}=e,{tcState:i,tcDispatch:o}=j(),r=i.cols.customImaging.columns[t];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(H.Z,{className:"mb-2",size:"sm",children:[(0,n.jsx)(H.Z.Text,{children:"Base URL"}),(0,n.jsx)(V.Z.Control,{value:r.url,onChange:e=>o({type:a.CUSTOM_IMAGE_UPDATE,payload:{index:t,url:e.target.value}})})]}),(0,n.jsxs)(M,{title:"Base Resource URL",className:"mb-2 ms-1",children:["The ",(0,n.jsx)("b",{children:"base resource url"})," is the first (static) part of the URL. This value must starts with ",(0,n.jsx)("code",{children:"http://"})," ","or ",(0,n.jsx)("code",{children:"https://"}),(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})}),(0,n.jsx)(B.Z,{sm:4,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(H.Z,{size:"sm",children:[(0,n.jsx)(H.Z.Text,{children:"Suffix"}),(0,n.jsx)(V.Z.Control,{value:r.fileExtension,onChange:e=>o({type:a.CUSTOM_IMAGE_UPDATE,payload:{index:t,fileExtension:e.target.value}})})]}),(0,n.jsxs)(M,{title:"URL Suffix",className:"ms-1",children:["The ",(0,n.jsx)("b",{children:"url suffix"})," is the last (static) part of the URL and "," ","is used to specify the file extension, for example.",(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})})]}),(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{sm:8,children:(0,n.jsxs)("div",{className:"d-flex align-items-center",children:[(0,n.jsxs)(H.Z,{className:"",size:"sm",children:[(0,n.jsx)(H.Z.Text,{children:"RI column"}),(0,n.jsxs)(V.Z.Select,{defaultValue:(null===(l=i.cols.customImaging.columns)||void 0===l?void 0:null===(s=l[t])||void 0===s?void 0:s.columnIndex)||-1,onChange:e=>o({type:a.CUSTOM_IMAGE_UPDATE,payload:{index:t,columnIndex:parseInt(e.target.value)}}),children:[(0,n.jsx)("option",{value:-1,children:"Select a column"}),i.table.columns.map((e,s)=>(0,n.jsx)("option",{value:s,children:e},s))]})]}),(0,n.jsxs)(M,{title:"Resource Identification Column",className:" ms-1",children:["The ",(0,n.jsx)("b",{children:"resource identification column"})," (RI column) is the "," ","only variable part of the url. This field must specify the "," ","column to use to make a specific url for each row.",(0,n.jsx)("br",{}),"The final url for each row is:",(0,n.jsx)("br",{}),(0,n.jsx)("kbd",{children:"Base URL"})," + ",(0,n.jsx)("kbd",{children:"RI Column"})," + ",(0,n.jsx)("kbd",{children:"suffix"})]})]})}),(0,n.jsx)(B.Z,{sm:4,children:(0,n.jsxs)(I.Z,{variant:"outline-danger",size:"sm",onClick:()=>o({type:a.CUSTOM_IMAGE_REMOVE,payload:{index:t,prevColumns:i.cols.customImaging.columns}}),children:[(0,n.jsx)(sh.HeX,{})," Remove column"]})})]})]})};function sK(){let{tcState:e,tcDispatch:s}=j(),l=e.cols.customImaging;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-2",controlId:"customImagingCheck",children:[(0,n.jsx)(V.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,n.jsx)(B.Z,{sm:"11",className:"d-flex align-items-center",children:(0,n.jsx)(V.Z.Check,{type:"switch",label:"Show custom images columns",checked:l.enabled,onChange:e=>s({type:a.CUSTOM_IMAGE_ENABLE,payload:{enabled:e.target.checked}})})})]}),l.columns.map((e,s)=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)(sq,{index:s}),(0,n.jsx)("hr",{className:"my-4"})]},s)),(0,n.jsx)(q.Z,{children:(0,n.jsx)(B.Z,{children:(0,n.jsxs)(I.Z,{size:"sm",onClick:()=>s({type:a.CUSTOM_IMAGE_NEW,payload:{prevColumns:e.cols.customImaging.columns}}),children:[(0,n.jsx)(D.poH,{size:16})," Add custom image column"]})})})]})}var sW=l(1950),sQ=l(7405);let sY=e=>{let{name:s,url:l}=e,{tcDispatch:t}=j();return(0,n.jsx)(I.Z,{variant:"link",onClick:()=>{t({type:a.USER_FILE_INPUT,payload:{type:"remote",url:l}}),sd.emit("INSERT_URL",{url:l})},children:s})};function sX(){let{tcState:e,tcDispatch:s}=j();return(0,n.jsxs)(v.Z,{className:"mt-5",children:[(0,n.jsxs)("div",{className:"border rounded rounded-3 p-4",style:{backgroundColor:"#fafafa"},children:[(0,n.jsxs)("h6",{className:"text-center mb-4 d-flex align-items-center justify-content-center",children:[(0,n.jsx)(sQ.s7j,{className:"me-2",size:20}),(0,n.jsx)("span",{children:"Table Settings"})]}),(0,n.jsxs)(eX.Z.Container,{id:"list-group-tabs-example",defaultActiveKey:"#select-table",children:[(0,n.jsxs)(q.Z,{children:[(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsxs)(eJ.Z,{children:[(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#select-table",children:"Select a table"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#classification",children:"Classification"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#sdss",children:"SDSS catalog"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#splus",children:"S-PLUS images"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#legacy",children:"Legacy images"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#custom-images",children:"Custom images"}),(0,n.jsx)(eJ.Z.Item,{action:!0,href:"#spectra",children:"Spectra & photo-spectra"})]})}),(0,n.jsx)(B.Z,{sm:9,children:(0,n.jsxs)(eX.Z.Content,{children:[(0,n.jsx)(eX.Z.Pane,{eventKey:"#select-table",children:(0,n.jsx)(sf,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#classification",children:(0,n.jsx)(e6,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#sdss",children:(0,n.jsx)(sH,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#splus",children:(0,n.jsx)(sr,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#legacy",children:(0,n.jsx)(se,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#custom-images",children:(0,n.jsx)(sK,{})}),(0,n.jsx)(eX.Z.Pane,{eventKey:"#spectra",children:(0,n.jsx)(e7,{})})]})})]}),(0,n.jsx)(q.Z,{children:(0,n.jsx)(B.Z,{sm:3,className:"mx-auto",children:(0,n.jsx)(I.Z,{className:"mt-3 w-100 fw-bold",variant:"success",size:"lg",onClick:e=>{s({type:a.CURRENT_VIEW_CHANGE,payload:"grid"})},disabled:"success"!==e.table.status,children:"loading"===e.table.status?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sv.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"light"})," Loading"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sW.tcg,{className:"me-2",size:30})," Load Table"]})})})})]})]}),(0,n.jsxs)(q.Z,{className:"mt-5",children:[(0,n.jsx)(B.Z,{sm:7,children:(0,n.jsxs)(sb.Z,{variant:"info",children:[(0,n.jsx)(sb.Z.Heading,{children:"\uD83C\uDF89 New Version!"}),(0,n.jsx)("h6",{children:"Features of the software release v1.0:"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:["Add support to ",(0,n.jsx)("b",{children:"PARQUET"})," files"]}),(0,n.jsxs)("li",{children:["Handle ",(0,n.jsx)("b",{children:"big tables"})," (hundreds of thousands of rows)"]}),(0,n.jsxs)("li",{children:["Column relocation and row ",(0,n.jsx)("b",{children:"sorting and filtering"})]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("b",{children:"Faster loading"})," of resources with multiple parallel connections"]}),(0,n.jsxs)("li",{children:["Display of the ",(0,n.jsx)("b",{children:"loading status"})," of each external resource"]}),(0,n.jsx)("li",{children:"Support for remote files"})]})]})}),(0,n.jsx)(B.Z,{sm:5,children:(0,n.jsxs)(sb.Z,{variant:"success",children:[(0,n.jsx)(sb.Z.Heading,{children:"\uD83D\uDCA1 Examples"}),(0,n.jsx)("h6",{children:"Click on one of the links below to open an example table:"}),(0,n.jsxs)("ul",{children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(sY,{name:"galaxyzoo-small-sample.csv",url:"https://astroinspect.natanael.net/examples/galaxyzoo-small-sample.csv"}),"\xa0(250 rows, 11.5kB)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(sY,{name:"galaxyzoo-medium-sample.csv",url:"https://astroinspect.natanael.net/examples/galaxyzoo-medium-sample.csv"}),"\xa0(2,500 rows, 113.8kB)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)(sY,{name:"galaxyzoo-big-sample.parquet",url:"https://astroinspect.natanael.net/examples/galaxyzoo-big-sample.parquet"}),"\xa0(250,000 rows, 6.8MB)"]})]})]})})]})]})}let sJ=new s_.S({defaultOptions:{queries:{staleTime:P(1,"day","ms")}}});class s${async search(e,s,l){return(await sJ.fetchQuery({queryKey:["scs",e,s],queryFn:()=>sw(()=>sN.Z.get(this.url,{signal:sI.getSignal(),params:{ra:e,dec:s,sr:l},transformResponse:e=>{var s,l,t,a;let n=new DOMParser().parseFromString(e,"application/xml"),i=null===(s=n.querySelector('VOTABLE > RESOURCE > INFO[name="TableRows"]'))||void 0===s?void 0:s.getAttribute("value");if(i&&parseInt(i)>0){let e=n.querySelectorAll("VOTABLE > RESOURCE > TABLE > FIELD"),s=n.querySelector("VOTABLE > RESOURCE > TABLE > DATA > TABLEDATA > TR"),i=null==s?void 0:s.querySelectorAll("TD"),o={};for(let s=0;s<e.length;s++){let n=null===(l=e[s])||void 0===l?void 0:l.getAttribute("name"),r=null===(t=e[s])||void 0===t?void 0:t.getAttribute("datatype"),c=null==i?void 0:null===(a=i[s])||void 0===a?void 0:a.textContent;"float"===r||"double"===r?c=parseFloat(c):"int"===r&&(c=parseInt(c)),n&&(o[n]=c)}return o}}}))})).data}constructor(e){this.url=e}}var s0=l(2647);let s1=[0,8.5,9.5,10.5,11.5,12.5,13.5,14.5,15.5,16.5,17.5,18.5,19.5,100],s2=[11.5,11.5,6,5.9,5.3,4.5,3.95,3.45,4.2,4.8,7.1,5.6,1.5,1.5],s5=new s_.S({defaultOptions:{queries:{staleTime:P(1,"day","ms")}}});class s3{async computePixscale(){let e=new s$("https://bittersweet-large-ticket.glitch.me/https://datalab.noirlab.edu/scs/ls_dr10/tractor");try{let s=await e.search(this.ra,this.dec,1.5/3600),l=null==s?void 0:s.mag_r,t=null==s?void 0:s.shape_r;if(Number.isFinite(l)&&Number.isFinite(t)){let e=(0,s0.Z)(s1,s2,[l],"linear"),s=2*t*e[0]/this.size;return Math.max(Math.min(s,10),.12)}return}catch(e){console.log(e);return}}async fetch(){let e=this.pixscale;if(this.autoPixscale){let s=await this.computePixscale();void 0!=s&&null!=s&&(e=s)}return await s5.fetchQuery({queryKey:[this.ra,this.dec,this.size,e,this.layer],queryFn:()=>sw(()=>sN.Z.get("https://www.legacysurvey.org/viewer/cutout.jpg",{responseType:"blob",signal:sI.getSignal(),params:{ra:this.ra,dec:this.dec,size:this.size,pixscale:e,layer:this.layer}}))})}constructor(e,s,l,t,a=!0,n="ls-dr10"){this.ra=e,this.dec=s,this.layer=n,this.pixscale=t,this.autoPixscale=a,this.size=l}}l(6932);let s4=new s_.S({defaultOptions:{queries:{staleTime:P(12,"hour","ms")}}});sI.create("splus-flux-radius",1);class s8{getParams(){var e,s,l,t,a,n,i,o,r,c,d,u,m;return"trilogy"===this.type?{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(i=this.config)||void 0===i?void 0:null===(n=i.R)||void 0===n?void 0:n.join(","),g:null===(r=this.config)||void 0===r?void 0:null===(o=r.G)||void 0===o?void 0:o.join(","),b:null===(d=this.config)||void 0===d?void 0:null===(c=d.B)||void 0===c?void 0:c.join(","),noise:null===(u=this.config)||void 0===u?void 0:u.noise,q:null===(m=this.config)||void 0===m?void 0:m.Q}:{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(e=this.config)||void 0===e?void 0:e.R,g:null===(s=this.config)||void 0===s?void 0:s.G,b:null===(l=this.config)||void 0===l?void 0:l.B,stretch:null===(t=this.config)||void 0===t?void 0:t.stretch,q:null===(a=this.config)||void 0===a?void 0:a.Q}}getUrl(){return"trilogy"===this.type?"https://checker-melted-forsythia.glitch.me/trilogy.png":"https://checker-melted-forsythia.glitch.me/lupton.png"}async fetch(){return await s4.fetchQuery({queryKey:[this.ra,this.dec,this.stampSize,this.type,this.config],queryFn:()=>sw(()=>sN.Z.get(this.getUrl(),{responseType:"blob",signal:sI.getSignal(),params:this.getParams()}))})}constructor(e,s,l,t,a){this.ra=e,this.dec=s,this.pixscale=l,this.type=t,this.config=a,this.stampSize=Math.min(Math.round(300*this.pixscale/.55),1e3)}}class s6{async fetch(){return await s4.fetchQuery({queryKey:[this.ra,this.dec,this.lines],queryFn:()=>sw(()=>sN.Z.get("https://astrotools.vercel.app/plot",{responseType:"blob",signal:sI.getSignal(),params:{ra:this.ra,dec:this.dec,...this.lines.reduce((e,s)=>(e[s]="",e),{})}}))})}constructor(e,s,l){this.ra=e,this.dec=s,this.lines=l}}l(3809),l(7180);var s9=l(975),s7=l(361),le=l.n(s7),ls=l(4173);l(9422),sI.create("img:legacy",6),sI.create("img:splus",5),sI.create("img:splus_photospec",5),sI.create("img:sdss_spec",4),sI.create("sdss_cat",4);let ll=async e=>{let{resourceFetch:s,colId:l,rowId:t,grid:a,isImage:n=!0}=e,i=a.api.getRowNode(t);if(((null==i?void 0:i.data[l])===$||(null==i?void 0:i.data[l])===void 0)&&(null==i?void 0:i.data.hasOwnProperty(l)))try{null==i||i.setDataValue(l,ee);let e=await s.fetch();n?null==i||i.setDataValue(l,URL.createObjectURL(e.data)):null==i||i.setDataValue(l,e.data)}catch(e){null==i||i.setDataValue(l,es)}},lt=e=>{let{url:s,colId:l,rowId:t,grid:a}=e,n=a.api.getRowNode(t);if(((null==n?void 0:n.data[l])===$||(null==n?void 0:n.data[l])===void 0)&&(null==n?void 0:n.data.hasOwnProperty(l)))try{null==n||n.setDataValue(l,s)}catch(e){null==n||n.setDataValue(l,es)}};function la(){let{tcState:e,tcDispatch:s}=j(),[l,t]=(0,i.useState)(!0),o=(0,i.useRef)(null),r=(0,i.useCallback)(async l=>{var n;let i,o;e.table.isSameFile&&(null===(n=e.grid.currColConfigs)||void 0===n?void 0:n.classification.enabled)&&e.cols.classification.enabled&&(o=e.grid.data.map(e=>({"ai:class":e["ai:class"]}))),i="local"===e.table.type?await eM.load(e.table.file):await eM.load(e.table.url);let{colDef:r,initVal:c}=eM.getColDefs(e);i=null==i?void 0:i.map((e,s,l)=>({...e,...c,"ai:id":String(s+1)})),o&&(i=null==i?void 0:i.map((e,s,l)=>({...e,...o[s]}))),t(!1),s({type:a.GRID_UPDATE,payload:{data:i,colDef:r,isLoaded:!0,currColConfigs:le()(e.cols),currTable:{...e.table},api:l.api}}),s({type:a.USER_FILE_INPUT,payload:{isSameFile:!0}})},[e,s]),c=(0,i.useCallback)(s=>{let l=s.api.paginationGetPageSize(),t=s.api.paginationGetCurrentPage(),a=[];s.api.forEachNodeAfterFilterAndSort(e=>{a.push(e.data)});let n=t*l,i=a.slice(n,n+l+100),r=e.table.columns[e.table.raIndex],c=e.table.columns[e.table.decIndex];sI.clear(),i.forEach(s=>{let l=s["tab:".concat(r)],t=s["tab:".concat(c)],a=s["ai:id"];if(e.cols.legacyImaging.enabled&&sI.enqueue("img:legacy",ll,{resourceFetch:new s3(l,t,300,e.cols.legacyImaging.pixelScale,e.cols.legacyImaging.autoPixelScale),colId:"img:legacy",rowId:a,grid:o.current}),e.cols.splusImaging.enabled){let s="trilogy"===e.cols.splusImaging.type?e.cols.splusImaging.trilogyConfig:e.cols.splusImaging.luptonConfig;sI.enqueue("img:splus",ll,{resourceFetch:new s8(l,t,e.cols.splusImaging.pixelScale,e.cols.splusImaging.type,s),colId:"img:splus",rowId:a,grid:o.current})}e.cols.splusPhotoSpectra.enabled&&sI.enqueue("img:splus_photospec",ll,{resourceFetch:new s6(l,t,e.cols.splusPhotoSpectra.selectedLines),colId:"img:splus_photospec",rowId:a,grid:o.current}),e.cols.sdssSpectra.enabled&&sI.enqueue("img:sdss_spec",ll,{resourceFetch:new sk(l,t),colId:"img:sdss_spec",rowId:a,grid:o.current,isImage:!1}),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((l,t,n)=>{let i="tab:".concat(e.table.columns[l.columnIndex]);lt({url:"".concat(l.url).concat(s[i]||"").concat(l.fileExtension||""),colId:"img:custom_".concat(t),rowId:a,grid:o.current})}),e.cols.sdssCatalog.selectedColumns.forEach(e=>{sI.enqueue("sdss_cat",ll,{resourceFetch:new sR(l,t,e.table,e.column),colId:"sdss:".concat(e.table,"_").concat(e.column),rowId:a,grid:o.current,isImage:!1})})})},[e]),d=(0,i.useCallback)(s=>{let l=s.event;if(l){if("c"===l.key.toLowerCase()&&l.ctrlKey)navigator.clipboard.writeText(s.value),ls.Am.success("Copied: ".concat(s.value),{position:"bottom-center",autoClose:1e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!1,draggable:!1,progress:void 0,theme:"dark",delay:100});else if(e.cols.classification.enabled&&!l.altKey&&!l.ctrlKey&&!l.shiftKey)for(let[t,a]of Object.entries(e.cols.classification.keyMap))a.toLowerCase()==l.key.toLowerCase()&&s.node.setDataValue("ai:class",t)}},[e.cols.classification.enabled,e.cols.classification.keyMap]),u=(0,i.useCallback)(e=>e.data["ai:id"],[]),m=(0,i.useMemo)(()=>[50,100,200,400,600,800,1e3],[]),h={suppressHorizontalScroll:!1,multiSortKey:"ctrl"};(e.cols.splusImaging.enabled||e.cols.legacyImaging.enabled||e.cols.sdssSpectra.enabled||e.cols.splusPhotoSpectra.enabled||e.cols.customImaging.enabled&&e.cols.customImaging.columns.length>0)&&(h.rowHeight=120);let p=(0,i.useCallback)(s=>{if(s.data){var l;return null===(l=e.plots.filterIndex)||void 0===l?void 0:l.includes(s.sourceRowIndex)}return!0},[e.plots.filterIndex]);return(0,n.jsxs)(v.Z,{fluid:!0,className:"px-0",style:{height:"100%"},children:[(0,n.jsx)("div",{className:"ag-theme-quartz",style:{width:"100%",height:"100%","--ag-cell-horizontal-padding":"8px","--ag-borders":"solid 1px","--ag-wrapper-border-radius":"0px","--ag-header-height":"38px"},children:(0,n.jsx)(s9.s,{gridOptions:h,ref:o,rowData:e.grid.data||[],columnDefs:e.grid.colDef||[],getRowId:u,loading:l,style:{height:"100%"},pagination:!0,paginationPageSize:50,paginationPageSizeSelector:m,onGridReady:r,onPaginationChanged:c,onSortChanged:c,onFilterChanged:c,onCellKeyDown:d,singleClickEdit:!0,isExternalFilterPresent:()=>e.plots.inspectSelected,doesExternalFilterPass:p})}),(0,n.jsx)(ls.Ix,{})]})}var ln=l(356);function li(e){let{label:s,value:l="",dispatchKey:t,dispatchType:a}=e,{tcState:i,tcDispatch:o}=j();return(0,n.jsxs)(H.Z,{children:[s&&(0,n.jsx)(H.Z.Text,{children:s}),(0,n.jsxs)(V.Z.Select,{value:l,onChange:e=>{o({type:a,payload:{[t]:e.target.value}})},children:[(0,n.jsx)("option",{value:"",children:"-"}),i.table.columns.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]})}var lo=l(5152);let lr=l.n(lo)()(()=>Promise.all([l.e(960),l.e(660)]).then(l.bind(l,8660)),{loadableGenerated:{webpack:()=>[8660]},ssr:!1,loading:()=>(0,n.jsx)("span",{children:"loading"})});function lc(e){let s,l,t,a,n,i;return(s=e.slice().sort((e,s)=>e-s)).length/4%1==0?(l=.5*(s[s.length/4]+s[s.length/4+1]),t=.5*(s[s.length*(3/4)]+s[s.length*(3/4)+1])):(l=s[Math.floor(s.length/4+1)],t=s[Math.ceil(s.length*(3/4)+1)]),a=t-l,n=t+2.5*a,i=t-2.5*a,{q1:l,q3:t,iqr:a,maxValue:n,minValue:i}}function ld(e,s){if(e.length<4||s.length<4)return[e,s];let l=lc(e),t=lc(s),a=[];for(let n=0;n<e.length;n++){let i=e[n],o=s[n];i>=l.minValue&&i<=l.maxValue&&o>=t.minValue&&o<=t.maxValue&&a.push(n)}return[a.map(s=>e[s]),a.map(e=>s[e])]}function lu(){let{tcState:e,tcDispatch:s}=j(),l=e.plots.scatter,t=(0,i.useMemo)(()=>{var s,t,a;let n,i;let o,r=[];return""!=l.xColumn&&(o=null===(s=e.grid.data)||void 0===s?void 0:s.map(e=>e["tab:".concat(l.xColumn)])),""!=l.yColumn&&(r=null===(t=e.grid.data)||void 0===t?void 0:t.map(e=>e["tab:".concat(l.yColumn)])),""!=l.colorColumn&&(n=null===(a=e.grid.data)||void 0===a?void 0:a.map(e=>e["tab:".concat(l.colorColumn)]),i={orientation:"v"}),e.plots.color.filterOutliers&&o&&r&&o.length==r.length&&o.length>0&&([o,r]=ld(o,r)),[{x:o,y:r,mode:"markers",name:"points",marker:{color:n||"tab:blue",size:3,opacity:.7,colorbar:i},type:"scatter"},{x:o,name:"x density",marker:{color:"tab:blue"},yaxis:"y2",type:"histogram"},{y:r,name:"y density",marker:{color:"tab:blue"},xaxis:"x2",type:"histogram"}]},[e.grid.data,l.xColumn,l.yColumn,l.colorColumn,e.plots.color.filterOutliers]),o={showlegend:!1,autosize:!0,height:740,margin:{t:50},hovermode:"closest",bargap:0,uirevision:"true",xaxis:{domain:[0,.85],showgrid:!1,zeroline:!1,title:l.xColumn},yaxis:{domain:[0,.85],showgrid:!1,zeroline:!1,title:l.yColumn},xaxis2:{domain:[.85,1],showgrid:!1,zeroline:!1},yaxis2:{domain:[.85,1],showgrid:!1,zeroline:!1}};return(0,n.jsxs)("div",{className:"w-100",children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-3",controlId:"x-axis",children:[(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold",style:{wordBreak:"keep-all"},children:"x-axis:"}),(0,n.jsx)(li,{value:l.xColumn,dispatchKey:"xColumn",dispatchType:a.SCATTER_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold ms-lg-2",style:{wordBreak:"keep-all"},children:"y-axis:"}),(0,n.jsx)(li,{value:l.yColumn,dispatchKey:"yColumn",dispatchType:a.SCATTER_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold ms-lg-2",style:{wordBreak:"keep-all"},children:"color:"}),(0,n.jsx)(li,{value:l.colorColumn,dispatchKey:"colorColumn",dispatchType:a.SCATTER_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:3,className:"align-content-center",children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:3,children:[(0,n.jsx)(V.Z.Check,{type:"switch",id:"filter-outliers",label:"Filter outliers",checked:e.plots.scatter.filterOutliers,onChange:e=>s({type:a.SCATTER_PLOT_SETUP,payload:{filterOutliers:e.target.checked}})}),(0,n.jsx)(I.Z,{disabled:0==e.plots.filterIndex.length||"scatter"!=e.plots.filterView,onClick:()=>{s({type:a.PLOT_SETUP,payload:{inspectSelected:!0}}),s({type:a.CURRENT_VIEW_CHANGE,payload:"grid"})},children:"Inspect Selected"})]})})]}),(0,n.jsx)(lr,{data:t,layout:o,config:{responsive:!0},className:"w-100",onSelected:e=>{var l,t;let n=null==e?void 0:null===(l=e.points)||void 0===l?void 0:l.map(e=>e.pointIndex);n&&n.length>0&&s({type:a.PLOT_SETUP,payload:{filterIndex:null==e?void 0:null===(t=e.points)||void 0===t?void 0:t.map(e=>e.pointIndex),filterView:"scatter"}})}})]})}function lm(){let{tcState:e,tcDispatch:s}=j(),l=e.plots.color,t=(0,i.useMemo)(()=>{var s,t;let a,n=[];return""!=l.xColumn1&&""!=l.xColumn2&&(a=null===(s=e.grid.data)||void 0===s?void 0:s.map(e=>e["tab:".concat(l.xColumn1)]-e["tab:".concat(l.xColumn2)])),""!=l.yColumn1&&""!=l.yColumn2&&(n=null===(t=e.grid.data)||void 0===t?void 0:t.map(e=>e["tab:".concat(l.yColumn1)]-e["tab:".concat(l.yColumn2)])),[a,n]},[e.grid.data,l.xColumn1,l.xColumn2,l.yColumn1,l.yColumn2]),o=(0,i.useMemo)(()=>{let s,a;let[n,i]=t;if(""!=l.colorColumn){var o;s=null===(o=e.grid.data)||void 0===o?void 0:o.map(e=>e["tab:".concat(l.colorColumn)]),a={orientation:"v"}}return e.plots.color.filterOutliers&&n&&i&&n.length==i.length&&n.length>0&&([n,i]=ld(n,i)),[{x:n,y:i,mode:"markers",name:"points",marker:{color:s||"tab:blue",size:3,opacity:.7,colorbar:a},type:"scatter"},{x:n,name:"x density",marker:{color:"tab:blue"},yaxis:"y2",type:"histogram"},{y:i,name:"y density",marker:{color:"tab:blue"},xaxis:"x2",type:"histogram"}]},[t,e.plots.color.filterOutliers,l.colorColumn]),r={showlegend:!1,autosize:!0,height:740,margin:{t:50},hovermode:"closest",bargap:0,uirevision:"true",xaxis:{domain:[0,.85],showgrid:!1,zeroline:!1,title:"".concat(l.xColumn1," - ").concat(l.xColumn2)},yaxis:{domain:[0,.85],showgrid:!1,zeroline:!1,title:"".concat(l.yColumn1," - ").concat(l.yColumn2)},xaxis2:{domain:[.85,1],showgrid:!1,zeroline:!1},yaxis2:{domain:[.85,1],showgrid:!1,zeroline:!1}};return(0,n.jsxs)("div",{className:"w-100",children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-3",controlId:"x-axis",children:[(0,n.jsx)(B.Z,{sm:6,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold",style:{wordBreak:"keep-all"},children:"x-axis:"}),(0,n.jsx)(li,{value:l.xColumn1,dispatchKey:"xColumn1",dispatchType:a.COLOR_PLOT_SETUP}),(0,n.jsx)("span",{className:"fw-bold",children:"—"}),(0,n.jsx)(li,{value:l.xColumn2,dispatchKey:"xColumn2",dispatchType:a.COLOR_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:6,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold ms-lg-2",style:{wordBreak:"keep-all"},children:"y-axis:"}),(0,n.jsx)(li,{value:l.yColumn1,dispatchKey:"yColumn1",dispatchType:a.COLOR_PLOT_SETUP}),(0,n.jsx)("span",{className:"mx-2 fw-bold",children:"—"}),(0,n.jsx)(li,{value:l.yColumn2,dispatchKey:"yColumn2",dispatchType:a.COLOR_PLOT_SETUP})]})})]}),(0,n.jsxs)(V.Z.Group,{as:q.Z,controlId:"x-axis",children:[(0,n.jsx)(B.Z,{sm:4,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold ms-lg-2",style:{wordBreak:"keep-all"},children:"color:"}),(0,n.jsx)(li,{value:l.colorColumn,dispatchKey:"colorColumn",dispatchType:a.COLOR_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:4,className:"align-content-center ms-2",children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:3,children:[(0,n.jsx)(V.Z.Check,{type:"switch",id:"filter-outliers",label:"Filter outliers",checked:e.plots.color.filterOutliers,onChange:e=>s({type:a.COLOR_PLOT_SETUP,payload:{filterOutliers:e.target.checked}})}),(0,n.jsx)(I.Z,{disabled:0==e.plots.filterIndex.length||"color"!=e.plots.filterView,onClick:()=>{s({type:a.PLOT_SETUP,payload:{inspectSelected:!0}}),s({type:a.CURRENT_VIEW_CHANGE,payload:"grid"})},children:"Inspect Selected"})]})})]}),(0,n.jsx)(lr,{data:o,layout:r,config:{responsive:!0},className:"w-100",onSelected:e=>{var l,t;let n=null==e?void 0:null===(l=e.points)||void 0===l?void 0:l.map(e=>e.pointIndex);n&&n.length>0&&s({type:a.PLOT_SETUP,payload:{filterIndex:null==e?void 0:null===(t=e.points)||void 0===t?void 0:t.map(e=>e.pointIndex),filterView:"color"}})}})]})}function lh(){let{tcState:e,tcDispatch:s}=j(),l=e.plots.histogram,t=(0,i.useMemo)(()=>{let s=[];if(""!=l.column){var t;s=null===(t=e.grid.data)||void 0===t?void 0:t.map(e=>e["tab:".concat(l.column)])}return e.plots.color.filterOutliers&&s&&s.length>0&&(s=function(e){if(e.length<4)return e;let s=lc(e);return e.filter(e=>e>=s.minValue&&e<=s.maxValue)}(s)),[{x:s,name:"x density",marker:{color:"tab:blue"},type:"histogram"}]},[e.grid.data,l.column]),o={showlegend:!1,autosize:!0,height:740,hovermode:"closest",bargap:0,uirevision:"true",xaxis:{showgrid:!1,zeroline:!1,title:l.column},yaxis:{showgrid:!1,zeroline:!1,title:"Count"}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(V.Z.Group,{as:q.Z,className:"mb-3",controlId:"x-axis",children:[(0,n.jsx)(B.Z,{sm:3,children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:2,children:[(0,n.jsx)("span",{className:"fw-bold",style:{wordBreak:"keep-all"},children:"x-axis:"}),(0,n.jsx)(li,{value:l.column,dispatchKey:"column",dispatchType:a.HISTOGRAM_PLOT_SETUP})]})}),(0,n.jsx)(B.Z,{sm:3,className:"align-content-center",children:(0,n.jsxs)(eW.Z,{direction:"horizontal",gap:3,children:[(0,n.jsx)(V.Z.Check,{type:"switch",id:"filter-outliers",label:"Filter outliers",checked:e.plots.histogram.filterOutliers,onChange:e=>s({type:a.HISTOGRAM_PLOT_SETUP,payload:{filterOutliers:e.target.checked}})}),(0,n.jsx)(I.Z,{disabled:0==e.plots.filterIndex.length||"histogram"!=e.plots.filterView,onClick:()=>{s({type:a.PLOT_SETUP,payload:{inspectSelected:!0}}),s({type:a.CURRENT_VIEW_CHANGE,payload:"grid"})},children:"Inspect Selected"})]})})]}),(0,n.jsx)(lr,{data:t,layout:o,config:{responsive:!0},className:"w-100",onSelected:e=>{var l,t;let n=null==e?void 0:null===(l=e.points)||void 0===l?void 0:l.map(e=>e.pointIndex);n&&n.length>0&&s({type:a.PLOT_SETUP,payload:{filterIndex:null==e?void 0:null===(t=e.points)||void 0===t?void 0:t.map(e=>e.pointIndex),filterView:"histogram"}})}})]})}function lp(){let{tcState:e,tcDispatch:s}=j();return(0,i.useEffect)(()=>{(e.plots.inspectSelected||e.plots.filterIndex&&e.plots.filterIndex.length>0)&&s({type:a.PLOT_SETUP,payload:{inspectSelected:!1,filterIndex:[],filterView:void 0}})},[]),(0,n.jsxs)("div",{className:"container w-100",children:[(0,n.jsxs)(ln.Z,{justify:!0,fill:!0,variant:"underline",defaultActiveKey:e.plots.currentView,className:"mb-3 mt-1",onSelect:e=>{s({type:a.PLOT_VIEW_CHANGE,payload:e})},children:[(0,n.jsx)(ln.Z.Item,{children:(0,n.jsx)(ln.Z.Link,{eventKey:"scatter",children:"Scatter plot"})}),(0,n.jsx)(ln.Z.Item,{children:(0,n.jsx)(ln.Z.Link,{eventKey:"color",children:"Color-color diagram"})}),(0,n.jsx)(ln.Z.Item,{children:(0,n.jsx)(ln.Z.Link,{eventKey:"histogram",children:"Histogram"})})]}),"scatter"==e.plots.currentView&&(0,n.jsx)(lu,{}),"color"==e.plots.currentView&&(0,n.jsx)(lm,{}),"histogram"==e.plots.currentView&&(0,n.jsx)(lh,{})]})}function lx(){let{tcState:e}=j();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,n.jsx)(eY,{}),(0,n.jsxs)("div",{className:"flex-grow-1",children:["settings"==e.currentView&&(0,n.jsx)(sX,{}),"grid"==e.currentView&&(0,n.jsx)(la,{}),"plots"==e.currentView&&(0,n.jsx)(lp,{})]})]})})}function lg(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(b(),{children:[(0,n.jsx)("link",{rel:"icon",href:"data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>\uD83C\uDF0C</text></svg>"}),(0,n.jsx)("title",{children:"AstroInspect"})]}),(0,n.jsxs)(g,{children:[(0,n.jsx)(y,{}),(0,n.jsx)(lx,{})]})]})}},1549:function(e){e.exports={chip:"ButtonChip_chip__DD9VL"}},7615:function(e){e.exports={chip:"Chip_chip__5QeIu",pointer:"Chip_pointer__BzSv_",closebtn:"Chip_closebtn__JicWE"}}},function(e){e.O(0,[909,391,838,509,510,321,365,738,817,594,563,43,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);