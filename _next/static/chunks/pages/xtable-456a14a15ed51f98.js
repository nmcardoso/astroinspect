(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[743],{4963:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/xtable",function(){return t(5782)}])},5782:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ny}});var a,s=t(5893),r=t(682),c=t(5675),l=t.n(c),i=t(8443);function o(){return(0,s.jsx)(i.Z,{bg:"light",expand:"lg",className:"border-bottom",children:(0,s.jsx)(r.Z,{children:(0,s.jsx)(i.Z.Brand,{href:"#home",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsx)(l(),{alt:"",src:"https://nmcardoso.github.io/astrotools/galaxy_128.png",width:"30",height:"30",className:"d-inline-block align-top"}),(0,s.jsx)("span",{className:"ms-2",children:"AstroTools"})]})})})})}var u=t(7294),d=t(9483),h=t.n(d),m=t(1799),p=t(9396),f=function(){return{schemaVersion:7,table:{type:"local",file:null,url:null,selectedColumnsId:[],columns:[],raIndex:null,decIndex:null,processing:!1},classification:{enabled:!0,type:"categorical",classNames:[],positiveClass:"",negativeClass:""},splusCatalog:{},sdssCatalog:{selectedColumns:[]},splusImaging:{enabled:!0,type:"trilogy",trilogyConfig:{R:["R","I","F861","Z"],G:["G","F515","F660"],B:["U","F378","F395","F410","F430"],noise:.15,Q:.15},luptonConfig:{R:"I",G:"R",B:"G",stretch:3,Q:8}},legacyImaging:{enabled:!0},sdssSpectra:{enabled:!0},loadId:0}},x=f(),g=function(e){var n=(0,p.Z)((0,m.Z)({},e),{table:f().table,loadId:f().loadId});h().setItem("tableConfigState",n,function(e,n){e&&console.error(e)})},j=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.splusImaging.trilogyConfig[a]=n.payload[a];return g(t),t},v=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.splusImaging[a]=n.payload[a];return g(t),t},y=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.splusImaging.luptonConfig[a]=n.payload[a];return g(t),t},b=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.table[a]=n.payload[a];return g(t),t},Z=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.classification[a]=n.payload[a];return g(t),t},C=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.legacyImaging[a]=n.payload[a];return g(t),t},S=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.sdssSpectra[a]=n.payload[a];return g(t),t},I=function(e,n){var t=(0,m.Z)({},e);for(var a in n.payload)t.sdssCatalog[a]=n.payload[a];return g(t),t},N=function(e,n){var t=(0,m.Z)({},e);return t.loadId=n.payload.id,t},w=function(e,n){switch(n.type){case"loadSavedState":var t;return n.payload;case"setSplusTrilogyConfig":return j(e,n);case"setSplusImaging":return v(e,n);case"setSplusLuptonConfig":return y(e,n);case"setFileInput":return b(e,n);case"setClassification":return Z(e,n);case"setLegacyImaging":return C(e,n);case"setSdssImaging":return S(e,n);case"setSdssCatalog":return I(e,n);case"setLoadId":return N(e,n);default:return console.log("Action ".concat(n.type," not found")),(0,m.Z)({},e)}},k=(0,u.createContext)({tcState:x,tcDispatch:function(){}}),T=function(e){var n=e.children,t=(0,u.useReducer)(w,x),a=t[0],r=t[1];return(0,s.jsx)(k.Provider,{value:{tcState:a,tcDispatch:r},children:n})},F=function(){return(0,u.useContext)(k)};function R(){var e=F().tcDispatch;return(0,u.useEffect)(function(){h().getItem("tableConfigState",function(n,t){n||null===t||7!==t.schemaVersion||e({type:"loadSavedState",payload:t})})},[e]),null}var L=t(1555),_=t(4051),D=t(4213),E=t(5888),G=t(9301),B=t(1604),P=t(5005),U=t(9534),O=t(7070),H=t(7516);function A(e){var n=e.children,t=e.title,a=void 0===t?null:t,r=e.placement,c=e.className,l=(0,s.jsxs)(O.Z,{id:"help-popover",children:[a&&(0,s.jsx)(O.Z.Header,{as:"h3",children:a}),(0,s.jsx)(O.Z.Body,{children:n})]});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(U.Z,{trigger:"click",rootClose:!0,placement:void 0===r?"auto":r,overlay:l,children:(0,s.jsx)(P.Z,{variant:"link",className:"p-0 d-inline-flex align-items-center ".concat(void 0===c?"":c),children:(0,s.jsx)(H.CUu,{size:20})})})})}var q=t(8193),z=t(7077),M=t.n(z);function Q(e){var n=e.children,t=e.value,a=void 0===t?null:t,r=e.className,c=e.onClose,l=void 0===c?function(){}:c,i=e.closeable;return(0,s.jsxs)("div",{className:"".concat(M().chip," ").concat(void 0===r?"":r),children:[n,(void 0===i||i)&&(0,s.jsx)("span",{className:M().closebtn,onClick:function(e){l(e,a)},children:"\xd7"})]})}var V=function(e,n,t){n.includes(e)||(n.push(e),t({type:"setClassification",payload:{classNames:n}}))},K=function(e,n,t){t({type:"setClassification",payload:{classNames:n.filter(function(n){return n!=e})}})};function W(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.classification,r=(0,u.useState)(""),c=r[0],l=r[1];return(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"classNames",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:1,children:"Classes"}),(0,s.jsxs)(L.Z,{sm:8,children:[(0,s.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(G.Z.Control,{placeholder:"Class name",value:c,onChange:function(e){return l(e.target.value)},onKeyDown:function(e){var n=e.key||e.keyCode;("Enter"===n||13===n)&&(V(c,a.classNames,t),l(""))}}),(0,s.jsx)(P.Z,{variant:"success",onClick:function(){V(c,a.classNames,t),l("")},children:"Add"})]}),(0,s.jsx)(A,{title:"Class Name",className:"ms-1",children:"Type the class name and press `ENTER` or click `Add`"})]}),a.classNames.map(function(e){return(0,s.jsx)(Q,{className:"mb-1 me-1",onClose:function(){return K(e,a.classNames,t)},children:e},"cname_".concat(e))})]})]})}function J(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.classification;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"classCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsx)(G.Z.Check,{type:"switch",label:"Show Classification Column",checked:a.enabled,onChange:function(e){return t({type:"setClassification",payload:{enabled:e.target.checked}})}}),(0,s.jsx)(A,{title:"Enable Classifications",className:"ms-1",children:"Select this option if you want to classify the table, unsect to hide the classification column"})]})})]}),"categorical"==a.type?(0,s.jsx)(W,{}):(a.type,null),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"classCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Save"}),(0,s.jsx)(L.Z,{sm:8,children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(G.Z.Control,{placeholder:"File name"}),(0,s.jsxs)(P.Z,{variant:"primary",children:[(0,s.jsx)(q.xOH,{size:18,className:"me-1"})," ","Download classifications"]})]}),(0,s.jsx)(A,{title:"Save Classifications",className:"ms-1",children:"Choose a name and save your classifications in local computer"})]})})]})]})}function X(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.sdssSpectra;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"sloanSpecCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsx)(G.Z.Check,{type:"switch",label:"Show SDSS Spectra Column",checked:a.enabled,onChange:function(e){return t({type:"setSdssImaging",payload:{enabled:e.target.checked}})}})})]})})}function Y(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.legacyImaging;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"legacyImagingCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsx)(G.Z.Check,{type:"switch",label:"Show Legacy RGB Images Column",checked:a.enabled,onChange:function(e){return t({type:"setLegacyImaging",payload:{enabled:e.target.checked}})}})})]})})}var $=t(768),ee=t.n($);function en(e){var n=e.children,t=e.className,a=e.onClick;return(0,s.jsx)("div",{className:"".concat(ee().chip," ").concat(void 0===t?"btn-light":t),onClick:void 0===a?function(){}:a,children:n})}var et=["U","F378","F395","F410","F430","G","F515","R","F660","I","F861","Z"];function ea(e){var n=e.band,t=e.channel,a=e.variant,r=F(),c=r.tcState,l=r.tcDispatch,i=c.splusImaging.trilogyConfig,o=i.R,u=i.G,d=i.B,h=i[t].includes(n)?"btn-".concat(a):"btn-outline-".concat(a);return(0,s.jsx)(en,{className:"".concat(h," me-1"),onClick:function(){return l({type:"setSplusTrilogyConfig",payload:function(e,n,t){var a=(0,m.Z)({},e);for(var s in e)if(s!=n&&(a[s]=e[s].filter(function(e){return e!=t})),a[s].length<1)return e;return a[n].includes(t)?a[n]=a[n].filter(function(e){return e!=t}):a[n].push(t),a}({R:o,G:u,B:d},t,n)})},children:n})}function es(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.splusImaging.trilogyConfig;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusTrilogyR",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"R"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[et.map(function(e){return(0,s.jsx)(ea,{band:e,channel:"R",variant:"danger"},"R_".concat(e))}),(0,s.jsxs)(A,{title:"Red Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,s.jsx)("span",{className:"text-danger",children:"red"})," channel of the"," ","RGB image. Each channel must be mapped by at least 1 S-PLUS filter"]})]})})]}),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusTrilogyG",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"G"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[et.map(function(e){return(0,s.jsx)(ea,{band:e,channel:"G",variant:"success"},"G_".concat(e))}),(0,s.jsxs)(A,{title:"Green Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,s.jsx)("span",{className:"text-success",children:"green"})," channel of the"," ","RGB image. Each channel must be mapped by at least 1 S-PLUS filter"]})]})})]}),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusTrilogyB",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"B"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[et.map(function(e){return(0,s.jsx)(ea,{band:e,channel:"B",variant:"primary"},"B_".concat(e))}),(0,s.jsxs)(A,{title:"Blue Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,s.jsx)("span",{className:"text-primary",children:"blue"})," channel of the"," ","RGB image. Each channel must be mapped by at least 1 S-PLUS filter"]})]})})]}),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusTrilogyParams",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,s.jsx)(L.Z,{sm:8,children:(0,s.jsxs)(_.Z,{children:[(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{className:"mb-3",children:[(0,s.jsx)(B.Z.Text,{id:"trilogy-param-noise",children:"Noise"}),(0,s.jsx)(G.Z.Control,{"aria-label":"Noise","aria-describedby":"trilogy-param-noise",value:a.noise,onChange:function(e){return t({type:"setSplusTrilogyConfig",payload:{noise:e.target.value}})}})]})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{className:"mb-3",children:[(0,s.jsx)(B.Z.Text,{id:"trilogy-param-q",children:"Q"}),(0,s.jsx)(G.Z.Control,{"aria-label":"Q","aria-describedby":"trilogy-param-q",value:a.Q,onChange:function(e){return t({type:"setSplusTrilogyConfig",payload:{Q:e.target.value}})}})]})})]})})]})]})}function er(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.splusImaging.luptonConfig;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusLuptonColors",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Colors"}),(0,s.jsx)(L.Z,{sm:8,children:(0,s.jsxs)(_.Z,{children:[(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(B.Z.Text,{children:"R"}),(0,s.jsx)(G.Z.Select,{value:a.R,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{R:e.target.value}})},children:et.map(function(e){return(0,s.jsx)("option",{children:e},e)})})]})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(B.Z.Text,{children:"G"}),(0,s.jsx)(G.Z.Select,{value:a.G,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{G:e.target.value}})},children:et.map(function(e){return(0,s.jsx)("option",{children:e},e)})})]})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(B.Z.Text,{children:"B"}),(0,s.jsx)(G.Z.Select,{value:a.B,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{B:e.target.value}})},children:et.map(function(e){return(0,s.jsx)("option",{children:e},e)})})]})})]})})]}),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusLuptonParams",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,s.jsx)(L.Z,{sm:6,children:(0,s.jsxs)(_.Z,{children:[(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(B.Z.Text,{id:"lupton-param-noise",children:"Stretch"}),(0,s.jsx)(G.Z.Control,{"aria-label":"Stretch","aria-describedby":"lupton-param-noise",value:a.stretch,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{stretch:e.target.value}})}})]})}),(0,s.jsx)(L.Z,{children:(0,s.jsxs)(B.Z,{children:[(0,s.jsx)(B.Z.Text,{id:"lupton-param-q",children:"Q"}),(0,s.jsx)(G.Z.Control,{"aria-label":"Q","aria-describedby":"lupton-param-q",value:a.Q,onChange:function(e){return t({type:"setSplusLuptonConfig",payload:{Q:e.target.value}})}})]})})]})})]})]})}function ec(){var e=F(),n=e.tcState,t=e.tcDispatch,a=n.splusImaging;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"splusImagingCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,s.jsx)(L.Z,{sm:"11",className:"d-flex align-items-center",children:(0,s.jsx)(G.Z.Check,{type:"switch",label:"Show S-PLUS RGB Images Column",checked:a.enabled,onChange:function(e){return t({type:"setSplusImaging",payload:{enabled:e.target.checked}})}})})]}),(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"classCheck",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Type"}),(0,s.jsx)(L.Z,{sm:5,children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsxs)(G.Z.Select,{defaultValue:a.type,onChange:function(e){return t({type:"setSplusImaging",payload:{type:e.target.value}})},children:[(0,s.jsx)("option",{value:"trilogy",children:"Trilogy"}),(0,s.jsx)("option",{value:"lupton",children:"Lupton"})]}),(0,s.jsxs)(A,{title:"Image Type",className:"ms-1",children:["The algorithm used to make RGB stamps from the FITS file",(0,s.jsx)("br",{}),(0,s.jsx)("b",{children:"Trilogy: "})," The Trilogy algorithm",(0,s.jsx)("br",{}),(0,s.jsx)("b",{children:"Lupton: "})," The Lupton method"]})]})})]}),"trilogy"==a.type?(0,s.jsx)(es,{}):(0,s.jsx)(er,{})]})}var el,ei=t(9815),eo=t(6212),eu=t(3854),ed=t(1438),eh=t(7460),em=t.n(eh),ep=function(e,n){var t="^".concat(e,"[_d]*?$"),a=RegExp(t,"gi");return n.findIndex(function(e,n){return null!==a.exec(e)})},ef=new(function(){function e(){(0,ed.Z)(this,e)}var n=e.prototype;return n.load=function(e,n){e&&em().parse(e,{complete:n,skipEmptyLines:!0})},n.getHeaderSummary=function(e){var n=ep("ra",e),t=ep("dec",e);return{raIndex:n,decIndex:t,columns:e,positionFound:n>-1&&t>-1}},n.getTableSummary=function(e){var n=this;return new Promise(function(t,a){var s=function(e){if(e.errors.length>0)return a(e.errors);var s=e.data[0];t(n.getHeaderSummary(s))};em().parse(e,{complete:s,preview:1})})},n.getRa=function(e,n){return null!=n.raIndex&&e<n.data.length?n.sourceData[e+1][n.raIndex]:null},n.getDec=function(e,n){return null!=n.decIndex&&e<n.data.length?n.sourceData[e+1][n.decIndex]:null},n.getCellValue=function(e,n,t){var a,s;return null===(a=t.data)||void 0===a?void 0:null===(s=a[e])||void 0===s?void 0:s[n]},e}());function ex(e){var n=e.onChange;return(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"tableFile",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"Table"}),(0,s.jsx)(L.Z,{sm:6,children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsx)(G.Z.Control,{type:"file",onChange:n}),(0,s.jsx)(A,{title:"Local Upload",className:"ms-1",children:"Loads a table available in local computer"})]})})]})}function eg(){return(0,s.jsxs)(G.Z.Group,{as:_.Z,className:"mb-2",controlId:"tableFile",children:[(0,s.jsx)(G.Z.Label,{column:!0,sm:"1",children:"URL"}),(0,s.jsx)(L.Z,{sm:"5",children:(0,s.jsxs)("div",{className:"d-flex align-items-center",children:[(0,s.jsx)(G.Z.Control,{placeholder:"File URL"}),(0,s.jsx)(A,{title:"Remote Upload",className:"ms-1",children:"Loads a table available remotely over the internet"})]})}),(0,s.jsx)(L.Z,{sm:"2",className:"d-flex align-items-center",children:(0,s.jsx)(P.Z,{variant:"link",className:"px-1 py-1",children:"Load Example"})})]})}(el=a||(a={})).unloaded="unloaded",el.loading="loading",el.success="sucess",el.positionNotFound="positionNotFound",el.error="error";var ej=function(e){var n=e.state;return n==a.loading?(0,s.jsx)("p",{className:"text-secondary",children:"Loading table..."}):n==a.success?(0,s.jsxs)("p",{className:"text-success",children:[(0,s.jsx)(eu.dZ6,{})," RA and DEC columns successfully detected"]}):n==a.positionNotFound?(0,s.jsxs)("p",{className:"text-danger",children:[(0,s.jsx)(eu.apv,{})," RA or DEC columns not detected"]}):n==a.error?(0,s.jsxs)("p",{className:"text-danger",children:[(0,s.jsx)(eu.apv,{})," Failed to load this table, check if it's a valid csv file"]}):null},ev=function(e){var n=e.show,t=e.onHide,a=F(),r=a.tcState,c=a.tcDispatch,l=(0,u.useState)(-1),i=l[0],o=l[1],d=function(){i>=0&&!r.table.selectedColumnsId.includes(i)&&c({type:"setFileInput",payload:{selectedColumnsId:(0,ei.Z)(r.table.selectedColumnsId).concat([i])}})};return(0,s.jsxs)(eo.Z,{show:n,onHide:t,animation:!1,centered:!0,children:[(0,s.jsx)(eo.Z.Header,{closeButton:!0,children:(0,s.jsx)(eo.Z.Title,{id:"contained-modal-title-vcenter",children:"Select a column"})}),(0,s.jsx)(eo.Z.Body,{children:(0,s.jsx)(G.Z,{children:(0,s.jsxs)(_.Z,{children:[(0,s.jsx)(L.Z,{xs:10,children:(0,s.jsxs)(G.Z.Select,{defaultValue:-1,onChange:function(e){return o(parseInt(e.target.value))},children:[(0,s.jsx)("option",{value:-1,children:"Select one column to add"}),r.table.columns.map(function(e,n){return{colName:e,originalIndex:n}}).filter(function(e){return!r.table.selectedColumnsId.includes(e.originalIndex)}).map(function(e){return(0,s.jsx)("option",{value:e.originalIndex,children:e.colName},e.originalIndex)})]})}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(P.Z,{variant:"success",onClick:d,children:"Add"})})]})})})]})};function ey(){var e=F(),n=e.tcState,t=e.tcDispatch,r=n.table,c=(0,u.useState)(a.unloaded),l=c[0],i=c[1],o=(0,u.useState)(!1),d=o[0],h=o[1],m=function(e){if(e.target.files.length>0){var n=e.target.files[0];i(a.loading),ef.getTableSummary(n).then(function(e){(null==e?void 0:e.positionFound)?(i(a.success),t({type:"setFileInput",payload:{type:"local",columns:e.columns,selectedColumnsId:[e.raIndex,e.decIndex],raIndex:e.raIndex,decIndex:e.decIndex,file:n}})):i(a.positionNotFound)}).catch(function(e){i(a.error)})}},p=function(e,a){t({type:"setFileInput",payload:{selectedColumnsId:n.table.selectedColumnsId.filter(function(e){return e!=a})}})};return console.log(n.table.columns),(0,s.jsxs)(s.Fragment,{children:["local"==r.type?(0,s.jsx)(ex,{onChange:m}):(0,s.jsx)(eg,{}),(0,s.jsx)(ej,{state:l}),r.selectedColumnsId.length>0&&(0,s.jsxs)("div",{children:["Selected Columns: ",r.selectedColumnsId.map(function(e){return(0,s.jsx)(Q,{value:e,className:"mb-1 me-1",onClose:p,closeable:e!=r.raIndex&&e!=r.decIndex,children:r.columns[e]},"sourceColIdx_".concat(e))}),(0,s.jsx)(P.Z,{variant:"link",className:"py-0",onClick:function(){return h(!0)},children:"Add more"})]}),(0,s.jsx)(ev,{show:d,onHide:function(){return h(!1)}})]})}var eb=t(6729),eZ=new(t.n(eb)()),eC={on:function(e,n){return eZ.on(e,n)},once:function(e,n){return eZ.once(e,n)},off:function(e,n){return eZ.off(e,n)},emit:function(e,n){return eZ.emit(e,n)},count:function(e){return eZ.listenerCount(e)}};Object.freeze(eC);var eS=t(6968),eI=t(7568),eN=t(2222),ew=t(655),ek=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,ed.Z)(this,e),this.currentRequests=[],this.runningRequests=0,this.maxConcurrentRequests=n}var n=e.prototype;return n.callFunction=function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];var s=this;return new Promise(function(n,a){s.currentRequests.push({resolve:n,reject:a,fnToCall:e,args:t}),eC.on("cancel",function(){console.log("cancelling"),a("cancelled")}),s.tryNext()})},n.tryNext=function(){var e=this;if(this.runningRequests<this.maxConcurrentRequests){var n=this.currentRequests.shift();if(n){this.runningRequests++;var t=n.args;n.fnToCall.apply(null,t).then(function(e){return n.resolve(e)}).catch(function(e){return n.reject(e)}).finally(function(){e.runningRequests--,e.tryNext()})}}},e}(),eT=new(function(){function e(){(0,ed.Z)(this,e),this.pool={},this.controller=new AbortController}var n=e.prototype;return n.create=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e in this.pool||(this.pool[e]=new ek(n))},n.enqueue=function(e,n){for(var t,a=arguments.length,s=Array(a>2?a-2:0),r=2;r<a;r++)s[r-2]=arguments[r];return(t=this.pool[e]).callFunction.apply(t,[n].concat((0,ei.Z)(s)))},n.getSignal=function(){return this.controller.signal},n.clear=function(){for(var e in eC.emit("cancel",null),this.pool);},e}()),eF=t(9669),eR=t.n(eF),eL=t(4400),e_=t.n(eL),eD=t(8400),eE=t.n(eD);eT.create("sdss_cone_spec",1),eT.create("sdss_sql",2),eT.create("sdss_batch_query",2);var eG=function(){function e(n){(0,ed.Z)(this,e);var t=n||{},a=t.objType,s=t.raColumn,r=t.decColumn,c=t.pkColumn;this.raColumn=void 0===s?"ra":s,this.decColumn=void 0===r?"dec":r,this.pkColumn=void 0===c?null:c,this.objType=void 0===a?"photo":a}var n=e.prototype;return n.getQuery=function(e,n,t,a){return"SELECT p.fiber2Mag_z ".concat(a.map(function(e){return"t.".concat(e)}).join(","),"\n    FROM PhotoObj p, dbo.fGetNearbyObjEq(326.8952189, 0.7732093, 0.02) n\n    WHERE p.objID = n.objID")},n.getCrossIdQuery=function(e,n){var t="photo"==this.objType?"objID":"specObjID";return"\n    SELECT \n      ".concat(n.map(function(e){return"t.".concat(e)}).join(","),"\n    FROM #upload u\n      JOIN #x x ON x.up_id = u.up_id\n      JOIN ").concat(e," t ON t.").concat(this.pkColumn||t," = x.").concat(t,"\n    ORDER by x.up_id\n    ").trim()},e}(),eB={PhotoTag:{searchStrategy:new eG,type:"view"},SpecObj:{searchStrategy:new eG({objType:"spectro"}),type:"view"},GalaxyTag:{searchStrategy:new eG,type:"view"},StarTag:{searchStrategy:new eG,type:"table"},emissionLinesPort:{searchStrategy:new eG({objType:"spectro"}),type:"table"},TwoMass:{searchStrategy:new eG,type:"table"},zooSpec:{searchStrategy:new eG,type:"table"},zooNoSpec:{searchStrategy:new eG,type:"table"},zoo2MainSpecZ:{searchStrategy:new eG({pkColumn:"dr8objid"}),type:"table"}},eP=function(){function e(){(0,ed.Z)(this,e)}var n=e.prototype;return n.getObjSpecId=function(e,n){return eT.enqueue("sdss_cone_spec",(0,eI.Z)(function(){var t,a,s,r,c;return(0,ew.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,eR().get("https://skyserver.sdss.org/dr17/SkyServerWS/SpectroQuery/ConeSpectro",{params:{ra:e,dec:n,radius:.01667,limit:1,format:"xml",specparams:"specObjID",imgparams:"none",zWarning:"on"},signal:eT.getSignal()})];case 1:return t=a.sent(),[2,null==(r=new DOMParser().parseFromString(t.data,"application/xml").querySelector('Table[name="Table1"] > Row > Item[name="specObjID"]'))?void 0:r.textContent];case 2:return c=a.sent(),console.log(void 0===c?"undefined":(0,eN.Z)(c)),console.log(c),[3,3];case 3:return[2]}})}))},n.getSpecPlotUrl=function(e,n){var t=this;return(0,eI.Z)(function(){var a;return(0,ew.__generator)(this,function(s){switch(s.label){case 0:return[4,t.getObjSpecId(e,n)];case 1:return a=s.sent(),[2,"https://skyserver.sdss.org/dr17/en/get/SpecById.ashx?id=".concat(a)]}})})()},n.getSpecPlotUrlById=function(e){return"https://skyserver.sdss.org/dr17/en/get/SpecById.ashx?id=".concat(e)},n.getTables=function(){return Object.keys(eB)},n.getColumns=function(e){return(0,eI.Z)(function(){var n,t,a,s,r;return(0,ew.__generator)(this,function(s){switch(s.label){case 0:return t="table"==eB[e].type?"SELECT name, description, unit \n      FROM DBColumns \n      WHERE tablename='".concat(e,"'"):"\n      SELECT tc.name name, tc.description description, tc.unit unit\n      FROM DBColumns tc\n      INNER JOIN DBViewCols vc ON vc.parent = tc.tablename AND vc.name = tc.name\n      WHERE vc.viewname='".concat(e,"' \n      ").trim(),console.log(t),a="".concat("https://skyserver.sdss.org/dr16/SkyServerWS/SearchTools/SqlSearch","?cmd=").concat(encodeURIComponent(t),"&format=json"),[4,fetch(a)];case 1:return[4,s.sent().json()];case 2:return[2,null==(r=s.sent())?void 0:null===(n=r[0])||void 0===n?void 0:n.Rows]}})})()},n.batchQuery=function(e,n,t){var a=this;return(0,eI.Z)(function(){return(0,ew.__generator)(this,function(s){return[2,eT.enqueue("sdss_batch_query",(0,eI.Z)(function(){var s,r,c,l,i;return(0,ew.__generator)(this,function(l){switch(l.label){case 0:return r=(s=eB[n].searchStrategy).getCrossIdQuery(n,t),[4,eR().get("https://skyserver.sdss.org/dr17/SkyServerWS/SearchTools/CrossIdSearch",{params:{searchtool:"CrossID",searchType:s.objType,photoScope:"nearPrim",spectroScope:"nearPrim",photoUpType:"ra-dec",spectroUpType:"ra-dec",radius:.016667,firstcol:1,paste:a.getCsv(e),uquery:r,format:"JSON"},transformResponse:[function(e){return e}]})];case 1:return c=l.sent(),[2,(0,e_()({storeAsString:!0}).parse(c.data).find(function(e){return"Table1"==e.TableName}).Rows).map(function(e){return(0,p.Z)((0,m.Z)({},e),{index:parseInt(e.index)})})]}})}))]})})()},n.chunckedQuery=function(e,n,t,a){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this,c=eE()(e,50),l=t.reduce(function(e,n){return e[n]=null,e},{});c.map(function(e){return r.batchQuery(e,n,t)}).forEach(function(e,n){e.then(function(e){var t=e.map(function(e){return e.index}),r=c[n].map(function(e){return e.index}).filter(function(e){return!t.includes(e)}).map(function(e){return(0,m.Z)({index:e},l)}),i=(0,ei.Z)(e).concat((0,ei.Z)(r));if(s){var o=!0,u=!1,d=void 0;try{for(var h,p=i[Symbol.iterator]();!(o=(h=p.next()).done);o=!0){var f=h.value;a(f)}}catch(x){u=!0,d=x}finally{try{o||null==p.return||p.return()}finally{if(u)throw d}}}else a(i)})})},n.getCsv=function(e){return"index,ra,dec\r\n"+(e.map(function(e){return"".concat(e.index,",").concat(e.ra,",").concat(e.dec)}).join("\r\n")||"")},e}(),eU=t(4331),eO=function(e){var n=e.items,t=e.active,a=e.onClick,r=e.height,c=e.className;return(0,s.jsx)(E.Z,{className:"".concat(c," overflow-auto"),style:{height:r},children:n.map(function(e,n){return(0,s.jsx)(E.Z.Item,{action:!0,active:t==e,onClick:function(t){return a({title:e,index:n,event:t})},children:e},n)})})},eH=function(e){var n=e.items,t=e.active,a=e.onClick,r=e.height,c=e.className;return(0,s.jsx)(E.Z,{className:"".concat(c," overflow-auto"),style:{height:r},children:n.map(function(e,n){return(0,s.jsx)(E.Z.Item,{action:!0,variant:t&&t.includes(e)?"primary":"",onClick:function(t){return a({title:e,index:n,event:t})},children:e},n)})})},eA=function(e){var n=e.className,t=e.height;return(0,s.jsxs)(E.Z,{className:"".concat(n," overflow-auto"),style:{height:t},children:[(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:6})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:9})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:4})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:5})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:11})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:7})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:8})}),(0,s.jsx)(eU.Z,{as:E.Z.Item,animation:"glow",children:(0,s.jsx)(eU.Z,{xs:5})})]})};function eq(e){var n=e.items,t=void 0===n?[]:n,a=e.active,r=void 0===a?[]:a,c=e.multiple,l=e.placeholder,i=e.onClick,o=void 0===i?function(){}:i,u=e.height,d=void 0===u?260:u,h=e.className,m=void 0===h?"":h;return(0,s.jsx)(s.Fragment,{children:void 0!==l&&l?(0,s.jsx)(eA,{className:m,height:d}):void 0!==c&&c?(0,s.jsx)(eH,{items:t,active:r,onClick:o,height:d,className:m}):(0,s.jsx)(eO,{items:t,active:r,onClick:o,height:d,className:m})})}var ez=t(5147),eM=t(4908),eQ=t.n(eM),eV=new eP,eK=eV.getTables(),eW=function(e){var n=e.show,t=e.onHide,a=F(),r=a.tcState,c=a.tcDispatch,l=(0,u.useState)(eK[0]),i=l[0],o=l[1],d=(0,u.useState)(""),h=d[0],m=d[1],p=(0,u.useState)([]),f=p[0],x=p[1],g=(0,u.useState)(!0),j=g[0],v=g[1],y=r.sdssCatalog.selectedColumns;(0,u.useEffect)(function(){eV.getColumns(i).then(function(e){v(!1),x(e)}).catch(function(){})},[i]);var b=(0,u.useMemo)(function(){return null==f?void 0:f.map(function(e){return e.name})},[f])||[],Z=(0,u.useMemo)(function(){return null==f?void 0:f.find(function(e){return e.name==h})},[f,h]),C=(0,u.useMemo)(function(){return y.findIndex(function(e){return e.column==h&&e.table==i})>-1},[y,h,i]),S=function(e,n){var t=y.findIndex(function(t){return t.column==n&&t.table==e});c({type:"setSdssCatalog",payload:{selectedColumns:y.filter(function(e,n){return n!=t})}})},I=function(e,n){c({type:"setSdssCatalog",payload:{selectedColumns:(0,ei.Z)(y).concat([{table:e,column:n}])}})};return(0,s.jsxs)(eo.Z,{show:n,onHide:t,animation:!1,size:"lg",centered:!0,children:[(0,s.jsx)(eo.Z.Header,{className:"py-2",closeButton:!0,children:(0,s.jsx)(eo.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Add SDSS columns"})}),(0,s.jsx)(eo.Z.Body,{children:(0,s.jsxs)(_.Z,{children:[(0,s.jsxs)(L.Z,{sm:5,children:[(0,s.jsxs)(_.Z,{className:"align-items-center",children:[(0,s.jsx)(L.Z,{lg:2,children:"Table:"}),(0,s.jsx)(L.Z,{children:(0,s.jsx)(G.Z.Select,{defaultValue:i,onChange:function(e){v(!0),m(""),o(e.target.value)},children:eK.map(function(e){return(0,s.jsx)("option",{value:e,children:e},e)})})})]}),(0,s.jsx)(eq,{placeholder:j,items:b,active:h,className:"mt-2",height:340,onClick:function(e){return m(e.title)}})]}),j?(0,s.jsxs)(L.Z,{children:[(0,s.jsx)(eS.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,s.jsxs)("span",{className:"text-muted",children:["Loading columns of the ",(0,s.jsx)("u",{children:i})," table"]})]}):(0,s.jsxs)(L.Z,{children:[y.filter(function(e){return e.table==i}).length>0&&(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsx)("span",{className:"text-muted fw-bold",children:"Selected columns:\xa0"}),y.filter(function(e){return e.table==i}).map(function(e){return(0,s.jsx)(Q,{closeable:!0,className:"mb-1 me-1",onClose:function(){return S(i,e.column)},children:e.column},e.column)})]}),Z&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-2",children:[(0,s.jsxs)("b",{children:[Z.name,":"]}),"\xa0",Z.description,".\xa0",Z.unit&&(0,s.jsxs)(s.Fragment,{children:["Unit: ",(0,s.jsx)("i",{dangerouslySetInnerHTML:{__html:Z.unit}})]})]}),(0,s.jsx)("div",{children:C?(0,s.jsxs)(P.Z,{variant:"outline-danger",size:"sm",onClick:function(){return S(i,h)},children:[(0,s.jsx)(eu.HeX,{})," Remove Selected Column"]}):(0,s.jsxs)(P.Z,{variant:"outline-success",size:"sm",onClick:function(){return I(i,h)},children:[(0,s.jsx)(H.poH,{size:16})," Add Selected Column"]})})]})]})]})})]})};function eJ(){var e=F(),n=e.tcState,t=e.tcDispatch,a=(0,u.useState)(!1),r=a[0],c=a[1],l=n.sdssCatalog.selectedColumns,i=(0,u.useMemo)(function(){return eQ()(l.map(function(e){return e.table}))},[l]),o=function(e,n){var a=l.findIndex(function(t){return t.column==n&&t.table==e});t({type:"setSdssCatalog",payload:{selectedColumns:l.filter(function(e,n){return n!=a})}})};return(0,s.jsxs)(s.Fragment,{children:[l.length>0&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(ez.Z,{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Table"}),(0,s.jsx)("th",{children:"Column"})]})}),(0,s.jsx)("tbody",{children:i.map(function(e){return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e}),(0,s.jsx)("td",{children:l.filter(function(n){return n.table==e}).map(function(e){return(0,s.jsx)(Q,{className:"mb-1 me-1",onClose:function(){return o(e.table,e.column)},children:e.column},e.column)})})]},e)})})]})}),(0,s.jsxs)(P.Z,{size:"sm",onClick:function(){return c(!0)},children:[(0,s.jsx)(H.poH,{size:16})," Add SDSS Columns"]}),(0,s.jsx)(eW,{show:r,onHide:function(){return c(!1)}})]})}function eX(){var e=F(),n=e.tcState;e.tcDispatch;var t=function(e){eC.emit("load_table",!0)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(D.Z.Container,{id:"list-group-tabs-example",defaultActiveKey:"#link0",children:(0,s.jsxs)(_.Z,{children:[(0,s.jsxs)(L.Z,{sm:3,children:[(0,s.jsxs)(E.Z,{children:[(0,s.jsx)(E.Z.Item,{action:!0,href:"#link0",children:"Select Table"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link1",children:"Classification"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link2",children:"S-PLUS Catalog"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link3",children:"SDSS Catalog"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link4",children:"S-PLUS Imaging"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link5",children:"Legacy Imaging"}),(0,s.jsx)(E.Z.Item,{action:!0,href:"#link6",children:"SDSS Spectra"})]}),(0,s.jsx)(P.Z,{className:"mt-2 w-100 fw-bold",variant:"success",onClick:t,disabled:!n.table.file,children:n.table.processing?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eS.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"light"})," Loading"]}):(0,s.jsx)(s.Fragment,{children:"Load Table"})})]}),(0,s.jsx)(L.Z,{sm:9,children:(0,s.jsxs)(D.Z.Content,{children:[(0,s.jsx)(D.Z.Pane,{eventKey:"#link0",children:(0,s.jsx)(ey,{})}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link1",children:(0,s.jsx)(J,{})}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link2",children:"Nada"}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link3",children:(0,s.jsx)(eJ,{})}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link4",children:(0,s.jsx)(ec,{})}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link5",children:(0,s.jsx)(Y,{})}),(0,s.jsx)(D.Z.Pane,{eventKey:"#link6",children:(0,s.jsx)(X,{})})]})})]})})})}var eY=t(2679),e$=function(){function e(){(0,ed.Z)(this,e)}var n=e.prototype;return n.getRGBUrl=function(e,n){return"".concat("https://www.legacysurvey.org/viewer-dev/cutout.jpg","?ra=").concat(e,"&dec=").concat(n,"&layer=ls-dr10-early-grz&pixscale=0.30")},n.getNearbyRedshift=function(e,n,t){return(0,eI.Z)(function(){var t,a,s,r,c,l,i;return(0,ew.__generator)(this,function(s){switch(s.label){case 0:return t=20/3600,a=[],[4,eR().get("https://red-mirror.herokuapp.com/https://www.legacysurvey.org/viewer/spec/1/cat.json",{params:{ralo:parseFloat(e)-t,rahi:parseFloat(e)+t,declo:parseFloat(n)-t,dechi:parseFloat(n)+t}})];case 1:for(r=s.sent().data,console.log(r),c=0;c<r.name.length;c++)a.push({ra:parseFloat(r.rd[c][0]),dec:parseFloat(r.rd[c][1]),z:null===(i=null===(l=r.name[c])||void 0===l?void 0:l.match(/z=.*/))||void 0===i?void 0:i[0]});return[2,a.filter(function(e){return!!e.z})]}})})()},e}(),e0=t(828),e1=t(4788),e2=t.n(e1),e4={data:[],sourceData:[],sourceColumns:[],raIndex:-1,decIndex:-1,schema:{sourceTable:[],sdssCatalog:[],classification:!1,legacyImaging:!1,splusImaging:!1,sdssSpectra:!1}},e3=function(e,n){var t,a,s,r,c,l,i=(0,m.Z)({},e);return i.sourceData=null!==(t=n.payload.sourceData)&&void 0!==t?t:i.sourceData,i.sourceColumns=null!==(a=n.payload.sourceColumns)&&void 0!==a?a:i.sourceColumns,i.raIndex=null!==(s=n.payload.raIndex)&&void 0!==s?s:i.raIndex,i.decIndex=null!==(r=n.payload.decIndex)&&void 0!==r?r:i.decIndex,i.data=null!==(c=n.payload.initialData)&&void 0!==c?c:Array(n.payload.sourceData.length-1),i.schema=null!==(l=n.payload.schema)&&void 0!==l?l:i.schema,i},e6=function(e,n){var t=(0,m.Z)({},e),a=e2()(n.payload.columns,n.payload.keys),s=!0,r=!1,c=void 0;try{for(var l,i=n.payload.data[Symbol.iterator]();!(s=(l=i.next()).done);s=!0){var o=l.value,u=!0,d=!1,h=void 0;try{for(var p,f=a[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var x=(0,e0.Z)(p.value,2),g=x[0],j=x[1];t.data[o.index][j]=o[g]}}catch(v){d=!0,h=v}finally{try{u||null==f.return||f.return()}finally{if(d)throw h}}}}catch(y){r=!0,c=y}finally{try{s||null==i.return||i.return()}finally{if(r)throw c}}return t},e7=function(e,n){var t=(0,m.Z)({},e);return e.data[n.payload.rowId].classification=n.payload.class,t},e8=function(e,n){switch(n.type){case"setBatchData":return e6(e,n);case"initTable":return e3(e,n);case"setClass":return e7(e,n);default:return e}},e5=(0,u.createContext)({tdState:e4,tdDispatch:function(){}}),e9=function(e){var n=e.children,t=(0,u.useReducer)(e8,e4),a=t[0],r=t[1];return(0,s.jsx)(e5.Provider,{value:{tdState:a,tdDispatch:r},children:n})},ne=function(){return(0,u.useContext)(e5)},nn=new e$,nt=function(e){var n=e.centerRa,t=e.centerDec,a=e.redshifts;return(0,s.jsxs)("svg",{viewBox:"0 0 400 400",children:[(0,s.jsxs)("defs",{children:[(0,s.jsxs)("filter",{x:"-0.03",y:"-0.03",width:"1.06",height:"1.06",id:"bg-text",children:[(0,s.jsx)("feFlood",{floodColor:"#FFFFFF"}),(0,s.jsx)("feComposite",{in:"SourceGraphic",operator:"over"})]}),(0,s.jsxs)("filter",{x:"-0.03",y:"-0.03",width:"1.06",height:"1.06",id:"bg-text-hover",children:[(0,s.jsx)("feFlood",{floodColor:"#AFEEEE"}),(0,s.jsx)("feComposite",{in:"SourceGraphic",operator:"over"})]})]}),a.map(function(e,a){return(0,s.jsxs)("g",{className:"circle-group",children:[(0,s.jsx)("circle",{cx:200+(n-e.ra)*(400/.0212),cy:200+(t-e.dec)*(400/.0213),r:"40",strokeWidth:"2px",fill:"transparent"}),(0,s.jsx)("text",{x:200+(n-e.ra)*(400/.0212),y:230+(t-e.dec)*(400/.0213),fill:"black",stroke:"transparent",textAnchor:"middle",alignmentBaseline:"hanging",children:e.z})]},a)})]})},na=function(e){var n=e.show,t=e.onHide,a=e.src,r=e.ra,c=e.dec,l=(0,u.useState)(!1),i=l[0],o=l[1],d=(0,u.useState)(null),h=d[0],m=d[1];return(0,u.useEffect)(function(){i&&null===h&&(console.log(r,c),nn.getNearbyRedshift(r,c,0).then(function(e){m(e)})),console.log(h)},[r,c,h,i]),(0,s.jsxs)(eo.Z,{show:n,onHide:t,animation:!1,centered:!0,children:[(0,s.jsx)(eo.Z.Body,{className:"mx-auto px-0 py-2",children:(0,s.jsxs)("div",{className:"img-overlay-wrap",children:[(0,s.jsx)("img",{src:a,width:400,height:400,alt:""}),i&&h&&(0,s.jsx)(nt,{centerRa:r,centerDec:c,redshifts:h})]})}),(0,s.jsx)(eo.Z.Footer,{className:"py-2",children:(0,s.jsx)(G.Z.Check,{type:"switch",id:"image-modal-redshift-toogle",label:"Show Redshit",defaultChecked:i,onChange:function(e){return o(e.target.checked)}})})]})};function ns(e){var n=e.src,t=e.rowId,a=(0,u.useState)(null);a[0],a[1];var r=(0,u.useState)(!1),c=r[0],l=r[1],i=ne().tdState,o=(0,u.useMemo)(function(){return ef.getRa(t,i)},[t,i]),d=(0,u.useMemo)(function(){return ef.getDec(t,i)},[t,i]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eY.LazyLoadImage,{src:n,width:90,height:90,onClick:function(){return l(!0)},className:"cursor-pointer"}),(0,s.jsx)(na,{show:c,onHide:function(){return l(!1)},src:n,ra:o,dec:d})]})}function nr(e){var n=e.rowId,t=F().tcState,a=ne(),r=a.tdState,c=a.tdDispatch;return(0,s.jsxs)(G.Z.Select,{defaultValue:"",value:r.data[n].classification,onChange:function(e){c({type:"setClass",payload:{class:e.target.value,rowId:n}})},children:[(0,s.jsx)("option",{value:"",children:"-"}),t.classification.classNames.map(function(e){return(0,s.jsx)("option",{value:e,children:e},e)})]})}var nc=new eP,nl=function(e){var n=e.show,t=e.onHide,a=e.src;return(0,s.jsx)(eo.Z,{show:n,onHide:t,animation:!1,size:"lg",centered:!0,children:(0,s.jsx)(eo.Z.Body,{className:"p-1",children:(0,s.jsx)("img",{src:a,width:"100%",alt:""})})})};function ni(e){var n=e.rowId,t=(0,u.useState)(!1),a=t[0],r=t[1],c=ne().tdState,l=ef.getCellValue(n,"sdssSpectra",c),i=nc.getSpecPlotUrlById(l);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("img",{className:"cursor-pointer",src:null===l?"https://dummyimage.com/90x90/e8e8e8/474747.jpg&text=Not+Found":i,height:90,alt:"",onClick:function(){return r(!0)}}),(0,s.jsx)(nl,{src:i,show:a,onHide:function(){return r(!1)}})]})}function no(e){var n=e.rowId,t=e.colId,a=ne().tdState,r=ef.getCellValue(n,t,a);return(0,s.jsx)(s.Fragment,{children:void 0===r?(0,s.jsx)(s.Fragment,{children:"-"}):null===r?(0,s.jsx)(s.Fragment,{children:"-"}):(0,s.jsx)(s.Fragment,{children:r})})}var nu=t(6932);function nd(e){return Object.entries(e).map(function(e){var n=(0,e0.Z)(e,2),t=n[0],a=n[1];return"".concat(t,"=").concat(a)}).join("&")}var nh=function(){function e(){(0,ed.Z)(this,e),this.httpClient=eR().create({baseURL:"https://red-mirror.herokuapp.com/https://splus.cloud/public-TAP/tap/"}),this.publicSchemas=null,this.cachedTables=null}var n=e.prototype;return n.getTables=function(e){var n=this;return(0,eI.Z)(function(){var t,a,s,r,c,l,i,o,u;return(0,ew.__generator)(this,function(a){switch(a.label){case 0:if(null!=n.cachedTables)return[3,2];return[4,n.httpClient.get("tables")];case 1:s=a.sent().data,l=new nu.XMLParser().parse(s)["vosi:tableset"].schema,n.publicSchemas=l,a.label=2;case 2:return Array.isArray(o=(i=null===(t=n.publicSchemas)||void 0===t?void 0:t.find(function(n){return n.name==e}))&&i.table)||(o=[o]),[2,o.map(function(e){return e.name})]}})})()},n.getColumns=function(e,n){var t=this;return(0,eI.Z)(function(){var a,s,r,c,l;return(0,ew.__generator)(this,function(l){return null==t.publicSchemas?[2,[]]:(Array.isArray(r=(s=t.publicSchemas.find(function(n){return n.name==e}))&&s.table)||(r=[r]),[2,null==(c=r.find(function(e){return e.name==n}))?void 0:null===(a=c.column)||void 0===a?void 0:a.map(function(e){return e.name})])})})()},n.getTrilogyUrl=function(e,n,t){var a,s,r,c={ra:e,dec:n,r:null==t?void 0:null===(a=t.R)||void 0===a?void 0:a.join(","),g:null==t?void 0:null===(s=t.G)||void 0===s?void 0:s.join(","),b:null==t?void 0:null===(r=t.B)||void 0===r?void 0:r.join(","),noise:null==t?void 0:t.noise,q:null==t?void 0:t.Q},l=nd(c);return"".concat("https://checker-melted-forsythia.glitch.me/trilogy.png","?").concat(l)},n.getLuptonUrl=function(e,n,t){var a={ra:e,dec:n,r:null==t?void 0:t.R,g:null==t?void 0:t.G,b:null==t?void 0:t.B,stretch:null==t?void 0:t.stretch,q:null==t?void 0:t.Q},s=nd(a);return"".concat("https://checker-melted-forsythia.glitch.me/lupton.png","?").concat(s)},e}(),nm=t(4799),np=new nh,nf=new e$,nx=new eP,ng=(0,nm.createColumnHelper)(),nj={sourceTable:function(e){return ng.accessor("sourceTable:".concat(e),{cell:function(e){return e.getValue()},header:e})},legacyImaging:function(){return ng.accessor("legacyImaging",{cell:function(e){return(0,s.jsx)(ns,{src:e.getValue(),rowId:e.row.index})},header:"Legacy"})},splusImaging:function(){return ng.accessor("splusImaging",{cell:function(e){return(0,s.jsx)(ns,{src:e.getValue(),rowId:e.row.index})},header:"S-PLUS"})},classification:function(){return ng.accessor("classification",{cell:function(e){return(0,s.jsx)(nr,{rowId:e.row.index})},header:"Class"})},sdssSpectra:function(){return ng.accessor("sdssSpectra",{cell:function(e){return(0,s.jsx)(ni,{rowId:e.row.index})},header:"SDSS Spec"})},sdssCatalog:function(e,n){return ng.accessor("sdss:".concat(e,".").concat(n),{cell:function(t){return(0,s.jsx)(no,{rowId:t.row.index,colId:"sdss:".concat(e,".").concat(n)})},header:n})}};function nv(){var e=F(),n=e.tcState,t=e.tcDispatch,a=ne(),r=a.tdState,c=a.tdDispatch,l=r.data,i=(0,u.useMemo)(function(){console.log("useMemo");var e=r.schema.sourceTable.map(function(e){return nj.sourceTable(e.colName)}),n=r.schema.legacyImaging?[nj.legacyImaging()]:[],t=r.schema.splusImaging?[nj.splusImaging()]:[],a=r.schema.classification?[nj.classification()]:[],s=r.schema.sdssSpectra?[nj.sdssSpectra()]:[],c=r.schema.sdssCatalog.map(function(e){return nj.sdssCatalog(e.tableName,e.colName)});return(0,ei.Z)(a).concat((0,ei.Z)(e),(0,ei.Z)(c),(0,ei.Z)(s),(0,ei.Z)(n),(0,ei.Z)(t))},[r.schema]),o=(0,nm.useReactTable)({data:l,columns:i,getCoreRowModel:(0,nm.getCoreRowModel)()});return(0,u.useEffect)(function(){eC.on("load_table",function(){t({type:"setFileInput",payload:{processing:!0}}),ef.load(n.table.file,function(e){for(var a=function(e){var t=s[e+1][l.raIndex],a=s[e+1][l.decIndex],r={};if(o.sourceTable.forEach(function(n){r["sourceTable:".concat(n.colName)]=s[e+1][n.colId]}),o.sdssCatalog.forEach(function(e){r["sdss:".concat(e.tableName,".").concat(e.colName)]=void 0}),o.legacyImaging&&(r.legacyImaging=nf.getRGBUrl(t,a)),o.splusImaging){var c=n.splusImaging.type;r.splusImaging="trilogy"==c?np.getTrilogyUrl(t,a,n.splusImaging.trilogyConfig):np.getLuptonUrl(t,a,n.splusImaging.luptonConfig)}o.classification&&(r.classification=void 0),o.sdssSpectra&&(r.sdssSpectra=void 0),i[e]=r},s=e.data,r=e.data[0],l=ef.getHeaderSummary(r),i=Array(s.length-1),o={sourceTable:n.table.selectedColumnsId.map(function(e){return{colId:e,colName:n.table.columns[e]}}),sdssCatalog:n.sdssCatalog.selectedColumns.map(function(e){return{tableName:e.table,colName:e.column}}),legacyImaging:n.legacyImaging.enabled,splusImaging:!!n.splusImaging.enabled,classification:n.classification.enabled,sdssSpectra:n.sdssSpectra.enabled},u=0;u<s.length-1;u++)a(u);c({type:"initTable",payload:{initialData:i,sourceData:s,sourceColumns:r,raIndex:l.raIndex,decIndex:l.decIndex,schema:o}});var d=s.slice(1).map(function(e,n){return{index:n,ra:e[l.raIndex],dec:e[l.decIndex]}}),h=!0,m=!1,p=void 0;try{for(var f,x=o.sdssCatalog[Symbol.iterator]();!(h=(f=x.next()).done);h=!0)!function(){var e=f.value;nx.chunckedQuery(d,e.tableName,[e.colName],function(n){c({type:"setBatchData",payload:{data:n,keys:["sdss:".concat(e.tableName,".").concat(e.colName)],columns:[e.colName]}})})}()}catch(g){m=!0,p=g}finally{try{h||null==x.return||x.return()}finally{if(m)throw p}}o.sdssSpectra&&nx.chunckedQuery(d,"SpecObj",["specObjId"],function(e){c({type:"setBatchData",payload:{data:e,keys:["sdssSpectra"],columns:["specObjId"]}})}),t({type:"setFileInput",payload:{processing:!1}})})})},[n,t,r,c]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(ez.Z,{striped:!0,bordered:!0,hover:!0,className:"mt-3",children:[(0,s.jsx)("thead",{children:o.getHeaderGroups().map(function(e){return(0,s.jsx)("tr",{children:e.headers.map(function(e){return(0,s.jsx)("th",{children:e.isPlaceholder?null:(0,nm.flexRender)(e.column.columnDef.header,e.getContext())},e.id)})},e.id)})}),(0,s.jsx)("tbody",{children:o.getRowModel().rows.map(function(e){return(0,s.jsx)("tr",{children:e.getVisibleCells().map(function(e){return(0,s.jsx)("td",{className:"p-1",children:(0,nm.flexRender)(e.column.columnDef.cell,e.getContext())},e.id)})},e.id)})})]})})}function ny(){return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(T,{children:[(0,s.jsx)(R,{}),(0,s.jsx)(o,{}),(0,s.jsx)(r.Z,{className:"mt-3",children:(0,s.jsx)(eX,{})}),(0,s.jsx)(r.Z,{fluid:!0,className:"px-0",children:(0,s.jsx)(e9,{children:(0,s.jsx)(nv,{})})})]})})}},768:function(e){e.exports={chip:"ButtonChip_chip__MTWn5"}},7077:function(e){e.exports={chip:"Chip_chip__tunY0",pointer:"Chip_pointer___ocw2",closebtn:"Chip_closebtn__MtFlG"}}},function(e){e.O(0,[556,874,617,69,774,888,179],function(){return e(e.s=4963)}),_N_E=e.O()}]);