(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7594:function(e){function s(e){return Promise.resolve().then(function(){var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s})}s.keys=function(){return[]},s.resolve=s,s.id=7594,e.exports=s},8312:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(9194)}])},9194:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return sq}});var a,t,n,i,c=l(5893),r=l(7294),o=l(9483),d=l.n(o);(a=n||(n={}))[a.LOAD_SAVED_STATE=0]="LOAD_SAVED_STATE",a[a.USER_FILE_INPUT=1]="USER_FILE_INPUT",a[a.GRID_UPDATE=2]="GRID_UPDATE",a[a.CLASSIFICATION_CONFIG=3]="CLASSIFICATION_CONFIG",a[a.SPLUS_TRILOGY_CONFIG=4]="SPLUS_TRILOGY_CONFIG",a[a.SPLUS_IMAGING=5]="SPLUS_IMAGING",a[a.SPLUS_LUPTON_CONFIG=6]="SPLUS_LUPTON_CONFIG",a[a.SPLUS_PHOTO_SPECTRA=7]="SPLUS_PHOTO_SPECTRA",a[a.LEGACY_IMAGING=8]="LEGACY_IMAGING",a[a.SDSS_IMAGING=9]="SDSS_IMAGING",a[a.SDSS_CATALOG=10]="SDSS_CATALOG",a[a.CUSTOM_IMAGE_NEW=11]="CUSTOM_IMAGE_NEW",a[a.CUSTOM_IMAGE_UPDATE=12]="CUSTOM_IMAGE_UPDATE",a[a.CUSTOM_IMAGE_REMOVE=13]="CUSTOM_IMAGE_REMOVE",a[a.CUSTOM_IMAGE_ENABLE=14]="CUSTOM_IMAGE_ENABLE",a[a.CURRENT_VIEW_CHANGE=15]="CURRENT_VIEW_CHANGE";let h=()=>({schemaVersion:14,table:{type:"local",file:null,url:null,selectedColumnsId:[],columns:[],raIndex:null,decIndex:null,processing:!1,isSameFile:!1},grid:{data:void 0,colDef:void 0,api:void 0,isLoaded:!1,currColConfigs:void 0,currTale:void 0},currentView:"settings",cols:{classification:{enabled:!1,type:"categorical",classNames:[],positiveClass:"",negativeClass:"",filterUnclassified:!0,keyMap:{}},sdssCatalog:{selectedColumns:[]},splusImaging:{enabled:!0,type:"trilogy",pixelScale:.4,trilogyConfig:{R:["R","I","F861","Z"],G:["G","F515","F660"],B:["U","F378","F395","F410","F430"],noise:.15,Q:.2},luptonConfig:{R:"I",G:"R",B:"G",stretch:1.4,Q:6.2}},legacyImaging:{enabled:!0,pixelScale:.4,dataRelease:"10"},sdssSpectra:{enabled:!0},splusPhotoSpectra:{enabled:!0,selectedLines:["iso","aper6"]},customImaging:{enabled:!1,columns:[{url:"",fileExtension:"",columnIndex:-1}]}}}),m=h(),u=e=>{let s={...e,table:h().table,grid:h().grid,currentView:h().currentView};d().setItem("tableConfigState",s,(e,s)=>{e&&console.error(e)})};function x(e,s,l){let a={...e};for(let e in s.payload)l(a)[e]=s.payload[e];return u(a),a}let p={[n.LOAD_SAVED_STATE]:(e,s)=>s.payload,[n.USER_FILE_INPUT]:(e,s)=>x(e,s,e=>e.table),[n.CLASSIFICATION_CONFIG]:(e,s)=>x(e,s,e=>e.cols.classification),[n.SPLUS_TRILOGY_CONFIG]:(e,s)=>x(e,s,e=>e.cols.splusImaging.trilogyConfig),[n.SPLUS_IMAGING]:(e,s)=>x(e,s,e=>e.cols.splusImaging),[n.SPLUS_LUPTON_CONFIG]:(e,s)=>x(e,s,e=>e.cols.splusImaging.luptonConfig),[n.SPLUS_PHOTO_SPECTRA]:(e,s)=>x(e,s,e=>e.cols.splusPhotoSpectra),[n.LEGACY_IMAGING]:(e,s)=>x(e,s,e=>e.cols.legacyImaging),[n.SDSS_IMAGING]:(e,s)=>x(e,s,e=>e.cols.sdssSpectra),[n.SDSS_CATALOG]:(e,s)=>x(e,s,e=>e.cols.sdssCatalog),[n.CUSTOM_IMAGE_NEW]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=[...s.payload.prevColumns,{url:"",fileExtension:"",columnIndex:-1}],u(l),l},[n.CUSTOM_IMAGE_UPDATE]:(e,s)=>x(e,s,e=>e.cols.customImaging.columns[s.payload.index]),[n.CUSTOM_IMAGE_REMOVE]:(e,s)=>{let l={...e};return l.cols.customImaging.columns=s.payload.prevColumns.filter((e,l)=>l!=s.payload.index),u(l),l},[n.CUSTOM_IMAGE_ENABLE]:(e,s)=>x(e,s,e=>e.cols.customImaging),[n.GRID_UPDATE]:(e,s)=>x(e,s,e=>e.grid),[n.CURRENT_VIEW_CHANGE]:(e,s)=>{let l={...e};return l.currentView=s.payload,l}},g=(e,s)=>p[s.type](e,s),j=(0,r.createContext)({tcState:m,tcDispatch:()=>{}}),f=e=>{let{children:s}=e,[l,a]=(0,r.useReducer)(g,m);return(0,c.jsx)(j.Provider,{value:{tcState:l,tcDispatch:a},children:s})},y=()=>(0,r.useContext)(j);function b(){let{tcDispatch:e}=y();return(0,r.useEffect)(()=>{d().getItem("tableConfigState",(s,l)=>{s||null===l||14!==l.schemaVersion||e({type:n.LOAD_SAVED_STATE,payload:l})})},[e]),null}var S=l(9008),C=l.n(S),v=l(688),Z=l(2246),I=l(6698),N=l(7083),_=l(8447),w=l(4855),T=l(404);let E="10.5281/zenodo.7268504",L="@software{astrotools,\n    doi = {10.5281/zenodo.7268504},\n    url = {https://doi.org/10.5281/zenodo.7268504},\n    year = {2022},\n    month = oct,\n    publisher = {Zenodo},\n    author = {Cardoso, N. M.},\n    title = {Astrotools: Web-based astronomical tools}\n}",G=e=>{let{show:s,onHide:l}=e,[a,t]=(0,r.useState)(!1),[n,i]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{a&&setTimeout(()=>t(!1),3e3),n&&setTimeout(()=>i(!1),3e3)},[a,n]),(0,c.jsxs)(_.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,c.jsx)(_.Z.Header,{closeButton:!0,children:(0,c.jsx)(_.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"How to cite this software"})}),(0,c.jsxs)(_.Z.Body,{children:[(0,c.jsx)("p",{children:"If you used this software during the production process of your scientific project, please consider citing it with the information provided below."}),(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)(I.Z,{children:"DOI"}),(0,c.jsx)(w.CopyToClipboard,{text:E,onCopy:()=>t(!0),children:(0,c.jsx)(N.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),a&&(0,c.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,c.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:E})]}),(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)(I.Z,{children:"BibTex"}),(0,c.jsx)(w.CopyToClipboard,{text:L,onCopy:()=>i(!0),children:(0,c.jsx)(N.Z,{variant:"link",size:"sm",children:"Copy to Clipboard"})}),n&&(0,c.jsx)("small",{className:"text-success ms-3",children:"Copied!"}),(0,c.jsx)("pre",{className:"pre-scrollabes bg-dark bg-opacity-10 rounded-3 p-3",children:L})]})]})]})};function k(){let[e,s]=(0,r.useState)(!1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(N.Z,{size:"sm",variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>s(!0),children:[(0,c.jsx)(T.X1l,{className:"me-1",size:18}),(0,c.jsx)("span",{children:"Cite this software"})]}),(0,c.jsx)(G,{show:e,onHide:()=>s(!1)})]})}function A(e,s,l){if("ms"===l)switch(s){case"sec":return 1e3*e;case"min":return 6e4*e;case"hour":return 36e5*e;case"day":return 864e5*e;case"week":return 252e5*e;case"month":return 2592e6*e}}function R(e,s){let l=RegExp("^".concat(e,"_?J?d*?$"),"gi");return s.findIndex((e,s)=>null!==l.exec(e))}var F=l(5675),P=l.n(F),O=l(1664),U=l.n(O);function D(){return(0,c.jsx)(Z.Z.Brand,{as:"div",className:"mx-auto",children:(0,c.jsx)(U(),{href:"/",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)(P(),{alt:"AstronInspect",src:"".concat("/","galaxy_128.png"),width:"30",height:"30",className:"d-inline-block align-top"}),(0,c.jsx)("span",{className:"ms-2 fw-bold",children:"AstroInspect"})]})})})}function M(){return(0,c.jsx)(N.Z,{className:"me-2",size:"sm",variant:"outline-primary",href:"https://github.com/nmcardoso/astrotools",target:"_BLANK",children:(0,c.jsx)(T.rFR,{size:20})})}var z=l(9540);function H(){let{tcDispatch:e}=y(),s=(0,r.useCallback)(()=>{e({type:n.CURRENT_VIEW_CHANGE,payload:"settings"})},[]);return(0,c.jsxs)(N.Z,{className:"d-inline-flex align-items-center me-2",onClick:s,children:[(0,c.jsx)(z.x_l,{size:14,className:"me-2"}),(0,c.jsx)("span",{children:"Back"})]})}var q=l(5071),B=l(4055),V=l(1470);function Q(e){let{children:s,title:l=null,placement:a="auto",className:t=""}=e,n=(0,c.jsxs)(B.Z,{id:"help-popover",children:[l&&(0,c.jsx)(B.Z.Header,{as:"h3",children:l}),(0,c.jsx)(B.Z.Body,{children:s})]});return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(q.Z,{trigger:"click",rootClose:!0,placement:a,overlay:n,children:(0,c.jsx)(N.Z,{variant:"link",className:"p-0 d-inline-flex align-items-center ".concat(t),children:(0,c.jsx)(V.CUu,{size:20})})})})}var W=l(1409),K=l(7772),Y=l(4940),J=l(8587),X=l(1096);let $=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:t}=y(),[n,i]=(0,r.useState)(""),[o,d]=(0,r.useState)("all"),[h,m]=(0,r.useState)("all"),[u,x]=(0,r.useState)(!1);return(0,c.jsxs)(_.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,c.jsx)(_.Z.Header,{closeButton:!0,children:(0,c.jsx)(_.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Download current table"})}),(0,c.jsx)(_.Z.Body,{children:(0,c.jsxs)(K.Z,{onSubmit:e=>{e.preventDefault();let s=()=>{let e=[];return[...e="all"===o?a.table.selectedColumnsId.map(e=>"tab:".concat(a.table.columns[e])):a.table.columns.map(e=>"tab:".concat(e)),...a.cols.sdssCatalog.selectedColumns.map(e=>"sdss:".concat(e.table,"_").concat(e.column)),...a.cols.classification.enabled?["ai:class"]:[]]},l=e=>{var s;let{node:l}=e;return(null===(s=l.data)||void 0===s?void 0:s["ai:class"])===void 0},t=e=>{var s;let{node:l}=e;return(null===(s=l.data)||void 0===s?void 0:s["ai:class"])!==void 0},i=()=>"classified"===h?l:"unclassified"===h?t:void 0;console.log("colKeys:",s(),"class",i()),a.grid.api.exportDataAsCsv({suppressQuotes:!0,columnKeys:s(),fileName:n||"AstroInspect",exportedRows:u?"filteredAndSorted":"all",shouldRowBeSkipped:i(),processHeaderCallback:e=>{let{column:s}=e;return"ai:class"===s.getColDef().field?"AstroInspectClass":s.getColDef().headerName}})},className:"mt-3",children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"classDownload",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"2",className:"text-end",children:"File name"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(K.Z.Control,{value:n,onChange:e=>i(e.target.value),placeholder:"File name"}),(0,c.jsx)(Y.Z.Text,{id:"basic-addon2",children:".csv"})]}),(0,c.jsx)(Q,{title:"File name",className:"ms-2",children:"Choose a name and save your classifications in local computer"})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"colFilter",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Classification"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,c.jsx)(K.Z.Check,{inline:!0,checked:"all"===h,label:"all",name:"filterClass",type:"radio",value:"all",id:"filterClass-1",onChange:e=>m("all")}),(0,c.jsx)(K.Z.Check,{inline:!0,checked:"classified"===h,label:"classified only",name:"filterClass",type:"radio",value:"classified",id:"filterClass-2",onChange:e=>m("classified")}),(0,c.jsx)(K.Z.Check,{inline:!0,checked:"unclassified"===h,label:"unclassified only",name:"filterClass",type:"radio",value:"unclassified",id:"filterClass-3",onChange:e=>m("unclassified")}),(0,c.jsxs)(Q,{title:"Filter rows by class",className:"ms-0",children:["This setting will sample the rows based in the classification state:",(0,c.jsxs)("ul",{children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("b",{children:"all: "})," in this case, no filtering is performed and the output table will contain all rows, including both classified and unclassified rows"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("b",{children:"classified only: "})," the output table will contain only classified rows"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("b",{children:"unclassified only: "})," the output table will contain only unclassified rows"]})]})]})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"classFilter",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"2",className:"text-end",children:"Rows"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)("div",{className:"d-flex align-items-center mt-2",children:[(0,c.jsx)(K.Z.Check,{inline:!0,checked:u,label:"filter & sort",name:"filterRow",type:"checkbox",value:"filteredAndSorted",id:"filterRow-2",onChange:e=>x(!0)}),(0,c.jsxs)(Q,{title:"Filter rows by filter",className:"ms-0",children:["This setting will sample the rows based in the following criteria:",(0,c.jsxs)("ul",{children:[(0,c.jsxs)("li",{children:["If this option is ",(0,c.jsx)("b",{children:"selected"}),", the same filters applied in the application will also be applied to the output table, that is, it will contain the ",(0,c.jsx)("u",{children:"same rows that you are seeing in the application"})," and in the same order."]}),(0,c.jsxs)("li",{children:["If this option is ",(0,c.jsx)("b",{children:"unselected"}),", no filtering is performed and the output table will have the ",(0,c.jsx)("u",{children:"same rows as the input table"})," and in same order."]})]}),(0,c.jsx)("b",{children:"Note: "})," If you have not applied any filtering or sorting to the columns, then the result will be the same for any option in this setting."]})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"my-3",controlId:"classDownloadBtn",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"2",className:"text-end"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsx)(Y.Z,{children:(0,c.jsxs)(N.Z,{variant:"primary",type:"submit",children:[(0,c.jsx)(X.xOH,{size:18,className:"me-1"})," ","Download table"]})})})]})]})})]})};function ee(){let{tcState:e}=y(),[s,l]=(0,r.useState)(!1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(N.Z,{variant:"outline-primary",className:"d-inline-flex align-items-center",onClick:()=>l(!0),children:[(0,c.jsx)(X.xOH,{size:19,className:"me-1"}),(0,c.jsx)("span",{children:"Download"})]}),(0,c.jsx)($,{show:s,onHide:()=>l(!1)})]})}function es(){let{tcState:e}=y();return(0,c.jsx)(Z.Z,{bg:"light",expand:"lg",children:(0,c.jsxs)(v.Z,{children:[(0,c.jsxs)("div",{children:["grid"==e.currentView&&(0,c.jsx)(H,{}),e.grid.isLoaded&&(0,c.jsx)(ee,{})]}),(0,c.jsx)(D,{}),(0,c.jsxs)("div",{children:[(0,c.jsx)(M,{}),(0,c.jsx)(k,{})]})]})})}var el=l(7142),ea=l(8223),et=l(7615),en=l.n(et);function ei(e){let{children:s,value:l=null,className:a="",onClose:t=()=>{},closeable:n=!0}=e;return(0,c.jsxs)("div",{className:"".concat(en().chip," ").concat(a),children:[s,n&&(0,c.jsx)("span",{className:en().closebtn,onClick:e=>{t(e,l)},children:"\xd7"})]})}let ec=(e,s,l)=>{let a=e.trim();a&&!s.includes(a)&&(s.push(a),l({type:n.CLASSIFICATION_CONFIG,payload:{classNames:s}}))},er=(e,s,l)=>{let a=s.filter(s=>s!=e);l({type:n.CLASSIFICATION_CONFIG,payload:{classNames:a}})};function eo(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.classification,[a,t]=(0,r.useState)(""),[n,i]=(0,r.useState)(!1);return(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"classNames",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:1,children:"Classes"}),(0,c.jsxs)(W.Z,{sm:8,children:[(0,c.jsx)(K.Z,{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),ec(a,l.classNames,s),t("")},children:(0,c.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(K.Z.Control,{placeholder:"Class name",value:a,onChange:e=>t(e.target.value)}),(0,c.jsxs)(N.Z,{variant:"primary",type:"submit",className:"d-inline-flex align-items-center",children:[(0,c.jsx)(V.poH,{size:20,className:"me-1"}),(0,c.jsx)("span",{children:"Add"})]})]}),(0,c.jsxs)(Q,{title:"Class Name",className:"ms-1",children:["Type the class name and press ",(0,c.jsx)("kbd",{children:"ENTER"})," or click Add button"]}),(0,c.jsxs)(N.Z,{style:{whiteSpace:"nowrap"},className:"ms-4",variant:"outline-primary",disabled:0==e.cols.classification.classNames.length,onClick:()=>i(!0),children:[(0,c.jsx)(z.P2_,{size:20,className:"me-1"})," Hotkeys"]}),(0,c.jsx)(Q,{title:"Hotkeys",className:"ms-1",children:"Classify your table quickly by configuring keyboard keys to select classes"}),(0,c.jsx)(ed,{show:n,onHide:()=>i(!1)})]})}),l.classNames.map(a=>(0,c.jsxs)(ei,{className:"mb-1 me-1",onClose:()=>er(a,l.classNames,s),children:[a,a in e.cols.classification.keyMap&&(0,c.jsxs)("span",{children:[" (",(0,c.jsx)("b",{children:e.cols.classification.keyMap[a].toUpperCase()}),")"]})]},"cname_".concat(a)))]})]})}function ed(e){let{show:s,onHide:l}=e,{tcState:a,tcDispatch:t}=y(),i=a.cols.classification,[o,d]=(0,r.useState)(-1),h=(0,r.useCallback)(e=>{e.stopPropagation(),/^[\w\d]$/i.test(e.key)&&-1!=o&&t({type:n.CLASSIFICATION_CONFIG,payload:{keyMap:{...a.cols.classification.keyMap,[o]:e.key}}})},[t,a,o]);return(0,r.useEffect)(()=>(s?document.addEventListener("keydown",h,!0):document.removeEventListener("keydown",h,!0),()=>{document.removeEventListener("keydown",h,!0)}),[h,s]),(0,c.jsxs)(_.Z,{show:s,onHide:l,animation:!1,centered:!0,children:[(0,c.jsx)(_.Z.Header,{closeButton:!0,children:(0,c.jsx)(_.Z.Title,{id:"contained-modal-title-vcenter",children:"Hotkeys configuration"})}),(0,c.jsxs)(_.Z.Body,{children:[(0,c.jsx)("p",{className:"mb-3",children:"Select a class below and press an alphanumeric (A-Z, 0-9) character on the keyboard. After associating the keyboard shortcuts for the desired classes, just click on the table row and press the key referring to the class."}),(0,c.jsxs)(K.Z,{onSubmit:e=>e.preventDefault(),children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-3",controlId:"hotkeyClass",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:2,children:"Class"}),(0,c.jsx)(W.Z,{sm:10,children:(0,c.jsxs)(K.Z.Select,{value:o,onChange:e=>d(e.target.value),children:[(0,c.jsx)("option",{value:-1,children:"Select a class"}),i.classNames.map(e=>(0,c.jsx)("option",{value:e,children:e},e))]})})]}),(0,c.jsxs)(J.Z,{className:"d-inline-flex align-items-center",children:[(0,c.jsx)(W.Z,{sm:2,children:"Hotkey"}),(0,c.jsx)(W.Z,{sm:3,children:(0,c.jsx)(K.Z.Control,{readOnly:!0,type:"text",size:"lg",value:i.keyMap[o]?i.keyMap[o].toUpperCase():"",style:{fontWeight:800,textAlign:"center"}})}),(0,c.jsx)(W.Z,{children:(0,c.jsx)(N.Z,{className:"ps-0",variant:"link",onClick:()=>{let e=a.cols.classification.keyMap;o in e&&(delete e[o],t({type:n.CLASSIFICATION_CONFIG,payload:{keyMap:e}}))},children:"Clear"})})]})]})]})]})}function eh(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.classification;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"classCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show classification column",checked:l.enabled,onChange:e=>s({type:n.CLASSIFICATION_CONFIG,payload:{enabled:e.target.checked}})}),(0,c.jsx)(Q,{title:"Enable Classifications",className:"ms-1",children:"Select this option if you want to classify the table, unsect to hide the classification column"})]})})]}),(0,c.jsx)(eo,{})]})}let em=["iso","aper3","aper6","auto","petro","pstotal"];function eu(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.sdssSpectra,a=e.cols.splusPhotoSpectra.selectedLines,t=(e,l)=>{l.includes(e)?s({type:n.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:l.filter(s=>s!=e)}}):s({type:n.SPLUS_PHOTO_SPECTRA,payload:{selectedLines:[...l,e]}})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"sloanSpecCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:3,children:"SDSS spectra"}),(0,c.jsx)(W.Z,{sm:9,className:"d-flex align-items-center",children:(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show SDSS spectra column",checked:l.enabled,onChange:e=>s({type:n.SDSS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,c.jsx)("hr",{className:"my-4"}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:3,children:"S-PLUS photo-spectra"}),(0,c.jsx)(W.Z,{sm:9,className:"d-flex align-items-center",children:(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show S-PLUS photo-spectra column",checked:e.cols.splusPhotoSpectra.enabled,onChange:()=>s({type:n.SPLUS_PHOTO_SPECTRA,payload:{enabled:!e.cols.splusPhotoSpectra.enabled}})})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splus-photospec-check",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:3,children:"Selected lines"}),(0,c.jsx)(W.Z,{sm:9,className:"d-flex align-items-center",children:em.map(e=>(0,c.jsxs)(K.Z.Check,{inline:!0,type:"checkbox",id:"splus-photospectra-line-".concat(e),className:"me-3",children:[(0,c.jsx)(K.Z.Check.Input,{type:"checkbox",checked:a.includes(e),onChange:()=>t(e,a)}),(0,c.jsx)(K.Z.Check.Label,{children:e})]},e))})]})]})}function ex(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.legacyImaging;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"legacyImagingCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show Legacy Survey RGB images column",checked:l.enabled,onChange:e=>s({type:n.LEGACY_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,c.jsx)(J.Z,{children:(0,c.jsx)(W.Z,{sm:5,children:(0,c.jsxs)(Y.Z,{className:"mb-3",children:[(0,c.jsx)(Y.Z.Text,{id:"legacyImagingPixScale",children:"Pixel Scale"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"legacyImagingPixScale",value:l.pixelScale,onChange:e=>s({type:n.LEGACY_IMAGING,payload:{pixelScale:e.target.value}})})]})})}),(0,c.jsx)(J.Z,{children:(0,c.jsx)(W.Z,{sm:5,children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{children:"DR"}),(0,c.jsxs)(K.Z.Select,{value:l.dataRelease,onChange:e=>s({type:n.LEGACY_IMAGING,payload:{dataRelease:e.target.value}}),children:[(0,c.jsx)("option",{value:"10",children:"10"}),(0,c.jsx)("option",{value:"9",children:"9"})]})]})})})]})}var ep=l(1549),eg=l.n(ep);function ej(e){let{children:s,className:l="btn-light",onClick:a=()=>{}}=e;return(0,c.jsx)("div",{className:"".concat(eg().chip," ").concat(l),onClick:a,children:s})}let ef=["U","F378","F395","F410","F430","G","F515","R","F660","I","F861","Z"];function ey(e){let{band:s,channel:l,variant:a}=e,{tcState:t,tcDispatch:i}=y(),r=t.cols.splusImaging.trilogyConfig,{R:o,G:d,B:h}=r,m=r[l].includes(s)?"btn-".concat(a):"btn-outline-".concat(a);return(0,c.jsx)(ej,{className:"".concat(m," me-1"),onClick:()=>i({type:n.SPLUS_TRILOGY_CONFIG,payload:function(e,s,l){let a={...e};for(let t in e)t!=s&&(a[t]=e[t].filter(e=>e!=l));return a[s].includes(l)?a[s]=a[s].filter(e=>e!=l):a[s].push(l),a}({R:o,G:d,B:h},l,s)}),children:s})}function eb(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.splusImaging.trilogyConfig;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusTrilogyR",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"R"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[ef.map(e=>(0,c.jsx)(ey,{band:e,channel:"R",variant:"danger"},"R_".concat(e))),(0,c.jsxs)(Q,{title:"Red Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,c.jsx)("span",{className:"text-danger",children:"red"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusTrilogyG",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"G"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[ef.map(e=>(0,c.jsx)(ey,{band:e,channel:"G",variant:"success"},"G_".concat(e))),(0,c.jsxs)(Q,{title:"Green Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,c.jsx)("span",{className:"text-success",children:"green"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusTrilogyB",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"B"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[ef.map(e=>(0,c.jsx)(ey,{band:e,channel:"B",variant:"primary"},"B_".concat(e))),(0,c.jsxs)(Q,{title:"Blue Composition",className:"ms-1",children:["Choose the S-PLUS bands that will be mapped to the"," ",(0,c.jsx)("span",{className:"text-primary",children:"blue"})," channel of the"," ","RGB image. Each channel must be mapped by up to 1 S-PLUS filter"]})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusTrilogyParams",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,c.jsx)(W.Z,{sm:9,children:(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{className:"mb-3",children:[(0,c.jsx)(Y.Z.Text,{id:"trilogy-param-noise",children:"Noise"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Noise","aria-describedby":"trilogy-param-noise",value:l.noise,onChange:e=>s({type:n.SPLUS_TRILOGY_CONFIG,payload:{noise:e.target.value}})})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{className:"mb-3",children:[(0,c.jsx)(Y.Z.Text,{id:"trilogy-param-q",children:"Q"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Q","aria-describedby":"trilogy-param-q",value:l.Q,onChange:e=>s({type:n.SPLUS_TRILOGY_CONFIG,payload:{Q:e.target.value}})})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{className:"mb-3",children:[(0,c.jsx)(Y.Z.Text,{id:"pixelScale",children:"Pixel scale"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Pixel scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:n.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function eS(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.splusImaging.luptonConfig;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusLuptonColors",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Colors"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{children:"R"}),(0,c.jsx)(K.Z.Select,{value:l.R,onChange:e=>s({type:n.SPLUS_LUPTON_CONFIG,payload:{R:e.target.value}}),children:ef.map(e=>(0,c.jsx)("option",{children:e},e))})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{children:"G"}),(0,c.jsx)(K.Z.Select,{value:l.G,onChange:e=>s({type:n.SPLUS_LUPTON_CONFIG,payload:{G:e.target.value}}),children:ef.map(e=>(0,c.jsx)("option",{children:e},e))})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{children:"B"}),(0,c.jsx)(K.Z.Select,{value:l.B,onChange:e=>s({type:n.SPLUS_LUPTON_CONFIG,payload:{B:e.target.value}}),children:ef.map(e=>(0,c.jsx)("option",{children:e},e))})]})})]})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusLuptonParams",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Params"}),(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{id:"lupton-param-noise",children:"Stretch"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Stretch","aria-describedby":"lupton-param-noise",value:l.stretch,onChange:e=>s({type:n.SPLUS_LUPTON_CONFIG,payload:{stretch:e.target.value}})})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{children:[(0,c.jsx)(Y.Z.Text,{id:"lupton-param-q",children:"Q"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Q","aria-describedby":"lupton-param-q",value:l.Q,onChange:e=>s({type:n.SPLUS_LUPTON_CONFIG,payload:{Q:e.target.value}})})]})}),(0,c.jsx)(W.Z,{children:(0,c.jsxs)(Y.Z,{className:"mb-3",children:[(0,c.jsx)(Y.Z.Text,{id:"pixelScale",children:"Pixel Scale"}),(0,c.jsx)(K.Z.Control,{"aria-label":"Pixel Scale","aria-describedby":"pixelScale",value:e.cols.splusImaging.pixelScale,onChange:e=>s({type:n.SPLUS_IMAGING,payload:{pixelScale:e.target.value}})})]})})]})})]})]})}function eC(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.splusImaging;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"splusImagingCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show S-PLUS RGB images column",checked:l.enabled,onChange:e=>s({type:n.SPLUS_IMAGING,payload:{enabled:e.target.checked}})})})]}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"classCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Type"}),(0,c.jsx)(W.Z,{sm:5,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsxs)(K.Z.Select,{defaultValue:l.type,onChange:e=>s({type:n.SPLUS_IMAGING,payload:{type:e.target.value}}),children:[(0,c.jsx)("option",{value:"trilogy",children:"Trilogy"}),(0,c.jsx)("option",{value:"lupton",children:"Lupton"})]}),(0,c.jsxs)(Q,{title:"Image Type",className:"ms-1",children:["The algorithm used to make RGB stamps from the FITS file",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Trilogy: "})," The Trilogy algorithm",(0,c.jsx)("br",{}),(0,c.jsx)("b",{children:"Lupton: "})," The Lupton method"]})]})})]}),"trilogy"==l.type?(0,c.jsx)(eb,{}):(0,c.jsx)(eS,{})]})}var ev=l(8582),eZ=l(5555),eI=l(8937);let eN=Symbol("Queued"),e_=Symbol("Loading"),ew=Symbol("Load Error"),eT=()=>(0,c.jsxs)("span",{className:"text-dark",children:[(0,c.jsx)(eI.xps,{size:15})," Queued"]}),eE=()=>(0,c.jsxs)("span",{className:"text-primary",children:[(0,c.jsx)(eZ.uKn,{size:15})," Downloading"]}),eL=()=>(0,c.jsxs)("span",{className:"text-danger",children:[(0,c.jsx)(eZ.wr$,{size:15})," Server Error"]});function eG(e){let s=(0,r.useMemo)(()=>e.value===eN?eT:e.value===e_?eE:e.value===ew?eL:()=>(0,c.jsx)("span",{children:e.value}),[e.value]);return(0,c.jsx)(s,{})}let ek=e=>{let{show:s,onHide:l,src:a,size:t,zoomWidth:n,zoomHeight:i}=e;return(0,c.jsx)(_.Z,{centered:!0,show:s,onHide:l,animation:!1,size:t,children:(0,c.jsx)(_.Z.Body,{className:"mx-auto px-0 py-2",children:(0,c.jsx)("img",{src:a,width:n,height:i,alt:""})})})},eA=()=>(0,c.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,c.jsxs)("span",{className:"text-dark",children:[(0,c.jsx)(eI.xps,{size:15})," Queued"]})}),eR=()=>(0,c.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,c.jsxs)("span",{className:"text-primary",children:[(0,c.jsx)(eZ.uKn,{size:15})," Downloading"]})}),eF=()=>(0,c.jsx)("div",{className:"border d-flex align-items-center justify-content-center",style:{width:120,height:120,backgroundColor:"#f5f5f5"},children:(0,c.jsxs)("span",{className:"text-danger",children:[(0,c.jsx)(eZ.wr$,{size:15})," Server Error"]})});function eP(e){let{src:s,zoomWidth:l,zoomHeight:a,modalSize:t=""}=e,[n,i]=(0,r.useState)(!1),o=(0,r.useMemo)(()=>s===eN?eA:s===e_?eR:s===ew?eF:()=>(0,c.jsx)("img",{src:s,alt:"",height:120,style:{cursor:"zoom-in"},onClick:()=>i(!0)}),[s]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o,{}),(0,c.jsx)(ek,{show:n,onHide:()=>i(!1),src:s,size:t,zoomWidth:l,zoomHeight:a})]})}function eO(e){let{zoomWidth:s,zoomHeight:l,modalSize:a=""}=e;return function(e){return(0,c.jsx)(eP,{src:e.value,zoomWidth:s,zoomHeight:l,modalSize:a})}}var eU=l(7460),eD=l.n(eU),eM=l(918),ez=l(2634);let eH=e=>{if(e)return new Promise((s,l)=>{eD().parse(e,{complete:e=>{let{data:l}=e;return s(l)},error:e=>l(e),skipEmptyLines:!0,header:!0,dynamicTyping:!0,transformHeader:(e,s)=>"tab:".concat(e)})})},eq=e=>new Promise((s,l)=>{eD().parse(e,{complete:e=>{var a;if(e.errors.length>0)return l(e.errors);s(null===(a=e.data)||void 0===a?void 0:a[0])},preview:1})}),eB=e=>new Promise((s,l)=>{(async()=>{await (0,eM.RL)({file:await e.arrayBuffer(),onComplete:e=>s(e),compressors:ez.F})})().catch(e=>l(e))}),eV=async e=>(0,eM.tI)(await e.arrayBuffer()).schema.filter(e=>"schema"!==e.name).map(e=>e.name);class eQ{getFileExt(){if(!this.ext){var e;this.ext=null===(e=this.file.name.split(".").pop())||void 0===e?void 0:e.toLowerCase()}return this.ext}async read(){if("csv"===this.getFileExt())return await eH(this.file);if("parquet"===this.getFileExt()){let e=await eB(this.file),s=await this.getColumns();return s?e.map(e=>Object.fromEntries(Object.entries(e).map(e=>{let[l,a]=e;return["tab:".concat(s[l]),a]}))):e}}async getColumns(){return["csv","tsv","dat","txt"].includes(this.getFileExt())?this.columns=await eq(this.file):["parquet","parq","par","pq"].includes(this.getFileExt())&&(this.columns=await eV(this.file)),this.columns}constructor(e){this.file=e,this.ext=void 0,this.columns=void 0}}let eW={field:"ai:id",maxWidth:80,headerName:"#"},eK={field:"ai:class",flex:1,headerName:"class",filter:!0,cellRenderer:function(e){let{tcState:s}=y();return(0,c.jsxs)(K.Z.Select,{value:e.value,onChange:s=>{var l;null===(l=e.api.getRowNode(e.data["ai:id"]))||void 0===l||l.setDataValue("ai:class",s.target.value)},children:[(0,c.jsx)("option",{value:"",children:"-"}),s.cols.classification.classNames.map(e=>(0,c.jsx)("option",{value:e,children:e},e))]})}},eY={field:"img:splus",flex:1,headerName:"splus",cellRenderer:eO({zoomHeight:650,modalSize:"lg"})},eJ={field:"img:legacy",flex:1,headerName:"legacy",cellRenderer:eO({zoomHeight:650,modalSize:"lg"})},eX={field:"img:sdss_spec",flex:1,headerName:"spec",cellRenderer:eO({zoomHeight:620,modalSize:"lg"})},e$={field:"img:splus_photospec",flex:1,headerName:"photo spec",cellRenderer:eO({zoomHeight:625,modalSize:"lg"})},e0=e=>({field:"img:custom_".concat(e),flex:1,headerName:"custom ".concat(e+1),cellRenderer:eO({zoomHeight:650,modalSize:"lg"})}),e1=(e,s)=>({field:"sdss:".concat(e,"_").concat(s),flex:1,headerName:s.toLowerCase(),filter:!0,cellRenderer:eG}),e2=e=>({field:"tab:".concat(e),flex:1,headerName:e.toLowerCase(),filter:!0});class e5{async load(e){let s=new eQ(e);return await s.read()}getHeaderSummary(e){let s=R("ra",e),l=R("dec",e);return{raIndex:s,decIndex:l,columns:e,positionFound:s>-1&&l>-1}}async getTableSummary(e){let s=new eQ(e),l=await s.getColumns();return l?this.getHeaderSummary(l):void 0}getColDefs(e){let s=[eW],l={};if(e.cols.classification.enabled&&(s.push(eK),l["ai:class"]=void 0),e.table.selectedColumnsId)for(let l of e.table.selectedColumnsId){let a=e.table.columns[l];s.push(e2(a))}if(e.cols.sdssCatalog.selectedColumns)for(let a of e.cols.sdssCatalog.selectedColumns)s.push(e1(a.table,a.column)),l["sdss:".concat(a.table,"_").concat(a.column)]=eN;return e.cols.sdssSpectra.enabled&&(s.push(eX),l["img:sdss_spec"]=eN),e.cols.splusPhotoSpectra.enabled&&(s.push(e$),l["img:splus_photospec"]=eN),e.cols.legacyImaging.enabled&&(s.push(eJ),l["img:legacy"]=eN),e.cols.splusImaging.enabled&&(s.push(eY),l["img:splus"]=eN),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((e,a,t)=>{s.push(e0(a)),l["img:custom_".concat(a)]=eN}),{colDef:s,initVal:l}}}var e3=new e5;function e4(e){let{onChange:s}=e,{tcState:l}=y(),a=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(l.table.file&&a.current){let e=new DataTransfer;e.items.add(l.table.file);let s=e.files;a.current.files=s}},[]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{children:"Select a table from computer to open"}),(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"tableFile",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Table"}),(0,c.jsx)(W.Z,{sm:6,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)(K.Z.Control,{type:"file",onChange:s,ref:a}),(0,c.jsxs)(Q,{title:"Local Upload",className:"ms-1",children:["Load a table available in local computer. The only required columns are ",(0,c.jsx)("code",{children:"RA"})," and ",(0,c.jsx)("code",{children:"DEC"})," in degrees.",(0,c.jsx)("br",{}),(0,c.jsx)("u",{children:"Available formars"}),": ",(0,c.jsx)("code",{children:"CSV"}),", ",(0,c.jsx)("code",{children:"TSV"}),", ",(0,c.jsx)("code",{children:"DAT"}),", \xa0",(0,c.jsx)("code",{children:"PARQUET"})]})]})})]})]})}function e8(){return(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"tableFile",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"URL"}),(0,c.jsx)(W.Z,{sm:"5",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)(K.Z.Control,{placeholder:"File URL"}),(0,c.jsx)(Q,{title:"Remote Upload",className:"ms-1",children:"Loads a table available remotely over the internet"})]})}),(0,c.jsx)(W.Z,{sm:"2",className:"d-flex align-items-center",children:(0,c.jsx)(N.Z,{variant:"link",className:"px-1 py-1",children:"Load Example"})})]})}(t=i||(i={})).unloaded="unloaded",t.loading="loading",t.success="sucess",t.positionNotFound="positionNotFound",t.error="error";let e9=e=>{let{state:s}=e;return"loading"==s?(0,c.jsx)("p",{className:"text-secondary",children:"Loading table..."}):"sucess"==s?(0,c.jsxs)("p",{className:"text-success",children:[(0,c.jsx)(ev.dZ6,{})," RA and DEC columns successfully detected"]}):"positionNotFound"==s?(0,c.jsxs)("p",{className:"text-danger",children:[(0,c.jsx)(ev.apv,{})," RA or DEC columns not detected"]}):"error"==s?(0,c.jsxs)("p",{className:"text-danger",children:[(0,c.jsx)(ev.apv,{})," Failed to load this table, check if it's a valid csv file"]}):null},e6=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:t}=y(),[i,o]=(0,r.useState)(-1);return(0,c.jsxs)(_.Z,{show:s,onHide:l,animation:!1,centered:!0,children:[(0,c.jsx)(_.Z.Header,{closeButton:!0,children:(0,c.jsx)(_.Z.Title,{id:"contained-modal-title-vcenter",children:"Select a column"})}),(0,c.jsx)(_.Z.Body,{children:(0,c.jsx)(K.Z,{children:(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{xs:10,children:(0,c.jsxs)(K.Z.Select,{defaultValue:-1,onChange:e=>o(parseInt(e.target.value)),children:[(0,c.jsx)("option",{value:-1,children:"Select a column to add"}),a.table.columns.map((e,s)=>({colName:e,originalIndex:s})).filter(e=>!a.table.selectedColumnsId.includes(e.originalIndex)).map(e=>(0,c.jsx)("option",{value:e.originalIndex,children:e.colName},e.originalIndex))]})}),(0,c.jsx)(W.Z,{children:(0,c.jsx)(N.Z,{variant:"success",onClick:()=>{i>=0&&!a.table.selectedColumnsId.includes(i)&&t({type:n.USER_FILE_INPUT,payload:{selectedColumnsId:[...a.table.selectedColumnsId,i]}})},children:"Add"})})]})})})]})};function e7(){let{tcState:e,tcDispatch:s}=y(),l=e.table,[a,t]=(0,r.useState)("unloaded"),[i,o]=(0,r.useState)(!1),d=(l,a)=>{s({type:n.USER_FILE_INPUT,payload:{selectedColumnsId:e.table.selectedColumnsId.filter(e=>e!=a)}})};return(0,c.jsxs)(c.Fragment,{children:["local"==l.type?(0,c.jsx)(e4,{onChange:l=>{if(l.target.files.length>0){let a=l.target.files[0];t("loading"),e3.getTableSummary(a).then(l=>{if(null==l?void 0:l.positionFound){var i,c,r;let o=a.name===(null===(i=e.table.file)||void 0===i?void 0:i.name)||a.size===(null===(c=e.table.file)||void 0===c?void 0:c.size)||a.lastModified===(null===(r=e.table.file)||void 0===r?void 0:r.lastModified);o||s({type:n.GRID_UPDATE,payload:{data:[],colDefs:[]}}),s({type:n.USER_FILE_INPUT,payload:{type:"local",columns:l.columns,selectedColumnsId:[l.raIndex,l.decIndex],raIndex:l.raIndex,decIndex:l.decIndex,file:a,isSameFile:o}}),t("sucess")}else t("positionNotFound")}).catch(e=>{t("error")})}}}):(0,c.jsx)(e8,{}),(0,c.jsx)(e9,{state:a}),l.selectedColumnsId.length>0&&(0,c.jsxs)("div",{children:[(0,c.jsx)("span",{className:"fw-bold",children:"Selected columns:"})," ",l.selectedColumnsId.map(e=>(0,c.jsx)(ei,{value:e,className:"mb-1 me-1",onClose:d,closeable:e!=l.raIndex&&e!=l.decIndex,children:l.columns[e]},"sourceColIdx_".concat(e))),(0,c.jsx)(N.Z,{variant:"link",className:"py-0",onClick:()=>o(!0),children:"Add more"})]}),(0,c.jsx)(e6,{show:i,onHide:()=>o(!1)})]})}var se=l(9797),ss=l(9800);class sl{callFunction(e){for(var s=arguments.length,l=Array(s>1?s-1:0),a=1;a<s;a++)l[a-1]=arguments[a];return new Promise((s,a)=>{this.currentRequests.push({resolve:s,reject:a,fnToCall:e,args:l}),this.tryNext()})}tryNext(){if(this.runningRequests<this.maxConcurrentRequests){let e=this.currentRequests.shift();if(e){this.runningRequests++;let s=e.args;e.fnToCall.apply(null,s).then(s=>e.resolve(s)).catch(s=>e.reject(s)).finally(()=>{this.runningRequests--,this.tryNext()})}}}clear(){this.currentRequests=[]}constructor(e=1){this.currentRequests=[],this.runningRequests=0,this.maxConcurrentRequests=e}}class sa{create(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e in this.pool||(this.pool[e]=new sl(s))}enqueue(e,s){for(var l=arguments.length,a=Array(l>2?l-2:0),t=2;t<l;t++)a[t-2]=arguments[t];return this.pool[e].callFunction(s,...a)}getSignal(){return this.controller.signal}clear(e){if(e)this.pool[e].clear();else for(let e in this.pool)this.pool[e].clear()}constructor(){this.pool={},this.controller=new AbortController}}let st=new sa;var sn=l(7066),si=l(4400),sc=l.n(si),sr=l(6772);st.create("sdss_cone_spec",4),st.create("sdss_sql",2),st.create("sdss_batch_query",2),st.create("sdss_query",2);let so=new sr.S({defaultOptions:{queries:{staleTime:A(1,"day","ms")}}});class sd{getQuery(e,s,l,a){return"SELECT p.fiber2Mag_z ".concat(a.map(e=>"t.".concat(e)).join(","),"\n    FROM PhotoObj p, dbo.fGetNearbyObjEq(326.8952189, 0.7732093, 0.02) n\n    WHERE p.objID = n.objID")}getCrossIdQuery(e,s){let l="photo"==this.objType?"objID":"specObjID";return"\n    SELECT \n      ".concat(s.map(e=>"t.".concat(e)).join(","),"\n    FROM #upload u\n      JOIN #x x ON x.up_id = u.up_id\n      JOIN ").concat(e," t ON t.").concat(this.pkColumn||l," = x.").concat(l,"\n    ORDER by x.up_id\n    ").trim()}constructor(e){let{objType:s="photo",raColumn:l="ra",decColumn:a="dec",pkColumn:t=null}=e||{};this.raColumn=l,this.decColumn=a,this.pkColumn=t,this.objType=s}}let sh={PhotoTag:{searchStrategy:new sd,type:"view"},SpecObjAll:{searchStrategy:new sd({objType:"spectro"}),type:"table"},emissionLinesPort:{searchStrategy:new sd({objType:"spectro"}),type:"table"},TwoMass:{searchStrategy:new sd,type:"table"},zooSpec:{searchStrategy:new sd,type:"table"},zooNoSpec:{searchStrategy:new sd,type:"table"},zoo2MainSpecZ:{searchStrategy:new sd({pkColumn:"dr8objid"}),type:"table"}};class sm{async getObjSpecId(e,s){try{return(await so.fetchQuery({queryKey:["sdss-service-specid",e,s],queryFn:()=>sn.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SpectroQuery/ConeSpectro",{params:{ra:e,dec:s,radius:.01667,limit:1,format:"xml",specparams:"specObjID",imgparams:"none",zWarning:"on"},signal:st.getSignal(),transformResponse:e=>{let s=new DOMParser().parseFromString(e,"application/xml").querySelector('Table[name="Table1"] > Row > Item[name="specObjID"]');return null==s?void 0:s.textContent}})})).data}catch(e){console.log(typeof e),console.log(e)}}getTables(){return Object.keys(sh)}async getColumns(e){var s,l;let a;console.log(a="table"==sh[e].type?"SELECT name, description, unit \n      FROM DBColumns \n      WHERE tablename='".concat(e,"'"):"\n      SELECT tc.name name, tc.description description, tc.unit unit\n      FROM DBColumns tc\n      INNER JOIN DBViewCols vc ON vc.parent = tc.tablename AND vc.name = tc.name\n      WHERE vc.viewname='".concat(e,"' \n      ").trim());let t="".concat("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/SqlSearch","?cmd=").concat(encodeURIComponent(a),"&format=json");return null===(l=(await so.fetchQuery({queryKey:["sdss-service-columns",e],queryFn:()=>sn.Z.get(t)})).data)||void 0===l?void 0:null===(s=l[0])||void 0===s?void 0:s.Rows}getCsv(e){return"index,ra,dec\r\n"+(e.map(e=>"".concat(e.index,",").concat(e.ra,",").concat(e.dec)).join("\r\n")||"")}}class su extends sm{async fetch(){let e=await this.getObjSpecId(this.ra,this.dec);if(console.log(e),e)return await so.fetchQuery({queryKey:[e],queryFn:()=>sn.Z.get("https://astrotools.vercel.app/spec",{responseType:"blob",signal:st.getSignal(),params:{id:e}})})}constructor(e,s){super(),this.ra=e,this.dec=s}}class sx extends sm{async fetch(){let e=sh[this.table].searchStrategy,s=e.getCrossIdQuery(this.table,[this.column]);return await so.fetchQuery({queryKey:["sdss-query",this.ra,this.dec,this.table,this.column],queryFn:()=>sn.Z.get("https://skyserver.sdss.org/dr18/SkyServerWS/SearchTools/CrossIdSearch",{params:{searchtool:"CrossID",searchType:e.objType,photoScope:"nearPrim",spectroScope:"nearPrim",photoUpType:"ra-dec",spectroUpType:"ra-dec",radius:.016667,firstcol:1,paste:this.getCsv([{index:0,ra:this.ra,dec:this.dec}]),uquery:s,format:"JSON"},transformResponse:e=>{var s;let l=sc()({storeAsString:!0}).parse(e).find(e=>"Table1"==e.TableName).Rows;if(l.length>0)return null===(s=l[0])||void 0===s?void 0:s[this.column]}})})}constructor(e,s,l,a){super(),this.ra=e,this.dec=s,this.table=l,this.column=a}}var sp=l(9282);let sg=e=>{let{items:s,active:l,onClick:a,height:t,className:n}=e;return(0,c.jsx)(ea.Z,{className:"".concat(n," overflow-auto"),style:{height:t},children:s.map((e,s)=>(0,c.jsx)(ea.Z.Item,{action:!0,active:l==e,onClick:l=>a({title:e,index:s,event:l}),children:e},s))})},sj=e=>{let{items:s,active:l,onClick:a,height:t,className:n}=e;return(0,c.jsx)(ea.Z,{className:"".concat(n," overflow-auto"),style:{height:t},children:s.map((e,s)=>(0,c.jsx)(ea.Z.Item,{action:!0,variant:l&&l.includes(e)?"primary":"",onClick:l=>a({title:e,index:s,event:l}),children:e},s))})},sf=e=>{let{className:s,height:l}=e;return(0,c.jsxs)(ea.Z,{className:"".concat(s," overflow-auto"),style:{height:l},children:[(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:6})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:9})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:4})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:5})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:11})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:7})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:8})}),(0,c.jsx)(sp.Z,{as:ea.Z.Item,animation:"glow",children:(0,c.jsx)(sp.Z,{xs:5})})]})};function sy(e){let{items:s=[],active:l=[],multiple:a=!1,placeholder:t=!1,onClick:n=()=>{},height:i=260,className:r=""}=e;return(0,c.jsx)(c.Fragment,{children:t?(0,c.jsx)(sf,{className:r,height:i}):a?(0,c.jsx)(sj,{items:s,active:l,onClick:n,height:i,className:r}):(0,c.jsx)(sg,{items:s,active:l,onClick:n,height:i,className:r})})}var sb=l(4908),sS=l.n(sb);let sC=new sm,sv=sC.getTables(),sZ=e=>{let{show:s,onHide:l}=e,{tcState:a,tcDispatch:t}=y(),[i,o]=(0,r.useState)(sv[0]),[d,h]=(0,r.useState)(""),[m,u]=(0,r.useState)([]),[x,p]=(0,r.useState)(!0),g=a.cols.sdssCatalog.selectedColumns;(0,r.useEffect)(()=>{sC.getColumns(i).then(e=>{p(!1),u(e)}).catch(()=>{})},[i]);let j=(0,r.useMemo)(()=>null==m?void 0:m.map(e=>e.name),[m])||[],f=(0,r.useMemo)(()=>null==m?void 0:m.find(e=>e.name==d),[m,d]),b=(0,r.useMemo)(()=>g.findIndex(e=>e.column==d&&e.table==i)>-1,[g,d,i]),S=(e,s)=>{let l=g.findIndex(l=>l.column==s&&l.table==e);t({type:n.SDSS_CATALOG,payload:{selectedColumns:g.filter((e,s)=>s!=l)}})},C=(e,s)=>{t({type:n.SDSS_CATALOG,payload:{selectedColumns:[...g,{table:e,column:s}]}})};return(0,c.jsxs)(_.Z,{show:s,onHide:l,animation:!1,size:"lg",centered:!0,children:[(0,c.jsx)(_.Z.Header,{className:"py-2",closeButton:!0,children:(0,c.jsx)(_.Z.Title,{as:"h5",id:"contained-modal-title-vcenter",children:"Add SDSS columns"})}),(0,c.jsx)(_.Z.Body,{children:(0,c.jsxs)(J.Z,{children:[(0,c.jsxs)(W.Z,{sm:5,children:[(0,c.jsxs)(J.Z,{className:"align-items-center",children:[(0,c.jsx)(W.Z,{lg:2,children:"Table:"}),(0,c.jsx)(W.Z,{children:(0,c.jsx)(K.Z.Select,{defaultValue:i,onChange:e=>{p(!0),h(""),o(e.target.value)},children:sv.map(e=>(0,c.jsx)("option",{value:e,children:e},e))})})]}),(0,c.jsx)(sy,{placeholder:x,items:j,active:d,className:"mt-2",height:340,onClick:e=>{let{title:s}=e;return h(s)}})]}),x?(0,c.jsxs)(W.Z,{children:[(0,c.jsx)(ss.Z,{animation:"border",variant:"secondary",as:"span",size:"sm",className:"me-2"}),(0,c.jsxs)("span",{className:"text-muted",children:["Loading columns of the ",(0,c.jsx)("u",{children:i})," table"]})]}):(0,c.jsxs)(W.Z,{children:[g.filter(e=>e.table==i).length>0&&(0,c.jsxs)("div",{className:"mb-2",children:[(0,c.jsx)("span",{className:"text-muted fw-bold",children:"Selected columns:\xa0"}),g.filter(e=>e.table==i).map(e=>(0,c.jsx)(ei,{closeable:!0,className:"mb-1 me-1",onClose:()=>S(i,e.column),children:e.column},e.column))]}),f&&(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"mb-2",children:[(0,c.jsxs)("b",{children:[f.name,":"]}),"\xa0",f.description,".\xa0",f.unit&&(0,c.jsxs)(c.Fragment,{children:["Unit: ",(0,c.jsx)("i",{dangerouslySetInnerHTML:{__html:f.unit}})]})]}),(0,c.jsx)("div",{children:b?(0,c.jsxs)(N.Z,{variant:"outline-danger",size:"sm",onClick:()=>S(i,d),children:[(0,c.jsx)(ev.HeX,{})," Remove Selected Column"]}):(0,c.jsxs)(N.Z,{variant:"outline-success",size:"sm",onClick:()=>C(i,d),children:[(0,c.jsx)(V.poH,{size:16})," Add Selected Column"]})})]})]})]})})]})};function sI(){let{tcState:e,tcDispatch:s}=y(),[l,a]=(0,r.useState)(!1),t=e.cols.sdssCatalog.selectedColumns,i=(0,r.useMemo)(()=>sS()(t.map(e=>e.table)),[t]),o=(e,l)=>{let a=t.findIndex(s=>s.column==l&&s.table==e);s({type:n.SDSS_CATALOG,payload:{selectedColumns:t.filter((e,s)=>s!=a)}})};return(0,c.jsxs)(c.Fragment,{children:[t.length>0&&(0,c.jsx)(c.Fragment,{children:i.map(e=>(0,c.jsxs)("div",{className:"mb-2",children:[(0,c.jsxs)("span",{className:"me-2 fw-bold",children:[e,":"]}),t.filter(s=>s.table==e).map(e=>(0,c.jsx)(ei,{className:"mb-1 me-1",onClose:()=>o(e.table,e.column),children:e.column},e.column))]},e))}),(0,c.jsxs)(N.Z,{size:"sm",onClick:()=>a(!0),children:[(0,c.jsx)(V.poH,{size:16})," Add SDSS columns"]}),(0,c.jsx)(sZ,{show:l,onHide:()=>a(!1)})]})}let sN=e=>{var s,l;let{index:a}=e,{tcState:t,tcDispatch:i}=y(),r=t.cols.customImaging.columns[a];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsxs)(Y.Z,{className:"mb-2",size:"sm",children:[(0,c.jsx)(Y.Z.Text,{children:"Base URL"}),(0,c.jsx)(K.Z.Control,{value:r.url,onChange:e=>i({type:n.CUSTOM_IMAGE_UPDATE,payload:{index:a,url:e.target.value}})})]}),(0,c.jsxs)(Q,{title:"Base Resource URL",className:"mb-2 ms-1",children:["The ",(0,c.jsx)("b",{children:"base resource url"})," is the first (static) part of the URL. This value must starts with ",(0,c.jsx)("code",{children:"http://"})," ","or ",(0,c.jsx)("code",{children:"https://"}),(0,c.jsx)("br",{}),"The final url for each row is:",(0,c.jsx)("br",{}),(0,c.jsx)("kbd",{children:"Base URL"})," + ",(0,c.jsx)("kbd",{children:"RI column"})," + ",(0,c.jsx)("kbd",{children:"suffix"})]})]})}),(0,c.jsx)(W.Z,{sm:4,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsxs)(Y.Z,{size:"sm",children:[(0,c.jsx)(Y.Z.Text,{children:"Suffix"}),(0,c.jsx)(K.Z.Control,{value:r.fileExtension,onChange:e=>i({type:n.CUSTOM_IMAGE_UPDATE,payload:{index:a,fileExtension:e.target.value}})})]}),(0,c.jsxs)(Q,{title:"URL Suffix",className:"ms-1",children:["The ",(0,c.jsx)("b",{children:"url suffix"})," is the last (static) part of the URL and "," ","is used to specify the file extension, for example.",(0,c.jsx)("br",{}),"The final url for each row is:",(0,c.jsx)("br",{}),(0,c.jsx)("kbd",{children:"Base URL"})," + ",(0,c.jsx)("kbd",{children:"RI column"})," + ",(0,c.jsx)("kbd",{children:"suffix"})]})]})})]}),(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{sm:8,children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsxs)(Y.Z,{className:"",size:"sm",children:[(0,c.jsx)(Y.Z.Text,{children:"RI column"}),(0,c.jsxs)(K.Z.Select,{defaultValue:(null===(l=t.cols.customImaging.columns)||void 0===l?void 0:null===(s=l[a])||void 0===s?void 0:s.columnIndex)||-1,onChange:e=>i({type:n.CUSTOM_IMAGE_UPDATE,payload:{index:a,columnIndex:parseInt(e.target.value)}}),children:[(0,c.jsx)("option",{value:-1,children:"Select a column"}),t.table.columns.map((e,s)=>(0,c.jsx)("option",{value:s,children:e},s))]})]}),(0,c.jsxs)(Q,{title:"Resource Identification Column",className:" ms-1",children:["The ",(0,c.jsx)("b",{children:"resource identification column"})," (RI column) is the "," ","only variable part of the url. This field must specify the "," ","column to use to make a specific url for each row.",(0,c.jsx)("br",{}),"The final url for each row is:",(0,c.jsx)("br",{}),(0,c.jsx)("kbd",{children:"Base URL"})," + ",(0,c.jsx)("kbd",{children:"RI Column"})," + ",(0,c.jsx)("kbd",{children:"suffix"})]})]})}),(0,c.jsx)(W.Z,{sm:4,children:(0,c.jsxs)(N.Z,{variant:"outline-danger",size:"sm",onClick:()=>i({type:n.CUSTOM_IMAGE_REMOVE,payload:{index:a,prevColumns:t.cols.customImaging.columns}}),children:[(0,c.jsx)(ev.HeX,{})," Remove column"]})})]})]})};function s_(){let{tcState:e,tcDispatch:s}=y(),l=e.cols.customImaging;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(K.Z.Group,{as:J.Z,className:"mb-2",controlId:"customImagingCheck",children:[(0,c.jsx)(K.Z.Label,{column:!0,sm:"1",children:"Enable"}),(0,c.jsx)(W.Z,{sm:"11",className:"d-flex align-items-center",children:(0,c.jsx)(K.Z.Check,{type:"switch",label:"Show custom images columns",checked:l.enabled,onChange:e=>s({type:n.CUSTOM_IMAGE_ENABLE,payload:{enabled:e.target.checked}})})})]}),l.columns.map((e,s)=>(0,c.jsxs)(r.Fragment,{children:[(0,c.jsx)(sN,{index:s}),(0,c.jsx)("hr",{className:"my-4"})]},s)),(0,c.jsx)(J.Z,{children:(0,c.jsx)(W.Z,{children:(0,c.jsxs)(N.Z,{size:"sm",onClick:()=>s({type:n.CUSTOM_IMAGE_NEW,payload:{prevColumns:e.cols.customImaging.columns}}),children:[(0,c.jsx)(V.poH,{size:16})," Add custom image column"]})})})]})}var sw=l(1950),sT=l(7405);function sE(){let{tcState:e,tcDispatch:s}=y();return(0,c.jsxs)(v.Z,{className:"mt-5",children:[(0,c.jsxs)("div",{className:"border rounded rounded-3 p-4",style:{backgroundColor:"#fafafa"},children:[(0,c.jsxs)("h6",{className:"text-center mb-4 d-flex align-items-center justify-content-center",children:[(0,c.jsx)(sT.s7j,{className:"me-2",size:20}),(0,c.jsx)("span",{children:"Table Settings"})]}),(0,c.jsxs)(el.Z.Container,{id:"list-group-tabs-example",defaultActiveKey:"#select-table",children:[(0,c.jsxs)(J.Z,{children:[(0,c.jsx)(W.Z,{sm:3,children:(0,c.jsxs)(ea.Z,{children:[(0,c.jsx)(ea.Z.Item,{action:!0,href:"#select-table",children:"Select a table"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#classification",children:"Classification"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#sdss",children:"SDSS catalog"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#splus",children:"S-PLUS images"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#legacy",children:"Legacy images"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#custom-images",children:"Custom images"}),(0,c.jsx)(ea.Z.Item,{action:!0,href:"#spectra",children:"Spectra & photo-spectra"})]})}),(0,c.jsx)(W.Z,{sm:9,children:(0,c.jsxs)(el.Z.Content,{children:[(0,c.jsx)(el.Z.Pane,{eventKey:"#select-table",children:(0,c.jsx)(e7,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#classification",children:(0,c.jsx)(eh,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#sdss",children:(0,c.jsx)(sI,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#splus",children:(0,c.jsx)(eC,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#legacy",children:(0,c.jsx)(ex,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#custom-images",children:(0,c.jsx)(s_,{})}),(0,c.jsx)(el.Z.Pane,{eventKey:"#spectra",children:(0,c.jsx)(eu,{})})]})})]}),(0,c.jsx)(J.Z,{children:(0,c.jsx)(W.Z,{sm:3,className:"mx-auto",children:(0,c.jsx)(N.Z,{className:"mt-3 w-100 fw-bold",variant:"success",size:"lg",onClick:e=>{s({type:n.CURRENT_VIEW_CHANGE,payload:"grid"})},disabled:!e.table.file||e.table.processing,children:e.table.processing?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ss.Z,{as:"span",size:"sm",role:"status",animation:"border",variant:"light"})," Loading"]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(sw.tcg,{className:"me-2",size:30})," Load Table"]})})})})]})]}),(0,c.jsxs)(se.Z,{variant:"info",className:"mt-5",children:[(0,c.jsx)(se.Z.Heading,{children:"\uD83C\uDF89 New Version!"}),(0,c.jsx)("h6",{children:"Features of the software release v1.0:"}),(0,c.jsxs)("ul",{children:[(0,c.jsxs)("li",{children:["Add support to ",(0,c.jsx)("b",{children:"PARQUET"})," files"]}),(0,c.jsxs)("li",{children:["Handle ",(0,c.jsx)("b",{children:"big tables"})," (hundreds of thousands of lines)"]}),(0,c.jsxs)("li",{children:["Column relocation and row ",(0,c.jsx)("b",{children:"sorting and filtering"})]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("b",{children:"Faster loading"})," of resources with multiple parallel connections"]}),(0,c.jsxs)("li",{children:["Display of the ",(0,c.jsx)("b",{children:"loading status"})," of each external resource"]})]})]})]})}let sL=new sr.S({defaultOptions:{queries:{staleTime:0}}});class sG{async fetch(){return await sL.fetchQuery({queryKey:[this.url],queryFn:()=>sn.Z.get(this.url,{responseType:"blob",signal:st.getSignal()})})}constructor(e){this.url=e}}let sk=new sr.S({defaultOptions:{queries:{staleTime:A(1,"day","ms")}}});class sA{async fetch(){return await sk.fetchQuery({queryKey:[this.ra,this.dec,this.size,this.pixscale,this.layer],queryFn:()=>sn.Z.get("https://www.legacysurvey.org/viewer/cutout.jpg",{responseType:"blob",signal:st.getSignal(),params:{ra:this.ra,dec:this.dec,size:this.size,pixscale:this.pixscale,layer:this.layer}})})}constructor(e,s,l,a,t="ls-dr10"){this.ra=e,this.dec=s,this.layer=t,this.pixscale=a,this.size=l}}l(6932);let sR=new sr.S({defaultOptions:{queries:{staleTime:A(12,"hour","ms")}}});st.create("splus-flux-radius",1);class sF{getParams(){var e,s,l,a,t,n,i,c,r,o,d,h,m;return"trilogy"===this.type?{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(i=this.config)||void 0===i?void 0:null===(n=i.R)||void 0===n?void 0:n.join(","),g:null===(r=this.config)||void 0===r?void 0:null===(c=r.G)||void 0===c?void 0:c.join(","),b:null===(d=this.config)||void 0===d?void 0:null===(o=d.B)||void 0===o?void 0:o.join(","),noise:null===(h=this.config)||void 0===h?void 0:h.noise,q:null===(m=this.config)||void 0===m?void 0:m.Q}:{ra:this.ra,dec:this.dec,size:this.stampSize,r:null===(e=this.config)||void 0===e?void 0:e.R,g:null===(s=this.config)||void 0===s?void 0:s.G,b:null===(l=this.config)||void 0===l?void 0:l.B,stretch:null===(a=this.config)||void 0===a?void 0:a.stretch,q:null===(t=this.config)||void 0===t?void 0:t.Q}}getUrl(){return"trilogy"===this.type?"https://checker-melted-forsythia.glitch.me/trilogy.png":"https://checker-melted-forsythia.glitch.me/lupton.png"}async fetch(){return await sR.fetchQuery({queryKey:[this.ra,this.dec,this.stampSize,this.type,this.config],queryFn:()=>sn.Z.get(this.getUrl(),{responseType:"blob",signal:st.getSignal(),params:this.getParams()})})}constructor(e,s,l,a,t){this.ra=e,this.dec=s,this.pixscale=l,this.type=a,this.config=t,this.stampSize=Math.min(Math.round(300*this.pixscale/.55),1e3)}}class sP{async fetch(){return await sR.fetchQuery({queryKey:[this.ra,this.dec,this.lines],queryFn:()=>sn.Z.get("https://astrotools.vercel.app/plot",{responseType:"blob",signal:st.getSignal(),params:{ra:this.ra,dec:this.dec,...this.lines.map(e=>({[e]:""}))}})})}constructor(e,s,l){this.ra=e,this.dec=s,this.lines=l}}l(3809),l(7180);var sO=l(975),sU=l(361),sD=l.n(sU);st.create("img:legacy",4),st.create("img:splus",4),st.create("img:splus_photospec",4),st.create("img:sdss_spec",4),st.create("sdss_cat",4);let sM=async e=>{let{resourceFetch:s,colId:l,rowId:a,grid:t,isImage:n=!0}=e,i=t.api.getRowNode(a);if(((null==i?void 0:i.data[l])===eN||(null==i?void 0:i.data[l])===void 0)&&(null==i?void 0:i.data.hasOwnProperty(l)))try{null==i||i.setDataValue(l,e_);let e=await s.fetch();n?null==i||i.setDataValue(l,URL.createObjectURL(e.data)):null==i||i.setDataValue(l,e.data)}catch(e){null==i||i.setDataValue(l,ew)}};function sz(){let{tcState:e,tcDispatch:s}=y(),[l,a]=(0,r.useState)(!0),t=(0,r.useRef)(null),i=(0,r.useCallback)(async l=>{var t;let i;e.table.isSameFile&&(null===(t=e.grid.currColConfigs)||void 0===t?void 0:t.classification.enabled)&&e.cols.classification.enabled&&console.log("prev class",i=e.grid.data.map(e=>({"ai:class":e["ai:class"]}))),console.log("isSameFile",e.table.isSameFile);let c=await e3.load(e.table.file),{colDef:r,initVal:o}=e3.getColDefs(e);console.log("data",c=null==c?void 0:c.map((e,s,l)=>({...e,...o,"ai:id":String(s+1)}))),i&&console.log("data with prev class",c=null==c?void 0:c.map((e,s,l)=>({...e,...i[s]}))),a(!1),s({type:n.GRID_UPDATE,payload:{data:c,colDef:r,isLoaded:!0,currColConfigs:sD()(e.cols),currTable:{...e.table},api:l.api}}),s({type:n.USER_FILE_INPUT,payload:{isSameFile:!0}})},[e]),o=(0,r.useCallback)(s=>{let l=s.api.paginationGetPageSize(),a=s.api.paginationGetCurrentPage(),n=[];s.api.forEachNodeAfterFilterAndSort(e=>{n.push(e.data)});let i=a*l,c=n.slice(i,i+l),r=e.table.columns[e.table.raIndex],o=e.table.columns[e.table.decIndex];st.clear(),c.forEach(s=>{let l=s["tab:".concat(r)],a=s["tab:".concat(o)],n=s["ai:id"];if(e.cols.legacyImaging.enabled&&st.enqueue("img:legacy",sM,{resourceFetch:new sA(l,a,300,e.cols.legacyImaging.pixelScale),colId:"img:legacy",rowId:n,grid:t.current}),e.cols.splusImaging.enabled){let s="trilogy"===e.cols.splusImaging.type?e.cols.splusImaging.trilogyConfig:e.cols.splusImaging.luptonConfig;st.enqueue("img:splus",sM,{resourceFetch:new sF(l,a,e.cols.splusImaging.pixelScale,e.cols.splusImaging.type,s),colId:"img:splus",rowId:n,grid:t.current})}e.cols.splusPhotoSpectra.enabled&&st.enqueue("img:splus_photospec",sM,{resourceFetch:new sP(l,a,e.cols.splusPhotoSpectra.selectedLines),colId:"img:splus_photospec",rowId:n,grid:t.current}),e.cols.sdssSpectra.enabled&&st.enqueue("img:sdss_spec",sM,{resourceFetch:new su(l,a),colId:"img:sdss_spec",rowId:n,grid:t.current}),e.cols.customImaging.enabled&&e.cols.customImaging.columns.forEach((l,a,n)=>{let i="tab:".concat(e.table.columns[l.columnIndex]),c="".concat(l.url).concat(String(s[i])).concat(l.fileExtension),r="img:custom_".concat(a);st.create(r,4),st.enqueue(r,sM,{resourceFetch:new sG(c),colId:r,rowId:s["ai:id"],grid:t.current})}),e.cols.sdssCatalog.selectedColumns.forEach(e=>{st.enqueue("sdss_cat",sM,{resourceFetch:new sx(l,a,e.table,e.column),colId:"sdss:".concat(e.table,"_").concat(e.column),rowId:n,grid:t.current,isImage:!1})})})},[e]),d=(0,r.useCallback)(e=>e.data["ai:id"],[]),h=(0,r.useMemo)(()=>[25,50,75,100,150,200,400],[]),m={};return(e.cols.legacyImaging.enabled||e.cols.sdssSpectra.enabled||e.cols.splusPhotoSpectra.enabled||e.cols.customImaging.enabled&&e.cols.customImaging.columns.length>0)&&(m={rowHeight:120}),(0,c.jsx)(v.Z,{fluid:!0,className:"px-0",style:{height:"100%"},children:(0,c.jsx)("div",{className:"ag-theme-quartz",style:{width:"100%",height:"100%","--ag-cell-horizontal-padding":"8px","--ag-borders":"solid 1px","--ag-wrapper-border-radius":"0px"},children:(0,c.jsx)(sO.s,{gridOptions:m,ref:t,rowData:e.grid.data||[],columnDefs:e.grid.colDef||[],getRowId:d,loading:l,style:{height:"100%"},pagination:!0,paginationPageSize:50,paginationPageSizeSelector:h,onGridReady:i,onPaginationChanged:o,onSortChanged:o,onFilterChanged:o})})})}function sH(){let{tcState:e}=y();return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"d-flex flex-column h-100",children:[(0,c.jsx)(es,{}),(0,c.jsx)("div",{className:"flex-grow-1",children:"settings"==e.currentView?(0,c.jsx)(sE,{}):(0,c.jsx)(sz,{})})]})})}function sq(){return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(C(),{children:[(0,c.jsx)("link",{rel:"icon",href:"data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>\uD83C\uDF0C</text></svg>"}),(0,c.jsx)("title",{children:"AstroInspect"})]}),(0,c.jsxs)(f,{children:[(0,c.jsx)(b,{}),(0,c.jsx)(sH,{})]})]})}},1549:function(e){e.exports={chip:"ButtonChip_chip__DD9VL"}},7615:function(e){e.exports={chip:"Chip_chip__5QeIu",pointer:"Chip_pointer__BzSv_",closebtn:"Chip_closebtn__JicWE"}}},function(e){e.O(0,[909,391,838,509,321,365,738,817,594,563,929,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);